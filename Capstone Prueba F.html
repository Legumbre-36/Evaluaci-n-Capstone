<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Debora Garrido - Nelia González - Nicolás Marchant">

<title>Determinantes sociales, cognitivos y conductuales del consumo de alcohol en la población chilena</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="Capstone Prueba F_files/libs/clipboard/clipboard.min.js"></script>
<script src="Capstone Prueba F_files/libs/quarto-html/quarto.js"></script>
<script src="Capstone Prueba F_files/libs/quarto-html/popper.min.js"></script>
<script src="Capstone Prueba F_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Capstone Prueba F_files/libs/quarto-html/anchor.min.js"></script>
<link href="Capstone Prueba F_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Capstone Prueba F_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Capstone Prueba F_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Capstone Prueba F_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Capstone Prueba F_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<link href="Capstone Prueba F_files/libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">
<script src="Capstone Prueba F_files/libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<script src="Capstone Prueba F_files/libs/plotly-binding-4.11.0/plotly.js"></script>
<script src="Capstone Prueba F_files/libs/typedarray-0.1/typedarray.min.js"></script>
<script src="Capstone Prueba F_files/libs/jquery-3.5.1/jquery.min.js"></script>
<link href="Capstone Prueba F_files/libs/crosstalk-1.2.2/css/crosstalk.min.css" rel="stylesheet">
<script src="Capstone Prueba F_files/libs/crosstalk-1.2.2/js/crosstalk.min.js"></script>
<link href="Capstone Prueba F_files/libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet">
<script src="Capstone Prueba F_files/libs/plotly-main-2.11.1/plotly-latest.min.js"></script>


</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#contexto" id="toc-contexto" class="nav-link active" data-scroll-target="#contexto"><span class="header-section-number">1</span> Contexto:</a></li>
  <li><a href="#objetivo" id="toc-objetivo" class="nav-link" data-scroll-target="#objetivo"><span class="header-section-number">2</span> Objetivo:</a></li>
  <li><a href="#metodología" id="toc-metodología" class="nav-link" data-scroll-target="#metodología"><span class="header-section-number">3</span> Metodología</a></li>
  <li><a href="#carga-de-bases-de-datos" id="toc-carga-de-bases-de-datos" class="nav-link" data-scroll-target="#carga-de-bases-de-datos"><span class="header-section-number">4</span> Carga de bases de datos</a></li>
  <li><a href="#exploración-limpieza-y-transformación-de-los-datos" id="toc-exploración-limpieza-y-transformación-de-los-datos" class="nav-link" data-scroll-target="#exploración-limpieza-y-transformación-de-los-datos"><span class="header-section-number">5</span> Exploración, limpieza y transformación de los datos</a></li>
  <li><a href="#hipótesis-de-trabajo" id="toc-hipótesis-de-trabajo" class="nav-link" data-scroll-target="#hipótesis-de-trabajo"><span class="header-section-number">6</span> Hipótesis de trabajo</a></li>
  <li><a href="#análisis-descriptivo" id="toc-análisis-descriptivo" class="nav-link" data-scroll-target="#análisis-descriptivo"><span class="header-section-number">7</span> Análisis descriptivo</a></li>
  <li><a href="#análisis-predictivo-regresión-logística" id="toc-análisis-predictivo-regresión-logística" class="nav-link" data-scroll-target="#análisis-predictivo-regresión-logística"><span class="header-section-number">8</span> Análisis predictivo: Regresión Logística</a></li>
  <li><a href="#análisis-predictivo-random-forest" id="toc-análisis-predictivo-random-forest" class="nav-link" data-scroll-target="#análisis-predictivo-random-forest"><span class="header-section-number">9</span> Análisis predictivo: Random forest</a></li>
  <li><a href="#conclusiones" id="toc-conclusiones" class="nav-link" data-scroll-target="#conclusiones"><span class="header-section-number">10</span> Conclusiones</a></li>
  </ul>
<div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="Capstone Prueba F.pdf"><i class="bi bi-file-pdf"></i>PDF</a></li></ul></div></nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Determinantes sociales, cognitivos y conductuales del consumo de alcohol en la población chilena</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Debora Garrido - Nelia González - Nicolás Marchant </p>
          </div>
  </div>
    
  
    
  </div>
  

</header>

<section id="contexto" class="level2" data-number="1">
<h2 data-number="1" class="anchored" data-anchor-id="contexto"><span class="header-section-number">1</span> Contexto:</h2>
<p>A nivel internacional, el consumo de alcohol constituye un problema relevante de salud pública por su magnitud y por los costos sociales asociados. Se estima que el alcohol es responsable de 3,3 millones de muertes anuales en el mundo (5,9% de todas las defunciones) y se vincula causalmente con más de 200 enfermedades y trastornos, aportando además una fracción significativa de la carga global de morbilidad y lesiones (SENDA &amp; Ministerio de Salud, 2016). En el caso de las Américas el consumo promedio es más alto que en otras regiones y, en los últimos años, se han reportado aumentos de episodios de consumo excesivo (OPS, 2015), lo que refuerza la pertinencia de analizar los determinantes que sostienen estos patrones.</p>
<p>En Chile, los determinantes del consumo de alcohol se articulan en torno a desigualdades sociodemográficas (edad/etapa del curso como aproximación al ciclo vital adolescente, género y condiciones socioeconómicas), además de factores de contexto como normas sociales, exposición a marketing y disponibilidad. La evidencia regional muestra que el daño asociado al alcohol se distribuye de manera inequitativa: grupos socioeconómicos más desfavorecidos tienden a experimentar mayores repercusiones sanitarias ante niveles comparables de consumo, y una fracción minoritaria de bebedores concentra una proporción desmesurada del volumen total consumido (OPS, 2015).</p>
<p>Así como los determinantes sociodemográficos, existen factores vinculados a percepciones, conductas y salud mental que resultan relevantes para comprender el consumo de alcohol y sus impactos. La literatura sugiere que el consumo de alcohol rara vez aparece de forma aislada, especialmente durante la adolescencia, cuando tiende a integrarse en patrones de policonsumo. Por ejemplo, un estudio chileno con adolescentes escolarizados encontró que el inicio precoz del consumo de alcohol se asocia con una mayor probabilidad de consumo reciente de otras sustancias y con la presencia de otros comportamientos de riesgo, lo que es consistente con la noción de “constelaciones” de conductas interrelacionadas (Vilugrón et al., 2022). Asimismo, el mismo estudio reporta asociaciones entre el consumo y variables psicosociales como insatisfacción con la vida, insatisfacción escolar y bajo apoyo familiar.</p>
<p>Por otra parte, la percepción de riesgo opera como un determinante proximal relevante: cuando el consumo se evalúa como poco riesgoso, aumenta la probabilidad de iniciación y mantención, especialmente en contextos donde el alcohol se encuentra socialmente normalizado. En Chile, la medición en población escolar evidencia una marcada asimetría: el consumo ocasional presenta niveles bajos de percepción de “gran riesgo”, mientras que el consumo diario es evaluado como más peligroso por una proporción considerablemente mayor de estudiantes (SENDA, 2023). No obstante, los antecedentes citados refieren principalmente a población escolar. En este trabajo, por tanto, se buscará operacionalizar las variables antes mencionadas y examinar su asociación con el consumo de alcohol en población general, con el fin de evaluar en qué medida estos factores mantienen su relevancia más allá del contexto adolescente/escolar.</p>
</section>
<section id="objetivo" class="level2" data-number="2">
<h2 data-number="2" class="anchored" data-anchor-id="objetivo"><span class="header-section-number">2</span> Objetivo:</h2>
<p>El objetivo del estudio es estimar el efecto de factores sociodemográficos, percepción de riesgo, policonsumo de sustancias y salud mental sobre la probabilidad de consumo de alcohol en los últimos 30 días en Chile.</p>
</section>
<section id="metodología" class="level2" data-number="3">
<h2 data-number="3" class="anchored" data-anchor-id="metodología"><span class="header-section-number">3</span> Metodología</h2>
<p>El presente estudio se enmarca en un enfoque cuantitativo, utilizando información secundaria proveniente del Estudio Nacional de Drogas en Población General 2024, elaborado por el Servicio Nacional para la Prevención y Rehabilitación del Consumo de Drogas y Alcohol (SENDA), el cual proporciona datos representativos a nivel nacional sobre patrones de consumo y características individuales de la población.</p>
<p>El análisis de los datos se desarrollará utilizando herramientas y técnicas abordadas a lo largo del Diplomado en Data Science para Ciencias Sociales, incluyendo procesos de limpieza y preparación de datos, análisis descriptivo, exploración de relaciones entre variables y modelamiento estadístico. Este enfoque metodológico busca integrar el análisis estadístico con una comprensión sustantiva del fenómeno estudiado, aportando evidencia empírica que contribuya a la reflexión y toma de decisiones en el diseño de estrategias de prevención e intervención basadas en políticas públicas.</p>
<p>Las variables consideradas para el análisis se presentan a continuación:</p>
<p><strong>Variable dependiente:</strong></p>
<p>Consumo de alcohol en los últimos 30 días, construida a partir de las variables: a) Ha consumido alcohol (OH_1) b) Consumió alcohol los últimos 30 días (OH_4)</p>
<p><strong>Variables independientes:</strong></p>
<p>La inclusión de variables independientes se estructuró en función de cuatro líneas temáticas:</p>
<p><strong>a) Sociodemográficos</strong></p>
<p>Edad (EDAD) Estado civil (DP_2) Pertenencia a un pueblo originario (DP_4) Adhiere a una religión (DP_5) Género (DP_8) Nivel de escolaridad (DP_12) Trabajó la semana pasada (CO_1) Cargo en el trabajo (CO_6)</p>
<p><strong>b) Consumo de otras sustancias los últimos 30 días</strong></p>
<p>Consumo de cigarrillos (ST_1/ST_4) Consumo de marihuana (MAR_1/MAR_4) Consumo de cocaína (COC_1/COC_4) Consumo de pasta base (PB_1/PB_4) Consumo de tusi (TUS_1/TUS_4)</p>
<p><strong>c) Salud mental</strong></p>
<p>Percepción de estado de salud general (ST_1) Habitualidad de problemas de salud mental: ¿Sus preocupaciones le han hecho perder mucho sueño? (T_SG_1_B) Habitualidad de problemas de salud mental: Y, ¿Se ha sentido constantemente agobiado/a o en tensión? (T_SG_1_E) Habitualidad de problemas de salud mental: ¿Ha sentido que no puede superar sus dificultades? (T_SG_1_F) Habitualidad de problemas de salud mental: ¿Se ha sentido poco feliz y deprimido/a? (T_SG_1_I) Habitualidad de problemas de salud mental: ¿Ha perdido confianza en sí mismo/a? (T_SG_1_J) Habitualidad de problemas de salud mental: ¿Ha pensado que usted es una persona que no vale para nada? (T_SG_1_K)</p>
<p><strong>d) Percepción de riesgo</strong></p>
<p>Toma tres o más tragos por ocasión (T_PR_1_2) Toma cinco o más tragos diariamente (T_PR_1_3)</p>
</section>
<section id="carga-de-bases-de-datos" class="level2" data-number="4">
<h2 data-number="4" class="anchored" data-anchor-id="carga-de-bases-de-datos"><span class="header-section-number">4</span> Carga de bases de datos</h2>
<p>En esta sección se realizará la carga de la base de datos que se utilizará en el estudio, junto con la importación de las librerías necesarias para este proceso.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Librerias</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rio)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(skimr)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plotly)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(scales)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(forcats)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stringr)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Semilla para reproducibilidad</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="co"># En la carpeta del capstone descargar "Base Publica ENPG 2024 (Stata 16).dta"</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Cargar base de datos </span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>ENPG_2024 <span class="ot">&lt;-</span> <span class="fu">import</span>(<span class="st">"Base Publica ENPG 2024 (Stata 16).dta"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="exploración-limpieza-y-transformación-de-los-datos" class="level2" data-number="5">
<h2 data-number="5" class="anchored" data-anchor-id="exploración-limpieza-y-transformación-de-los-datos"><span class="header-section-number">5</span> Exploración, limpieza y transformación de los datos</h2>
<p>En esta sección se explorará la base de datos importada y, posteriormente, se realizará su limpieza con el fin de construir un data frame que incluya únicamente las variables que serán utilizadas en el análisis.</p>
<p>A continuación, se recodificarán las variables que se incorporarán en los modelos, con el objetivo de favorecer la parsimonia en la interpretación, focalizar y organizar las variables de consumo, y asegurar que su codificación quede alineada con la información presentada en el capítulo de contexto.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Exploración de datos</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(ENPG_2024)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(ENPG_2024)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(ENPG_2024)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(ENPG_2024)</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Limpieza y transformación</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>ENPG_filtrado <span class="ot">&lt;-</span> ENPG_2024 <span class="sc">%&gt;%</span> <span class="fu">select</span>(RESPONDENT_SERIAL, EDAD, SEXO, OH_1, OH_2, OH_4,</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>                                      DP_4, DP_5, </span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>                                      DP_8, DP_12, DP_16, </span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>                                      MAR_1, MAR_4, PB_1, </span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>                                      PB_4, COC_1, COC_4, </span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>                                      TUS_1, TUS_4, T_PR_1_2, T_PR_1_3, </span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>                                      ST_1, ST_2, ST_5, T_SG_1_B, T_SG_1_E, </span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>                                      T_SG_1_I, T_SG_1_J, T_SG_1_K, T_SG_1_F, </span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>                                      CO_1, CO_6, DP_2)</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(ENPG_filtrado)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>5.1) Creación variable de consumo de alcohol los últimos 30 días (dependiente)</p>
<p>Esta variable se construirá como un índice a partir de las preguntas “¿Ha consumido alcohol alguna vez en la vida?” y “¿Cuándo fue la última vez que consumió alcohol?”, delimitando el consumo al periodo de los últimos 30 días.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>ENPG_filtrado <span class="ot">&lt;-</span> ENPG_filtrado <span class="sc">%&gt;%</span> </span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">alcohol_30d =</span> <span class="fu">case_when</span>(</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>    OH_1 <span class="sc">==</span> <span class="dv">2</span> <span class="sc">~</span> <span class="dv">0</span>, <span class="co">#NO HA CONSUMIDO ALCOHOL</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>    OH_4 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">~</span> <span class="dv">1</span>, <span class="co">#HA CONSUMIDO ULTIMOS 30D</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>    OH_4 <span class="sc">==</span> <span class="dv">2</span> <span class="sc">~</span> <span class="dv">0</span>,</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>    OH_4 <span class="sc">==</span> <span class="dv">3</span> <span class="sc">~</span> <span class="dv">0</span>)</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>ENPG_filtrado <span class="ot">&lt;-</span> ENPG_filtrado <span class="sc">%&gt;%</span> </span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="fu">mutate</span> (<span class="at">alcohol_30d =</span><span class="fu">case_when</span>(</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>alcohol_30d <span class="sc">==</span> <span class="dv">1</span> <span class="sc">~</span> <span class="st">"Sí"</span>,</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>alcohol_30d <span class="sc">==</span> <span class="dv">0</span> <span class="sc">~</span> <span class="st">"No"</span>,</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a><span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_character_</span></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a><span class="fu">skim</span>(ENPG_filtrado)</span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(ENPG_filtrado<span class="sc">$</span>alcohol_30d)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>5.2) Creación de variables independientes En este apartado se realizarán las recodificaciones de las variables independientes.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="do">##1. Folio</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>ENPG_filtrado <span class="ot">&lt;-</span> ENPG_filtrado <span class="sc">%&gt;%</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="fu">rename</span>(<span class="at">Folio =</span> RESPONDENT_SERIAL)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Sociodemográficas</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="do">##a) Edad</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>ENPG_filtrado <span class="ot">&lt;-</span> ENPG_filtrado<span class="sc">%&gt;%</span>  </span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">edad_recod =</span><span class="fu">case_when</span>(</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>    EDAD <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">12</span><span class="sc">:</span><span class="dv">18</span>)<span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>    EDAD <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">19</span><span class="sc">:</span><span class="dv">25</span>)<span class="sc">~</span> <span class="dv">2</span>,</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>    EDAD <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">26</span><span class="sc">:</span><span class="dv">34</span>)<span class="sc">~</span> <span class="dv">3</span>,</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>    EDAD <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">35</span><span class="sc">:</span><span class="dv">44</span>)<span class="sc">~</span> <span class="dv">4</span>,</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>    EDAD <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">45</span><span class="sc">:</span><span class="dv">70</span>)<span class="sc">~</span> <span class="dv">5</span></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>  )          )</span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a><span class="do">##b) Estado civil</span></span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>ENPG_filtrado <span class="ot">&lt;-</span> ENPG_filtrado <span class="sc">%&gt;%</span> </span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">estado_civil =</span> DP_2)</span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a><span class="do">##c. Pertenencia a un grupo originario</span></span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a>ENPG_filtrado <span class="ot">&lt;-</span> ENPG_filtrado <span class="sc">%&gt;%</span> </span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pueblo_ind =</span> <span class="fu">case_when</span>(</span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a>    DP_4 <span class="sc">%in%</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">12</span> <span class="sc">~</span> <span class="st">"Indígena"</span>,</span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a>    DP_4 <span class="sc">==</span> <span class="dv">13</span> <span class="sc">~</span> <span class="st">"No indígena"</span>,</span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_character_</span></span>
<span id="cb4-29"><a href="#cb4-29" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb4-30"><a href="#cb4-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-31"><a href="#cb4-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-32"><a href="#cb4-32" aria-hidden="true" tabindex="-1"></a><span class="do">##d. Adhiere a una religión</span></span>
<span id="cb4-33"><a href="#cb4-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-34"><a href="#cb4-34" aria-hidden="true" tabindex="-1"></a>ENPG_filtrado <span class="ot">&lt;-</span> ENPG_filtrado <span class="sc">%&gt;%</span> </span>
<span id="cb4-35"><a href="#cb4-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">religion =</span> <span class="fu">case_when</span>(</span>
<span id="cb4-36"><a href="#cb4-36" aria-hidden="true" tabindex="-1"></a>    DP_5 <span class="sc">%in%</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">11</span> <span class="sc">~</span> <span class="st">"Religión"</span>,</span>
<span id="cb4-37"><a href="#cb4-37" aria-hidden="true" tabindex="-1"></a>    DP_5 <span class="sc">==</span> <span class="dv">12</span> <span class="sc">~</span> <span class="st">"No religión"</span>,</span>
<span id="cb4-38"><a href="#cb4-38" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_character_</span></span>
<span id="cb4-39"><a href="#cb4-39" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb4-40"><a href="#cb4-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-41"><a href="#cb4-41" aria-hidden="true" tabindex="-1"></a><span class="do">##e) Género</span></span>
<span id="cb4-42"><a href="#cb4-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-43"><a href="#cb4-43" aria-hidden="true" tabindex="-1"></a>ENPG_filtrado <span class="ot">&lt;-</span> ENPG_filtrado <span class="sc">%&gt;%</span></span>
<span id="cb4-44"><a href="#cb4-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb4-45"><a href="#cb4-45" aria-hidden="true" tabindex="-1"></a>    <span class="at">genero =</span> <span class="fu">case_when</span>(</span>
<span id="cb4-46"><a href="#cb4-46" aria-hidden="true" tabindex="-1"></a>      SEXO <span class="sc">==</span> <span class="dv">1</span> <span class="sc">~</span> <span class="st">"Masculino"</span>,</span>
<span id="cb4-47"><a href="#cb4-47" aria-hidden="true" tabindex="-1"></a>      SEXO <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">6</span>, <span class="dv">99</span>) <span class="sc">~</span> <span class="st">"Otro género"</span>,</span>
<span id="cb4-48"><a href="#cb4-48" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_character_</span></span>
<span id="cb4-49"><a href="#cb4-49" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb4-50"><a href="#cb4-50" aria-hidden="true" tabindex="-1"></a>    <span class="at">genero =</span> <span class="fu">factor</span>(genero),</span>
<span id="cb4-51"><a href="#cb4-51" aria-hidden="true" tabindex="-1"></a>    <span class="at">genero =</span> <span class="fu">relevel</span>(genero, <span class="at">ref =</span> <span class="st">"Otro género"</span>) </span>
<span id="cb4-52"><a href="#cb4-52" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb4-53"><a href="#cb4-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-54"><a href="#cb4-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-55"><a href="#cb4-55" aria-hidden="true" tabindex="-1"></a><span class="do">##f) Nivel de escolaridad</span></span>
<span id="cb4-56"><a href="#cb4-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-57"><a href="#cb4-57" aria-hidden="true" tabindex="-1"></a>ENPG_filtrado <span class="ot">&lt;-</span> ENPG_filtrado<span class="sc">%&gt;%</span>  </span>
<span id="cb4-58"><a href="#cb4-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">escolaridad =</span><span class="fu">case_when</span>(</span>
<span id="cb4-59"><a href="#cb4-59" aria-hidden="true" tabindex="-1"></a>    DP_12 <span class="sc">%in%</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span> <span class="sc">~</span> <span class="st">"Enseñanza básica o menos"</span>,</span>
<span id="cb4-60"><a href="#cb4-60" aria-hidden="true" tabindex="-1"></a>    DP_12 <span class="sc">%in%</span> <span class="dv">5</span><span class="sc">:</span><span class="dv">8</span> <span class="sc">~</span> <span class="st">"Enseñanza media"</span>,</span>
<span id="cb4-61"><a href="#cb4-61" aria-hidden="true" tabindex="-1"></a>    DP_12 <span class="sc">%in%</span> <span class="dv">9</span><span class="sc">:</span><span class="dv">13</span><span class="sc">~</span> <span class="st">"Enseñanza superior o más"</span>,</span>
<span id="cb4-62"><a href="#cb4-62" aria-hidden="true" tabindex="-1"></a>    DP_12 <span class="sc">%in%</span> <span class="dv">88</span> <span class="sc">~</span> <span class="st">"No sabe"</span></span>
<span id="cb4-63"><a href="#cb4-63" aria-hidden="true" tabindex="-1"></a>  )          )</span>
<span id="cb4-64"><a href="#cb4-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-65"><a href="#cb4-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-66"><a href="#cb4-66" aria-hidden="true" tabindex="-1"></a>ENPG_filtrado <span class="ot">&lt;-</span> ENPG_filtrado <span class="sc">%&gt;%</span> </span>
<span id="cb4-67"><a href="#cb4-67" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">educacion_med =</span> <span class="fu">case_when</span>(</span>
<span id="cb4-68"><a href="#cb4-68" aria-hidden="true" tabindex="-1"></a>    DP_12 <span class="sc">%in%</span> <span class="dv">5</span><span class="sc">:</span><span class="dv">13</span> <span class="sc">~</span> <span class="st">"Tiene educación media o superior"</span>,</span>
<span id="cb4-69"><a href="#cb4-69" aria-hidden="true" tabindex="-1"></a>    DP_12 <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, <span class="dv">88</span>) <span class="sc">~</span> <span class="st">"No tiene educación media o superior"</span>, </span>
<span id="cb4-70"><a href="#cb4-70" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_character_</span></span>
<span id="cb4-71"><a href="#cb4-71" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb4-72"><a href="#cb4-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-73"><a href="#cb4-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-74"><a href="#cb4-74" aria-hidden="true" tabindex="-1"></a><span class="co"># g) Trabajó la semana pasada/Cargo trabajo (renombrando variables)</span></span>
<span id="cb4-75"><a href="#cb4-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-76"><a href="#cb4-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-77"><a href="#cb4-77" aria-hidden="true" tabindex="-1"></a>ENPG_filtrado <span class="ot">&lt;-</span> ENPG_filtrado <span class="sc">%&gt;%</span> </span>
<span id="cb4-78"><a href="#cb4-78" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">trabaja_o_no =</span> CO_1, <span class="at">cargo_trabajo =</span> CO_6)</span>
<span id="cb4-79"><a href="#cb4-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-80"><a href="#cb4-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-81"><a href="#cb4-81" aria-hidden="true" tabindex="-1"></a><span class="do">##Consumo de otras sustancias (construcción de variables)</span></span>
<span id="cb4-82"><a href="#cb4-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-83"><a href="#cb4-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-84"><a href="#cb4-84" aria-hidden="true" tabindex="-1"></a><span class="co"># a) Consumo de cigarrillos</span></span>
<span id="cb4-85"><a href="#cb4-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-86"><a href="#cb4-86" aria-hidden="true" tabindex="-1"></a>ENPG_filtrado <span class="ot">&lt;-</span> ENPG_filtrado <span class="sc">%&gt;%</span> </span>
<span id="cb4-87"><a href="#cb4-87" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb4-88"><a href="#cb4-88" aria-hidden="true" tabindex="-1"></a>    <span class="at">Consumo_cigarros =</span> <span class="fu">case_when</span>(</span>
<span id="cb4-89"><a href="#cb4-89" aria-hidden="true" tabindex="-1"></a>      ST_2 <span class="sc">==</span> <span class="dv">2</span> <span class="sc">~</span> <span class="dv">0</span>,</span>
<span id="cb4-90"><a href="#cb4-90" aria-hidden="true" tabindex="-1"></a>      ST_5 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">~</span> <span class="dv">1</span>, </span>
<span id="cb4-91"><a href="#cb4-91" aria-hidden="true" tabindex="-1"></a>      ST_5 <span class="sc">==</span> <span class="dv">2</span> <span class="sc">~</span> <span class="dv">0</span>,</span>
<span id="cb4-92"><a href="#cb4-92" aria-hidden="true" tabindex="-1"></a>      ST_5 <span class="sc">==</span> <span class="dv">3</span> <span class="sc">~</span> <span class="dv">0</span></span>
<span id="cb4-93"><a href="#cb4-93" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb4-94"><a href="#cb4-94" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb4-95"><a href="#cb4-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-96"><a href="#cb4-96" aria-hidden="true" tabindex="-1"></a>ENPG_filtrado <span class="ot">&lt;-</span> ENPG_filtrado <span class="sc">%&gt;%</span> </span>
<span id="cb4-97"><a href="#cb4-97" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Consumo_cigarros =</span> <span class="fu">case_when</span>(</span>
<span id="cb4-98"><a href="#cb4-98" aria-hidden="true" tabindex="-1"></a>    Consumo_cigarros <span class="sc">==</span> <span class="dv">1</span> <span class="sc">~</span> <span class="st">"Sí"</span>,</span>
<span id="cb4-99"><a href="#cb4-99" aria-hidden="true" tabindex="-1"></a>    Consumo_cigarros <span class="sc">==</span> <span class="dv">0</span> <span class="sc">~</span> <span class="st">"No"</span>,</span>
<span id="cb4-100"><a href="#cb4-100" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_character_</span></span>
<span id="cb4-101"><a href="#cb4-101" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb4-102"><a href="#cb4-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-103"><a href="#cb4-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-104"><a href="#cb4-104" aria-hidden="true" tabindex="-1"></a><span class="co"># b) Consumo de marihuana</span></span>
<span id="cb4-105"><a href="#cb4-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-106"><a href="#cb4-106" aria-hidden="true" tabindex="-1"></a>ENPG_filtrado <span class="ot">&lt;-</span> ENPG_filtrado <span class="sc">%&gt;%</span> </span>
<span id="cb4-107"><a href="#cb4-107" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb4-108"><a href="#cb4-108" aria-hidden="true" tabindex="-1"></a>    <span class="at">Consumo_mar =</span> <span class="fu">case_when</span>(</span>
<span id="cb4-109"><a href="#cb4-109" aria-hidden="true" tabindex="-1"></a>    MAR_1 <span class="sc">==</span> <span class="dv">2</span> <span class="sc">~</span> <span class="dv">0</span>, <span class="co">#NO HA CONSUMIDO MARIHUANA</span></span>
<span id="cb4-110"><a href="#cb4-110" aria-hidden="true" tabindex="-1"></a>    MAR_4 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">~</span> <span class="dv">1</span>, <span class="co">#HA CONSUMIDO ULTIMOS 30D</span></span>
<span id="cb4-111"><a href="#cb4-111" aria-hidden="true" tabindex="-1"></a>    MAR_4 <span class="sc">==</span> <span class="dv">2</span> <span class="sc">~</span> <span class="dv">0</span>,</span>
<span id="cb4-112"><a href="#cb4-112" aria-hidden="true" tabindex="-1"></a>    MAR_4 <span class="sc">==</span> <span class="dv">3</span> <span class="sc">~</span> <span class="dv">0</span>)</span>
<span id="cb4-113"><a href="#cb4-113" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb4-114"><a href="#cb4-114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-115"><a href="#cb4-115" aria-hidden="true" tabindex="-1"></a>ENPG_filtrado <span class="ot">&lt;-</span> ENPG_filtrado <span class="sc">%&gt;%</span> </span>
<span id="cb4-116"><a href="#cb4-116" aria-hidden="true" tabindex="-1"></a><span class="fu">mutate</span> (<span class="at">Consumo_mar =</span><span class="fu">case_when</span>(</span>
<span id="cb4-117"><a href="#cb4-117" aria-hidden="true" tabindex="-1"></a>Consumo_mar <span class="sc">==</span> <span class="dv">1</span> <span class="sc">~</span> <span class="st">"Sí"</span>,</span>
<span id="cb4-118"><a href="#cb4-118" aria-hidden="true" tabindex="-1"></a>Consumo_mar <span class="sc">==</span> <span class="dv">0</span> <span class="sc">~</span> <span class="st">"No"</span>,</span>
<span id="cb4-119"><a href="#cb4-119" aria-hidden="true" tabindex="-1"></a><span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_character_</span></span>
<span id="cb4-120"><a href="#cb4-120" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb4-121"><a href="#cb4-121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-122"><a href="#cb4-122" aria-hidden="true" tabindex="-1"></a><span class="co"># b) Consumo de cocaína</span></span>
<span id="cb4-123"><a href="#cb4-123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-124"><a href="#cb4-124" aria-hidden="true" tabindex="-1"></a>ENPG_filtrado <span class="ot">&lt;-</span> ENPG_filtrado <span class="sc">%&gt;%</span> </span>
<span id="cb4-125"><a href="#cb4-125" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb4-126"><a href="#cb4-126" aria-hidden="true" tabindex="-1"></a>    <span class="at">Consumo_coc =</span> <span class="fu">case_when</span>(</span>
<span id="cb4-127"><a href="#cb4-127" aria-hidden="true" tabindex="-1"></a>    COC_1 <span class="sc">==</span> <span class="dv">2</span> <span class="sc">~</span> <span class="dv">0</span>, <span class="co">#NO HA CONSUMIDO COCAINA</span></span>
<span id="cb4-128"><a href="#cb4-128" aria-hidden="true" tabindex="-1"></a>    COC_4 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">~</span> <span class="dv">1</span>, <span class="co">#HA CONSUMIDO ULTIMOS 30D</span></span>
<span id="cb4-129"><a href="#cb4-129" aria-hidden="true" tabindex="-1"></a>    COC_4 <span class="sc">==</span> <span class="dv">2</span> <span class="sc">~</span> <span class="dv">0</span>,</span>
<span id="cb4-130"><a href="#cb4-130" aria-hidden="true" tabindex="-1"></a>    COC_4 <span class="sc">==</span> <span class="dv">3</span> <span class="sc">~</span> <span class="dv">0</span>)</span>
<span id="cb4-131"><a href="#cb4-131" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb4-132"><a href="#cb4-132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-133"><a href="#cb4-133" aria-hidden="true" tabindex="-1"></a>ENPG_filtrado <span class="ot">&lt;-</span> ENPG_filtrado <span class="sc">%&gt;%</span> </span>
<span id="cb4-134"><a href="#cb4-134" aria-hidden="true" tabindex="-1"></a><span class="fu">mutate</span> (<span class="at">Consumo_coc =</span><span class="fu">case_when</span>(</span>
<span id="cb4-135"><a href="#cb4-135" aria-hidden="true" tabindex="-1"></a>Consumo_coc <span class="sc">==</span> <span class="dv">1</span> <span class="sc">~</span> <span class="st">"Sí"</span>,</span>
<span id="cb4-136"><a href="#cb4-136" aria-hidden="true" tabindex="-1"></a>Consumo_coc <span class="sc">==</span> <span class="dv">0</span> <span class="sc">~</span> <span class="st">"No"</span>,</span>
<span id="cb4-137"><a href="#cb4-137" aria-hidden="true" tabindex="-1"></a><span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_character_</span></span>
<span id="cb4-138"><a href="#cb4-138" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb4-139"><a href="#cb4-139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-140"><a href="#cb4-140" aria-hidden="true" tabindex="-1"></a><span class="co"># c) Consumo de pasta base</span></span>
<span id="cb4-141"><a href="#cb4-141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-142"><a href="#cb4-142" aria-hidden="true" tabindex="-1"></a>ENPG_filtrado <span class="ot">&lt;-</span> ENPG_filtrado <span class="sc">%&gt;%</span> </span>
<span id="cb4-143"><a href="#cb4-143" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb4-144"><a href="#cb4-144" aria-hidden="true" tabindex="-1"></a>    <span class="at">Consumo_pb =</span> <span class="fu">case_when</span>(</span>
<span id="cb4-145"><a href="#cb4-145" aria-hidden="true" tabindex="-1"></a>    PB_1 <span class="sc">==</span> <span class="dv">2</span> <span class="sc">~</span> <span class="dv">0</span>, <span class="co">#NO HA CONSUMIDO PASTA BASE</span></span>
<span id="cb4-146"><a href="#cb4-146" aria-hidden="true" tabindex="-1"></a>    PB_4 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">~</span> <span class="dv">1</span>, <span class="co">#HA CONSUMIDO ULTIMOS 30D</span></span>
<span id="cb4-147"><a href="#cb4-147" aria-hidden="true" tabindex="-1"></a>    PB_4 <span class="sc">==</span> <span class="dv">2</span> <span class="sc">~</span> <span class="dv">0</span>,</span>
<span id="cb4-148"><a href="#cb4-148" aria-hidden="true" tabindex="-1"></a>    PB_4 <span class="sc">==</span> <span class="dv">3</span> <span class="sc">~</span> <span class="dv">0</span>)</span>
<span id="cb4-149"><a href="#cb4-149" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb4-150"><a href="#cb4-150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-151"><a href="#cb4-151" aria-hidden="true" tabindex="-1"></a>ENPG_filtrado <span class="ot">&lt;-</span> ENPG_filtrado <span class="sc">%&gt;%</span> </span>
<span id="cb4-152"><a href="#cb4-152" aria-hidden="true" tabindex="-1"></a><span class="fu">mutate</span> (<span class="at">Consumo_pb =</span><span class="fu">case_when</span>(</span>
<span id="cb4-153"><a href="#cb4-153" aria-hidden="true" tabindex="-1"></a>Consumo_pb <span class="sc">==</span> <span class="dv">1</span> <span class="sc">~</span> <span class="st">"Sí"</span>,</span>
<span id="cb4-154"><a href="#cb4-154" aria-hidden="true" tabindex="-1"></a>Consumo_pb <span class="sc">==</span> <span class="dv">0</span> <span class="sc">~</span> <span class="st">"No"</span>,</span>
<span id="cb4-155"><a href="#cb4-155" aria-hidden="true" tabindex="-1"></a><span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_character_</span></span>
<span id="cb4-156"><a href="#cb4-156" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb4-157"><a href="#cb4-157" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-158"><a href="#cb4-158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-159"><a href="#cb4-159" aria-hidden="true" tabindex="-1"></a><span class="co"># b) Consumo de tusi</span></span>
<span id="cb4-160"><a href="#cb4-160" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-161"><a href="#cb4-161" aria-hidden="true" tabindex="-1"></a>ENPG_filtrado <span class="ot">&lt;-</span> ENPG_filtrado <span class="sc">%&gt;%</span> </span>
<span id="cb4-162"><a href="#cb4-162" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb4-163"><a href="#cb4-163" aria-hidden="true" tabindex="-1"></a>    <span class="at">Consumo_tus =</span> <span class="fu">case_when</span>(</span>
<span id="cb4-164"><a href="#cb4-164" aria-hidden="true" tabindex="-1"></a>    TUS_1 <span class="sc">==</span> <span class="dv">2</span> <span class="sc">~</span> <span class="dv">0</span>, <span class="co">#NO HA CONSUMIDO TUSI</span></span>
<span id="cb4-165"><a href="#cb4-165" aria-hidden="true" tabindex="-1"></a>    TUS_4 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">~</span> <span class="dv">1</span>, <span class="co">#HA CONSUMIDO ULTIMOS 30D</span></span>
<span id="cb4-166"><a href="#cb4-166" aria-hidden="true" tabindex="-1"></a>    TUS_4 <span class="sc">==</span> <span class="dv">2</span> <span class="sc">~</span> <span class="dv">0</span>,</span>
<span id="cb4-167"><a href="#cb4-167" aria-hidden="true" tabindex="-1"></a>    TUS_4 <span class="sc">==</span> <span class="dv">3</span> <span class="sc">~</span> <span class="dv">0</span>)</span>
<span id="cb4-168"><a href="#cb4-168" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb4-169"><a href="#cb4-169" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-170"><a href="#cb4-170" aria-hidden="true" tabindex="-1"></a>ENPG_filtrado <span class="ot">&lt;-</span> ENPG_filtrado <span class="sc">%&gt;%</span> </span>
<span id="cb4-171"><a href="#cb4-171" aria-hidden="true" tabindex="-1"></a><span class="fu">mutate</span> (<span class="at">Consumo_tus =</span><span class="fu">case_when</span>(</span>
<span id="cb4-172"><a href="#cb4-172" aria-hidden="true" tabindex="-1"></a>Consumo_tus <span class="sc">==</span> <span class="dv">1</span> <span class="sc">~</span> <span class="st">"Sí"</span>,</span>
<span id="cb4-173"><a href="#cb4-173" aria-hidden="true" tabindex="-1"></a>Consumo_tus <span class="sc">==</span> <span class="dv">0</span> <span class="sc">~</span> <span class="st">"No"</span>,</span>
<span id="cb4-174"><a href="#cb4-174" aria-hidden="true" tabindex="-1"></a><span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_character_</span></span>
<span id="cb4-175"><a href="#cb4-175" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb4-176"><a href="#cb4-176" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-177"><a href="#cb4-177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-178"><a href="#cb4-178" aria-hidden="true" tabindex="-1"></a><span class="do">## Salud mental y general</span></span>
<span id="cb4-179"><a href="#cb4-179" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-180"><a href="#cb4-180" aria-hidden="true" tabindex="-1"></a><span class="co"># a) Salud General</span></span>
<span id="cb4-181"><a href="#cb4-181" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-182"><a href="#cb4-182" aria-hidden="true" tabindex="-1"></a>ENPG_filtrado <span class="ot">&lt;-</span> ENPG_filtrado <span class="sc">%&gt;%</span> </span>
<span id="cb4-183"><a href="#cb4-183" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">salud_general =</span> ST_1) </span>
<span id="cb4-184"><a href="#cb4-184" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-185"><a href="#cb4-185" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-186"><a href="#cb4-186" aria-hidden="true" tabindex="-1"></a>ENPG_filtrado <span class="ot">&lt;-</span> ENPG_filtrado <span class="sc">%&gt;%</span>  </span>
<span id="cb4-187"><a href="#cb4-187" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">salud_general =</span> <span class="fu">case_when</span>(</span>
<span id="cb4-188"><a href="#cb4-188" aria-hidden="true" tabindex="-1"></a>    salud_general <span class="sc">==</span> <span class="dv">88</span> <span class="sc">~</span> <span class="cn">NA</span>,</span>
<span id="cb4-189"><a href="#cb4-189" aria-hidden="true" tabindex="-1"></a>    salud_general <span class="sc">==</span> <span class="dv">99</span> <span class="sc">~</span> <span class="cn">NA</span>,</span>
<span id="cb4-190"><a href="#cb4-190" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> salud_general</span>
<span id="cb4-191"><a href="#cb4-191" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb4-192"><a href="#cb4-192" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-193"><a href="#cb4-193" aria-hidden="true" tabindex="-1"></a><span class="co"># b) Salud Mental: </span></span>
<span id="cb4-194"><a href="#cb4-194" aria-hidden="true" tabindex="-1"></a>ENPG_filtrado <span class="ot">&lt;-</span> ENPG_filtrado <span class="sc">%&gt;%</span> </span>
<span id="cb4-195"><a href="#cb4-195" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">sm_sueno =</span> T_SG_1_B, <span class="at">sm_agobiado =</span> T_SG_1_E, </span>
<span id="cb4-196"><a href="#cb4-196" aria-hidden="true" tabindex="-1"></a>         <span class="at">sm_frustracion =</span> T_SG_1_F, <span class="at">sm_depresion =</span> T_SG_1_I, </span>
<span id="cb4-197"><a href="#cb4-197" aria-hidden="true" tabindex="-1"></a>         <span class="at">sm_confianza =</span> T_SG_1_J, sm_valía<span class="at">_moral =</span> T_SG_1_K)</span>
<span id="cb4-198"><a href="#cb4-198" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-199"><a href="#cb4-199" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-200"><a href="#cb4-200" aria-hidden="true" tabindex="-1"></a><span class="do">## Percepción de riesgo</span></span>
<span id="cb4-201"><a href="#cb4-201" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-202"><a href="#cb4-202" aria-hidden="true" tabindex="-1"></a>ENPG_filtrado <span class="ot">&lt;-</span> ENPG_filtrado <span class="sc">%&gt;%</span> </span>
<span id="cb4-203"><a href="#cb4-203" aria-hidden="true" tabindex="-1"></a><span class="fu">rename</span> (<span class="at">Riesgo_ocasion =</span> T_PR_1_2,</span>
<span id="cb4-204"><a href="#cb4-204" aria-hidden="true" tabindex="-1"></a><span class="at">Riesgo_diario =</span> T_PR_1_3)</span>
<span id="cb4-205"><a href="#cb4-205" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-206"><a href="#cb4-206" aria-hidden="true" tabindex="-1"></a>ENPG_filtrado <span class="ot">&lt;-</span> ENPG_filtrado <span class="sc">%&gt;%</span> </span>
<span id="cb4-207"><a href="#cb4-207" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb4-208"><a href="#cb4-208" aria-hidden="true" tabindex="-1"></a>    <span class="at">Riesgo_ocasion_rec =</span> <span class="fu">case_when</span>(</span>
<span id="cb4-209"><a href="#cb4-209" aria-hidden="true" tabindex="-1"></a>      Riesgo_ocasion <span class="sc">==</span> <span class="dv">88</span> <span class="sc">~</span> <span class="cn">NA_real_</span>,</span>
<span id="cb4-210"><a href="#cb4-210" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> Riesgo_ocasion</span>
<span id="cb4-211"><a href="#cb4-211" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb4-212"><a href="#cb4-212" aria-hidden="true" tabindex="-1"></a>    <span class="at">Riesgo_diario_rec =</span> <span class="fu">case_when</span>(</span>
<span id="cb4-213"><a href="#cb4-213" aria-hidden="true" tabindex="-1"></a>      Riesgo_diario <span class="sc">==</span> <span class="dv">88</span> <span class="sc">~</span> <span class="cn">NA_real_</span>,</span>
<span id="cb4-214"><a href="#cb4-214" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> Riesgo_diario</span>
<span id="cb4-215"><a href="#cb4-215" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb4-216"><a href="#cb4-216" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="hipótesis-de-trabajo" class="level2" data-number="6">
<h2 data-number="6" class="anchored" data-anchor-id="hipótesis-de-trabajo"><span class="header-section-number">6</span> Hipótesis de trabajo</h2>
<ol type="a">
<li><p>Existe una asociación significativa entre el género y el consumo de alcohol, siendo las personas de género masculino las que presentan una mayor probabilidad de consumo, respecto de los otros géneros de las personas encuestadas.</p></li>
<li><p>Existe una asociación significativa entre el consumo de alcohol y el consumo de otras drogas, de manera que quienes reportan consumo de sustancias psicoactivas, tienen mayor probabilidad de haber consumido alcohol los últimos 30 días.</p></li>
<li><p>Las personas que presentan mayor habitualidad en problemas de salud mental tienen mayor probabilidad de reportar consumo de alcohol los últimos 30 días.</p></li>
<li><p>Las personas que presentan una menor percepción de riesgo asociada al consumo de alcohol tienden a mayor probabilidad de consumo de alcohol, en comparación con aquellas que perciben un mayor riesgo.</p></li>
</ol>
</section>
<section id="análisis-descriptivo" class="level2" data-number="7">
<h2 data-number="7" class="anchored" data-anchor-id="análisis-descriptivo"><span class="header-section-number">7</span> Análisis descriptivo</h2>
<p>En primera instancia, se realizará un análisis descriptivo para caracterizar la distribución de las variables de interés y explorar su relación con el consumo de alcohol en los últimos 30 días, que corresponde a la variable principal del estudio. En particular, se examinará cómo se comportan las variables seleccionadas al comparar los grupos que reportan consumo reciente versus quienes no lo reportan.</p>
<p>Para las variables nominales, se analizará su distribución en función del consumo de alcohol mediante gráficos de barras apiladas, lo que permitirá visualizar diferencias en la composición de categorías entre ambos grupos. En el caso de las variables numéricas u ordinales, se estimarán correlaciones con el consumo de alcohol (según corresponda al nivel de medición) y, adicionalmente, se utilizarán gráficos de caja para describir la dispersión y las diferencias en la distribución de estas variables entre personas que consumieron alcohol en los últimos 30 días y quienes no, facilitando la identificación de patrones, asimetrías y posibles valores atípicos relevantes para el análisis posterior.</p>
<p><strong>Consumo de alcohol según estado civil</strong></p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Variable creada sólo para el gráfico </span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>ENPG_filtrado <span class="ot">&lt;-</span> ENPG_filtrado <span class="sc">%&gt;%</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">alcohol_raw =</span> <span class="fu">str_to_lower</span>(<span class="fu">str_squish</span>(<span class="fu">as.character</span>(alcohol_30d))),  </span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">alcohol_30d_plot =</span> <span class="fu">case_when</span>(</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>      alcohol_raw <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"1"</span>, <span class="st">"sí"</span>, <span class="st">"si"</span>, <span class="st">"s"</span>, <span class="st">"true"</span>, <span class="st">"verdadero"</span>) <span class="sc">~</span> <span class="st">"Sí consume alcohol"</span>,</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>      alcohol_raw <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"2"</span>, <span class="st">"0"</span>, <span class="st">"no"</span>, <span class="st">"n"</span>, <span class="st">"false"</span>, <span class="st">"falso"</span>)     <span class="sc">~</span> <span class="st">"No consume alcohol"</span>,</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_character_</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">alcohol_30d_plot =</span> <span class="fu">factor</span>(</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>      alcohol_30d_plot,</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>      <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"No consume alcohol"</span>, <span class="st">"Sí consume alcohol"</span>)</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>ENPG_filtrado <span class="ot">&lt;-</span> ENPG_filtrado <span class="sc">%&gt;%</span></span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">estado_civil_plot =</span> <span class="fu">case_when</span>(</span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>      estado_civil <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="st">"1"</span>) <span class="sc">~</span> <span class="st">"Soltero/a"</span>,</span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>      estado_civil <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="st">"2"</span>) <span class="sc">~</span> <span class="st">"Casado/a"</span>,</span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a>      estado_civil <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="st">"3"</span>) <span class="sc">~</span> <span class="st">"Divorciado/a"</span>,</span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a>      estado_civil <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="st">"4"</span>) <span class="sc">~</span> <span class="st">"Viudo/a"</span>,</span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a>      estado_civil <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="st">"5"</span>) <span class="sc">~</span> <span class="st">"Anulado/a"</span>,</span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a>      estado_civil <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">6</span>, <span class="st">"6"</span>) <span class="sc">~</span> <span class="st">"Conviviente civil"</span>,</span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_character_</span></span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb5-29"><a href="#cb5-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">estado_civil_plot =</span> <span class="fu">factor</span>(</span>
<span id="cb5-30"><a href="#cb5-30" aria-hidden="true" tabindex="-1"></a>      estado_civil_plot,</span>
<span id="cb5-31"><a href="#cb5-31" aria-hidden="true" tabindex="-1"></a>      <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Soltero/a"</span>, <span class="st">"Casado/a"</span>, <span class="st">"Divorciado/a"</span>, <span class="st">"Viudo/a"</span>, <span class="st">"Anulado/a"</span>, <span class="st">"Conviviente civil"</span>)</span>
<span id="cb5-32"><a href="#cb5-32" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb5-33"><a href="#cb5-33" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb5-34"><a href="#cb5-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-35"><a href="#cb5-35" aria-hidden="true" tabindex="-1"></a><span class="co"># Datos para gráfico: 100% apilado dentro de cada barra</span></span>
<span id="cb5-36"><a href="#cb5-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-37"><a href="#cb5-37" aria-hidden="true" tabindex="-1"></a>df_estado_civil <span class="ot">&lt;-</span> ENPG_filtrado <span class="sc">%&gt;%</span></span>
<span id="cb5-38"><a href="#cb5-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(alcohol_30d_plot), <span class="sc">!</span><span class="fu">is.na</span>(estado_civil_plot)) <span class="sc">%&gt;%</span></span>
<span id="cb5-39"><a href="#cb5-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(alcohol_30d_plot, estado_civil_plot, <span class="at">name =</span> <span class="st">"Conteo"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb5-40"><a href="#cb5-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">complete</span>(alcohol_30d_plot, estado_civil_plot, <span class="at">fill =</span> <span class="fu">list</span>(<span class="at">Conteo =</span> <span class="dv">0</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb5-41"><a href="#cb5-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(alcohol_30d_plot) <span class="sc">%&gt;%</span></span>
<span id="cb5-42"><a href="#cb5-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb5-43"><a href="#cb5-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">Total =</span> <span class="fu">sum</span>(Conteo),</span>
<span id="cb5-44"><a href="#cb5-44" aria-hidden="true" tabindex="-1"></a>    <span class="at">Prop  =</span> <span class="fu">ifelse</span>(Total <span class="sc">==</span> <span class="dv">0</span>, <span class="dv">0</span>, Conteo <span class="sc">/</span> Total),</span>
<span id="cb5-45"><a href="#cb5-45" aria-hidden="true" tabindex="-1"></a>    <span class="at">label_pct =</span> <span class="fu">ifelse</span>(Conteo <span class="sc">==</span> <span class="dv">0</span>, <span class="st">""</span>, <span class="fu">percent</span>(Prop, <span class="at">accuracy =</span> <span class="fl">0.1</span>)),</span>
<span id="cb5-46"><a href="#cb5-46" aria-hidden="true" tabindex="-1"></a>    <span class="at">text =</span> <span class="fu">paste0</span>(</span>
<span id="cb5-47"><a href="#cb5-47" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Consumo: "</span>, alcohol_30d_plot,</span>
<span id="cb5-48"><a href="#cb5-48" aria-hidden="true" tabindex="-1"></a>      <span class="st">"&lt;br&gt;Estado civil: "</span>, estado_civil_plot,</span>
<span id="cb5-49"><a href="#cb5-49" aria-hidden="true" tabindex="-1"></a>      <span class="st">"&lt;br&gt;Porcentaje: "</span>, <span class="fu">percent</span>(Prop, <span class="at">accuracy =</span> <span class="fl">0.1</span>),</span>
<span id="cb5-50"><a href="#cb5-50" aria-hidden="true" tabindex="-1"></a>      <span class="st">"&lt;br&gt;n: "</span>, Conteo</span>
<span id="cb5-51"><a href="#cb5-51" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb5-52"><a href="#cb5-52" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb5-53"><a href="#cb5-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb5-54"><a href="#cb5-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-55"><a href="#cb5-55" aria-hidden="true" tabindex="-1"></a><span class="co"># Chequeo</span></span>
<span id="cb5-56"><a href="#cb5-56" aria-hidden="true" tabindex="-1"></a>df_estado_civil <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(alcohol_30d_plot) <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="at">suma_prop =</span> <span class="fu">sum</span>(Prop))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 2
  alcohol_30d_plot   suma_prop
  &lt;fct&gt;                  &lt;dbl&gt;
1 No consume alcohol         1
2 Sí consume alcohol         1</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Gráfico: siempre suma 100%</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>Grafico_estado_civil <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df_estado_civil, <span class="fu">aes</span>(<span class="at">y =</span> alcohol_30d_plot, <span class="at">x =</span> Conteo, <span class="at">fill =</span> estado_civil_plot, <span class="at">text =</span> text)) <span class="sc">+</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">position =</span> <span class="st">"fill"</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">width =</span> <span class="fl">0.65</span>) <span class="sc">+</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">label =</span> label_pct),</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">position =</span> <span class="fu">position_fill</span>(<span class="at">vjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"white"</span>,</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">3</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">labels =</span> <span class="fu">percent_format</span>(<span class="at">accuracy =</span> <span class="dv">1</span>), <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Estado civil según consumo de alcohol (últimos 30 días)"</span>,</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Porcentaje"</span>,</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="cn">NULL</span>,</span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"Estado civil"</span></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>))</span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplotly</span>(Grafico_estado_civil, <span class="at">tooltip =</span> <span class="st">"text"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-9eceb20dc2a931752ae4" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-9eceb20dc2a931752ae4">{"x":{"data":[{"orientation":"v","width":[0.56935036945812811,0.60401228989698175],"base":[0.67500000000000004,1.675],"x":[0.71532481527093594,0.69799385505150913],"y":[0.64999999999999991,0.65000000000000013],"text":["Consumo: No consume alcohol<br>Estado civil: Soltero/a<br>Porcentaje: 56.9%<br>n: 7397","Consumo: Sí consume alcohol<br>Estado civil: Soltero/a<br>Porcentaje: 60.4%<br>n: 3342"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(248,118,109,1)","line":{"width":1.8897637795275593,"color":"rgba(0,0,0,1)"}},"name":"Soltero/a","legendgroup":"Soltero/a","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.26985837438423643,0.24760527742635099],"base":[0.67500000000000004,1.675],"x":[0.29572044334975373,0.27218507138984277],"y":[0.64999999999999991,0.65000000000000013],"text":["Consumo: No consume alcohol<br>Estado civil: Casado/a<br>Porcentaje: 27.0%<br>n: 3506","Consumo: Sí consume alcohol<br>Estado civil: Casado/a<br>Porcentaje: 24.8%<br>n: 1370"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(183,159,0,1)","line":{"width":1.8897637795275593,"color":"rgba(0,0,0,1)"}},"name":"Casado/a","legendgroup":"Casado/a","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.079202586206896561,0.08404120730164466],"base":[0.67500000000000004,1.675],"x":[0.12118996305418719,0.10636182902584493],"y":[0.64999999999999991,0.65000000000000013],"text":["Consumo: No consume alcohol<br>Estado civil: Divorciado/a<br>Porcentaje: 7.9%<br>n: 1029","Consumo: Sí consume alcohol<br>Estado civil: Divorciado/a<br>Porcentaje: 8.4%<br>n: 465"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(0,186,56,1)","line":{"width":1.8897637795275593,"color":"rgba(0,0,0,1)"}},"name":"Divorciado/a","legendgroup":"Divorciado/a","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.051570197044334978,0.024760527742635104],"base":[0.67500000000000004,1.675],"x":[0.055803571428571432,0.05196096150370505],"y":[0.64999999999999991,0.65000000000000013],"text":["Consumo: No consume alcohol<br>Estado civil: Viudo/a<br>Porcentaje: 5.2%<br>n: 670","Consumo: Sí consume alcohol<br>Estado civil: Viudo/a<br>Porcentaje: 2.5%<br>n: 137"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(0,191,196,1)","line":{"width":1.8897637795275593,"color":"rgba(0,0,0,1)"}},"name":"Viudo/a","legendgroup":"Viudo/a","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.0062346059113300503,0.0059642147117296221],"base":[0.67500000000000004,1.675],"x":[0.026901169950738917,0.03659859027652268],"y":[0.64999999999999991,0.65000000000000013],"text":["Consumo: No consume alcohol<br>Estado civil: Anulado/a<br>Porcentaje: 0.6%<br>n: 81","Consumo: Sí consume alcohol<br>Estado civil: Anulado/a<br>Porcentaje: 0.6%<br>n: 33"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(97,156,255,1)","line":{"width":1.8897637795275593,"color":"rgba(0,0,0,1)"}},"name":"Anulado/a","legendgroup":"Anulado/a","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.023783866995073892,0.033616482920657872],"base":[0.67500000000000004,1.675],"x":[0.011891933497536946,0.016808241460328936],"y":[0.64999999999999991,0.65000000000000013],"text":["Consumo: No consume alcohol<br>Estado civil: Conviviente civil<br>Porcentaje: 2.4%<br>n: 309","Consumo: Sí consume alcohol<br>Estado civil: Conviviente civil<br>Porcentaje: 3.4%<br>n: 186"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(245,100,227,1)","line":{"width":1.8897637795275593,"color":"rgba(0,0,0,1)"}},"name":"Conviviente civil","legendgroup":"Conviviente civil","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0.71532481527093594,0.69799385505150913],"y":[1,2],"text":["56.9%","60.4%"],"hovertext":["Consumo: No consume alcohol<br>Estado civil: Soltero/a<br>Porcentaje: 56.9%<br>n: 7397","Consumo: Sí consume alcohol<br>Estado civil: Soltero/a<br>Porcentaje: 60.4%<br>n: 3342"],"textfont":{"size":11.338582677165356,"color":"rgba(255,255,255,1)"},"type":"scatter","mode":"text","hoveron":"points","name":"Soltero/a","legendgroup":"Soltero/a","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0.29572044334975373,0.27218507138984277],"y":[1,2],"text":["27.0%","24.8%"],"hovertext":["Consumo: No consume alcohol<br>Estado civil: Casado/a<br>Porcentaje: 27.0%<br>n: 3506","Consumo: Sí consume alcohol<br>Estado civil: Casado/a<br>Porcentaje: 24.8%<br>n: 1370"],"textfont":{"size":11.338582677165356,"color":"rgba(255,255,255,1)"},"type":"scatter","mode":"text","hoveron":"points","name":"Casado/a","legendgroup":"Casado/a","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0.12118996305418719,0.10636182902584493],"y":[1,2],"text":["7.9%","8.4%"],"hovertext":["Consumo: No consume alcohol<br>Estado civil: Divorciado/a<br>Porcentaje: 7.9%<br>n: 1029","Consumo: Sí consume alcohol<br>Estado civil: Divorciado/a<br>Porcentaje: 8.4%<br>n: 465"],"textfont":{"size":11.338582677165356,"color":"rgba(255,255,255,1)"},"type":"scatter","mode":"text","hoveron":"points","name":"Divorciado/a","legendgroup":"Divorciado/a","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0.055803571428571432,0.05196096150370505],"y":[1,2],"text":["5.2%","2.5%"],"hovertext":["Consumo: No consume alcohol<br>Estado civil: Viudo/a<br>Porcentaje: 5.2%<br>n: 670","Consumo: Sí consume alcohol<br>Estado civil: Viudo/a<br>Porcentaje: 2.5%<br>n: 137"],"textfont":{"size":11.338582677165356,"color":"rgba(255,255,255,1)"},"type":"scatter","mode":"text","hoveron":"points","name":"Viudo/a","legendgroup":"Viudo/a","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0.026901169950738917,0.03659859027652268],"y":[1,2],"text":["0.6%","0.6%"],"hovertext":["Consumo: No consume alcohol<br>Estado civil: Anulado/a<br>Porcentaje: 0.6%<br>n: 81","Consumo: Sí consume alcohol<br>Estado civil: Anulado/a<br>Porcentaje: 0.6%<br>n: 33"],"textfont":{"size":11.338582677165356,"color":"rgba(255,255,255,1)"},"type":"scatter","mode":"text","hoveron":"points","name":"Anulado/a","legendgroup":"Anulado/a","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0.011891933497536946,0.016808241460328936],"y":[1,2],"text":["2.4%","3.4%"],"hovertext":["Consumo: No consume alcohol<br>Estado civil: Conviviente civil<br>Porcentaje: 2.4%<br>n: 309","Consumo: Sí consume alcohol<br>Estado civil: Conviviente civil<br>Porcentaje: 3.4%<br>n: 186"],"textfont":{"size":11.338582677165356,"color":"rgba(255,255,255,1)"},"type":"scatter","mode":"text","hoveron":"points","name":"Conviviente civil","legendgroup":"Conviviente civil","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":40.840182648401829,"r":7.3059360730593621,"b":37.260273972602747,"l":116.16438356164386},"paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"title":{"text":"Estado civil según consumo de alcohol (últimos 30 días)","font":{"color":"rgba(0,0,0,1)","family":"","size":17.534246575342465},"x":0.5,"xref":"paper"},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[0,1],"tickmode":"array","ticktext":["0%","25%","50%","75%","100%"],"tickvals":[0,0.25,0.5,0.75,1],"categoryorder":"array","categoryarray":["0%","25%","50%","75%","100%"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0,"zeroline":false,"anchor":"y","title":{"text":"Porcentaje","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[0.40000000000000002,2.6000000000000001],"tickmode":"array","ticktext":["No consume alcohol","Sí consume alcohol"],"tickvals":[1,2],"categoryorder":"array","categoryarray":["No consume alcohol","Sí consume alcohol"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0,"zeroline":false,"anchor":"x","title":{"text":"","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","layer":"below","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":true,"legend":{"bgcolor":null,"bordercolor":null,"borderwidth":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.68949771689498},"title":{"text":"Estado civil","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"5cec6b485988":{"x":{},"y":{},"fill":{},"text":{},"type":"bar"},"5cec7415fb6":{"x":{},"y":{},"fill":{},"text":{},"label":{}}},"cur_data":"5cec6b485988","visdat":{"5cec6b485988":["function (y) ","x"],"5cec7415fb6":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>En el grupo de personas que no consume alcohol en los últimos 30 días, la mayor proporción corresponde a solteros/as (56,9%), seguida por casados/as (27,0%) y divorciados/as (7,9%). El 8,2% restante se distribuye entre viudos/as, anulados/as y convivientes civiles.</p>
<p>En cambio, entre quienes sí consumen alcohol, predominan los/las solteros/as (60,4%), luego los/las casados/as (24,8%) y los/las divorciados/as (8,4%); el 6,4% restante se reparte entre viudos/as, anulados/as y convivientes civiles.</p>
<p>En términos comparativos, el consumo de alcohol se asocia con una mayor proporción de solteros/as y una menor proporción de casados/as, mientras que la proporción de divorciados/as se mantiene relativamente similar entre ambos grupos.</p>
<p><strong>Consumo de alcohol según pertenencia a un pueblo originario</strong></p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Datos para gráfico </span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>ENPG_filtrado <span class="ot">&lt;-</span> ENPG_filtrado <span class="sc">%&gt;%</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">pueblo_ind_plot =</span> <span class="fu">case_when</span>(</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>      DP_4 <span class="sc">%in%</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">12</span> <span class="sc">~</span> <span class="st">"Pertenece a un pueblo originario"</span>,</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>      DP_4 <span class="sc">==</span> <span class="dv">13</span>     <span class="sc">~</span> <span class="st">"No pertenece a un pueblo originario"</span>,</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span>           <span class="sc">~</span> <span class="cn">NA_character_</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">pueblo_ind_plot =</span> <span class="fu">factor</span>(</span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>      pueblo_ind_plot,</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>      <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Pertenece a un pueblo originario"</span>, <span class="st">"No pertenece a un pueblo originario"</span>)</span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>df_pueblo <span class="ot">&lt;-</span> ENPG_filtrado <span class="sc">%&gt;%</span></span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(alcohol_30d_plot), <span class="sc">!</span><span class="fu">is.na</span>(pueblo_ind_plot)) <span class="sc">%&gt;%</span></span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(alcohol_30d_plot, pueblo_ind_plot, <span class="at">name =</span> <span class="st">"Conteo"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">complete</span>(alcohol_30d_plot, pueblo_ind_plot, <span class="at">fill =</span> <span class="fu">list</span>(<span class="at">Conteo =</span> <span class="dv">0</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(alcohol_30d_plot) <span class="sc">%&gt;%</span></span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">Total =</span> <span class="fu">sum</span>(Conteo),</span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">Prop  =</span> <span class="fu">ifelse</span>(Total <span class="sc">==</span> <span class="dv">0</span>, <span class="dv">0</span>, Conteo <span class="sc">/</span> Total),</span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">label_pct =</span> <span class="fu">ifelse</span>(Conteo <span class="sc">==</span> <span class="dv">0</span>, <span class="st">""</span>, <span class="fu">percent</span>(Prop, <span class="at">accuracy =</span> <span class="fl">0.1</span>)),</span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">text =</span> <span class="fu">paste0</span>(</span>
<span id="cb8-28"><a href="#cb8-28" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Consumo: "</span>, alcohol_30d_plot,</span>
<span id="cb8-29"><a href="#cb8-29" aria-hidden="true" tabindex="-1"></a>      <span class="st">"&lt;br&gt;Pueblo originario: "</span>, pueblo_ind_plot,</span>
<span id="cb8-30"><a href="#cb8-30" aria-hidden="true" tabindex="-1"></a>      <span class="st">"&lt;br&gt;Porcentaje: "</span>, <span class="fu">percent</span>(Prop, <span class="at">accuracy =</span> <span class="fl">0.1</span>),</span>
<span id="cb8-31"><a href="#cb8-31" aria-hidden="true" tabindex="-1"></a>      <span class="st">"&lt;br&gt;n: "</span>, Conteo</span>
<span id="cb8-32"><a href="#cb8-32" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb8-33"><a href="#cb8-33" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb8-34"><a href="#cb8-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb8-35"><a href="#cb8-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-36"><a href="#cb8-36" aria-hidden="true" tabindex="-1"></a><span class="co"># Chequeo </span></span>
<span id="cb8-37"><a href="#cb8-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-38"><a href="#cb8-38" aria-hidden="true" tabindex="-1"></a>df_pueblo <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(alcohol_30d_plot) <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="at">suma_prop =</span> <span class="fu">sum</span>(Prop))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 2
  alcohol_30d_plot   suma_prop
  &lt;fct&gt;                  &lt;dbl&gt;
1 No consume alcohol         1
2 Sí consume alcohol         1</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Gráfico: siempre suma 100%</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>Grafico_pueblo <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df_pueblo, <span class="fu">aes</span>(<span class="at">y =</span> alcohol_30d_plot, <span class="at">x =</span> Conteo, <span class="at">fill =</span> pueblo_ind_plot, <span class="at">text =</span> text)) <span class="sc">+</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">position =</span> <span class="st">"fill"</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">width =</span> <span class="fl">0.65</span>) <span class="sc">+</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">label =</span> label_pct),</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">position =</span> <span class="fu">position_fill</span>(<span class="at">vjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"white"</span>,</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">3</span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">labels =</span> <span class="fu">percent_format</span>(<span class="at">accuracy =</span> <span class="dv">1</span>), <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Pertenencia a pueblo originario según consumo de alcohol (últimos 30 días)"</span>,</span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Porcentaje"</span>,</span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="cn">NULL</span>,</span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"Pueblo originario"</span></span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>))</span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplotly</span>(Grafico_pueblo, <span class="at">tooltip =</span> <span class="st">"text"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-f30d7598595affc4f25a" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-f30d7598595affc4f25a">{"x":{"data":[{"orientation":"v","width":[0.12754002463054193,0.13518886679920472],"base":[0.67500000000000004,1.675],"x":[0.93622998768472909,0.93240556660039764],"y":[0.64999999999999991,0.65000000000000013],"text":["Consumo: No consume alcohol<br>Pueblo originario: Pertenece a un pueblo originario<br>Porcentaje: 12.8%<br>n: 1657","Consumo: Sí consume alcohol<br>Pueblo originario: Pertenece a un pueblo originario<br>Porcentaje: 13.5%<br>n: 748"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(248,118,109,1)","line":{"width":1.8897637795275593,"color":"rgba(0,0,0,1)"}},"name":"Pertenece a un pueblo originario","legendgroup":"Pertenece a un pueblo originario","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.87245997536945807,0.86481113320079528],"base":[0.67500000000000004,1.675],"x":[0.43622998768472904,0.43240556660039764],"y":[0.64999999999999991,0.65000000000000013],"text":["Consumo: No consume alcohol<br>Pueblo originario: No pertenece a un pueblo originario<br>Porcentaje: 87.2%<br>n: 11335","Consumo: Sí consume alcohol<br>Pueblo originario: No pertenece a un pueblo originario<br>Porcentaje: 86.5%<br>n: 4785"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(0,191,196,1)","line":{"width":1.8897637795275593,"color":"rgba(0,0,0,1)"}},"name":"No pertenece a un pueblo originario","legendgroup":"No pertenece a un pueblo originario","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0.93622998768472909,0.93240556660039764],"y":[1,2],"text":["12.8%","13.5%"],"hovertext":["Consumo: No consume alcohol<br>Pueblo originario: Pertenece a un pueblo originario<br>Porcentaje: 12.8%<br>n: 1657","Consumo: Sí consume alcohol<br>Pueblo originario: Pertenece a un pueblo originario<br>Porcentaje: 13.5%<br>n: 748"],"textfont":{"size":11.338582677165356,"color":"rgba(255,255,255,1)"},"type":"scatter","mode":"text","hoveron":"points","name":"Pertenece a un pueblo originario","legendgroup":"Pertenece a un pueblo originario","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0.43622998768472904,0.43240556660039764],"y":[1,2],"text":["87.2%","86.5%"],"hovertext":["Consumo: No consume alcohol<br>Pueblo originario: No pertenece a un pueblo originario<br>Porcentaje: 87.2%<br>n: 11335","Consumo: Sí consume alcohol<br>Pueblo originario: No pertenece a un pueblo originario<br>Porcentaje: 86.5%<br>n: 4785"],"textfont":{"size":11.338582677165356,"color":"rgba(255,255,255,1)"},"type":"scatter","mode":"text","hoveron":"points","name":"No pertenece a un pueblo originario","legendgroup":"No pertenece a un pueblo originario","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":40.840182648401829,"r":7.3059360730593621,"b":37.260273972602747,"l":116.16438356164386},"paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"title":{"text":"Pertenencia a pueblo originario según consumo de alcohol (últimos 30 días)","font":{"color":"rgba(0,0,0,1)","family":"","size":17.534246575342465},"x":0.5,"xref":"paper"},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[0,1],"tickmode":"array","ticktext":["0%","25%","50%","75%","100%"],"tickvals":[0,0.25,0.5,0.75,1],"categoryorder":"array","categoryarray":["0%","25%","50%","75%","100%"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0,"zeroline":false,"anchor":"y","title":{"text":"Porcentaje","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[0.40000000000000002,2.6000000000000001],"tickmode":"array","ticktext":["No consume alcohol","Sí consume alcohol"],"tickvals":[1,2],"categoryorder":"array","categoryarray":["No consume alcohol","Sí consume alcohol"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0,"zeroline":false,"anchor":"x","title":{"text":"","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","layer":"below","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":true,"legend":{"bgcolor":null,"bordercolor":null,"borderwidth":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.68949771689498},"title":{"text":"Pueblo originario","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"5cec7b676882":{"x":{},"y":{},"fill":{},"text":{},"type":"bar"},"5cec157e1b4e":{"x":{},"y":{},"fill":{},"text":{},"label":{}}},"cur_data":"5cec7b676882","visdat":{"5cec7b676882":["function (y) ","x"],"5cec157e1b4e":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>En el grupo de personas que no consume alcohol en los últimos 30 días, el 12,8% declara pertenecer a un pueblo originario, mientras que el 87,2% señala no pertenecer.</p>
<p>Por su parte, entre quienes sí consumen alcohol, el 13,5% indica pertenecer a un pueblo originario y el 86,5% no pertenecer. En general, las diferencias entre ambos grupos son muy pequeñas, observándose una proporción apenas mayor de pertenencia a pueblo originario entre quienes consumen alcohol.</p>
<p><strong>Consumo de alcohol según adherencia a una religión</strong></p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Variable creada solo para el gráfico </span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>ENPG_filtrado <span class="ot">&lt;-</span> ENPG_filtrado <span class="sc">%&gt;%</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">religion_plot =</span> <span class="fu">case_when</span>(</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>      DP_5 <span class="sc">%in%</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">11</span> <span class="sc">~</span> <span class="st">"Adhiere a una religión"</span>,</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>      DP_5 <span class="sc">==</span> <span class="dv">12</span>     <span class="sc">~</span> <span class="st">"No adhiere a una religión"</span>,</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span>           <span class="sc">~</span> <span class="cn">NA_character_</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">religion_plot =</span> <span class="fu">factor</span>(</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>      religion_plot,</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>      <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Adhiere a una religión"</span>, <span class="st">"No adhiere a una religión"</span>)</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Datos para gráfico (100% apilado dentro de cada barra)</span></span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a>df_religion <span class="ot">&lt;-</span> ENPG_filtrado <span class="sc">%&gt;%</span></span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(alcohol_30d_plot), <span class="sc">!</span><span class="fu">is.na</span>(religion_plot)) <span class="sc">%&gt;%</span></span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(alcohol_30d_plot, religion_plot, <span class="at">name =</span> <span class="st">"Conteo"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">complete</span>(alcohol_30d_plot, religion_plot, <span class="at">fill =</span> <span class="fu">list</span>(<span class="at">Conteo =</span> <span class="dv">0</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(alcohol_30d_plot) <span class="sc">%&gt;%</span></span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">Total =</span> <span class="fu">sum</span>(Conteo),</span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">Prop  =</span> <span class="fu">ifelse</span>(Total <span class="sc">==</span> <span class="dv">0</span>, <span class="dv">0</span>, Conteo <span class="sc">/</span> Total),</span>
<span id="cb11-26"><a href="#cb11-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">label_pct =</span> <span class="fu">ifelse</span>(Conteo <span class="sc">==</span> <span class="dv">0</span>, <span class="st">""</span>, <span class="fu">percent</span>(Prop, <span class="at">accuracy =</span> <span class="fl">0.1</span>)),</span>
<span id="cb11-27"><a href="#cb11-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">text =</span> <span class="fu">paste0</span>(</span>
<span id="cb11-28"><a href="#cb11-28" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Consumo: "</span>, alcohol_30d_plot,</span>
<span id="cb11-29"><a href="#cb11-29" aria-hidden="true" tabindex="-1"></a>      <span class="st">"&lt;br&gt;Religión: "</span>, religion_plot,</span>
<span id="cb11-30"><a href="#cb11-30" aria-hidden="true" tabindex="-1"></a>      <span class="st">"&lt;br&gt;Porcentaje: "</span>, <span class="fu">percent</span>(Prop, <span class="at">accuracy =</span> <span class="fl">0.1</span>),</span>
<span id="cb11-31"><a href="#cb11-31" aria-hidden="true" tabindex="-1"></a>      <span class="st">"&lt;br&gt;n: "</span>, Conteo</span>
<span id="cb11-32"><a href="#cb11-32" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb11-33"><a href="#cb11-33" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb11-34"><a href="#cb11-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb11-35"><a href="#cb11-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-36"><a href="#cb11-36" aria-hidden="true" tabindex="-1"></a><span class="co"># Chequeo</span></span>
<span id="cb11-37"><a href="#cb11-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-38"><a href="#cb11-38" aria-hidden="true" tabindex="-1"></a>df_religion <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(alcohol_30d_plot) <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="at">suma_prop =</span> <span class="fu">sum</span>(Prop))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 2
  alcohol_30d_plot   suma_prop
  &lt;fct&gt;                  &lt;dbl&gt;
1 No consume alcohol         1
2 Sí consume alcohol         1</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Gráfico: siempre suma 100%</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>Grafico_religion <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df_religion, <span class="fu">aes</span>(<span class="at">y =</span> alcohol_30d_plot, <span class="at">x =</span> Conteo, <span class="at">fill =</span> religion_plot, <span class="at">text =</span> text)) <span class="sc">+</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">position =</span> <span class="st">"fill"</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">width =</span> <span class="fl">0.65</span>) <span class="sc">+</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">label =</span> label_pct),</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">position =</span> <span class="fu">position_fill</span>(<span class="at">vjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"white"</span>,</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">3</span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">labels =</span> <span class="fu">percent_format</span>(<span class="at">accuracy =</span> <span class="dv">1</span>), <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Religión según consumo de alcohol (últimos 30 días)"</span>,</span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Porcentaje"</span>,</span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="cn">NULL</span>,</span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"Religión"</span></span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>))</span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplotly</span>(Grafico_religion, <span class="at">tooltip =</span> <span class="st">"text"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-b85bf888dc62471906a9" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-b85bf888dc62471906a9">{"x":{"data":[{"orientation":"v","width":[0.73745381773399021,0.66040122898969811],"base":[0.67500000000000004,1.675],"x":[0.63127309113300489,0.66979938550515095],"y":[0.64999999999999991,0.65000000000000013],"text":["Consumo: No consume alcohol<br>Religión: Adhiere a una religión<br>Porcentaje: 73.7%<br>n: 9581","Consumo: Sí consume alcohol<br>Religión: Adhiere a una religión<br>Porcentaje: 66.0%<br>n: 3654"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(248,118,109,1)","line":{"width":1.8897637795275593,"color":"rgba(0,0,0,1)"}},"name":"Adhiere a una religión","legendgroup":"Adhiere a una religión","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.26254618226600984,0.33959877101030184],"base":[0.67500000000000004,1.675],"x":[0.13127309113300492,0.16979938550515092],"y":[0.64999999999999991,0.65000000000000013],"text":["Consumo: No consume alcohol<br>Religión: No adhiere a una religión<br>Porcentaje: 26.3%<br>n: 3411","Consumo: Sí consume alcohol<br>Religión: No adhiere a una religión<br>Porcentaje: 34.0%<br>n: 1879"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(0,191,196,1)","line":{"width":1.8897637795275593,"color":"rgba(0,0,0,1)"}},"name":"No adhiere a una religión","legendgroup":"No adhiere a una religión","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0.63127309113300489,0.66979938550515095],"y":[1,2],"text":["73.7%","66.0%"],"hovertext":["Consumo: No consume alcohol<br>Religión: Adhiere a una religión<br>Porcentaje: 73.7%<br>n: 9581","Consumo: Sí consume alcohol<br>Religión: Adhiere a una religión<br>Porcentaje: 66.0%<br>n: 3654"],"textfont":{"size":11.338582677165356,"color":"rgba(255,255,255,1)"},"type":"scatter","mode":"text","hoveron":"points","name":"Adhiere a una religión","legendgroup":"Adhiere a una religión","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0.13127309113300492,0.16979938550515092],"y":[1,2],"text":["26.3%","34.0%"],"hovertext":["Consumo: No consume alcohol<br>Religión: No adhiere a una religión<br>Porcentaje: 26.3%<br>n: 3411","Consumo: Sí consume alcohol<br>Religión: No adhiere a una religión<br>Porcentaje: 34.0%<br>n: 1879"],"textfont":{"size":11.338582677165356,"color":"rgba(255,255,255,1)"},"type":"scatter","mode":"text","hoveron":"points","name":"No adhiere a una religión","legendgroup":"No adhiere a una religión","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":40.840182648401829,"r":7.3059360730593621,"b":37.260273972602747,"l":116.16438356164386},"paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"title":{"text":"Religión según consumo de alcohol (últimos 30 días)","font":{"color":"rgba(0,0,0,1)","family":"","size":17.534246575342465},"x":0.5,"xref":"paper"},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[0,1],"tickmode":"array","ticktext":["0%","25%","50%","75%","100%"],"tickvals":[0,0.25,0.5,0.75,1],"categoryorder":"array","categoryarray":["0%","25%","50%","75%","100%"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0,"zeroline":false,"anchor":"y","title":{"text":"Porcentaje","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[0.40000000000000002,2.6000000000000001],"tickmode":"array","ticktext":["No consume alcohol","Sí consume alcohol"],"tickvals":[1,2],"categoryorder":"array","categoryarray":["No consume alcohol","Sí consume alcohol"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0,"zeroline":false,"anchor":"x","title":{"text":"","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","layer":"below","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":true,"legend":{"bgcolor":null,"bordercolor":null,"borderwidth":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.68949771689498},"title":{"text":"Religión","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"5cec4d2f79d8":{"x":{},"y":{},"fill":{},"text":{},"type":"bar"},"5cec46d16b3b":{"x":{},"y":{},"fill":{},"text":{},"label":{}}},"cur_data":"5cec4d2f79d8","visdat":{"5cec4d2f79d8":["function (y) ","x"],"5cec46d16b3b":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>En el grupo de personas que no consume alcohol en los últimos 30 días, el 73,7% señala que adhiere a una religión, mientras que el 26,3% indica no adherir.</p>
<p>En cambio, entre quienes sí consumen alcohol, el 66,0% declara adherir a una religión y el 34,0% no adherir. En comparación, se observa que en el grupo que consume alcohol hay una menor proporción de personas religiosas y una mayor proporción de personas que no adhieren a una religión.</p>
<p><strong>Consumo de alcohol según género</strong></p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Variable creada solo para el gráfico </span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>ENPG_filtrado <span class="ot">&lt;-</span> ENPG_filtrado <span class="sc">%&gt;%</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">genero_plot =</span> <span class="fu">case_when</span>(</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>      SEXO <span class="sc">==</span> <span class="dv">1</span> <span class="sc">~</span> <span class="st">"Masculino"</span>,</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>      SEXO <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">6</span>, <span class="dv">99</span>) <span class="sc">~</span> <span class="st">"Otro género"</span>,</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_character_</span></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">genero_plot =</span> <span class="fu">factor</span>(genero_plot),</span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">genero_plot =</span> <span class="fu">relevel</span>(genero_plot, <span class="at">ref =</span> <span class="st">"Otro género"</span>)</span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Datos para gráfico: 100% apilado dentro de cada barra</span></span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>df_genero <span class="ot">&lt;-</span> ENPG_filtrado <span class="sc">%&gt;%</span></span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(alcohol_30d_plot), <span class="sc">!</span><span class="fu">is.na</span>(genero_plot)) <span class="sc">%&gt;%</span></span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(alcohol_30d_plot, genero_plot, <span class="at">name =</span> <span class="st">"Conteo"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">complete</span>(alcohol_30d_plot, genero_plot, <span class="at">fill =</span> <span class="fu">list</span>(<span class="at">Conteo =</span> <span class="dv">0</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(alcohol_30d_plot) <span class="sc">%&gt;%</span></span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">Total =</span> <span class="fu">sum</span>(Conteo),</span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">Prop  =</span> <span class="fu">ifelse</span>(Total <span class="sc">==</span> <span class="dv">0</span>, <span class="dv">0</span>, Conteo <span class="sc">/</span> Total),</span>
<span id="cb14-24"><a href="#cb14-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">label_pct =</span> <span class="fu">ifelse</span>(Conteo <span class="sc">==</span> <span class="dv">0</span>, <span class="st">""</span>, <span class="fu">percent</span>(Prop, <span class="at">accuracy =</span> <span class="fl">0.1</span>)),</span>
<span id="cb14-25"><a href="#cb14-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">text =</span> <span class="fu">paste0</span>(</span>
<span id="cb14-26"><a href="#cb14-26" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Consumo: "</span>, alcohol_30d_plot,</span>
<span id="cb14-27"><a href="#cb14-27" aria-hidden="true" tabindex="-1"></a>      <span class="st">"&lt;br&gt;Género: "</span>, genero_plot,</span>
<span id="cb14-28"><a href="#cb14-28" aria-hidden="true" tabindex="-1"></a>      <span class="st">"&lt;br&gt;Porcentaje: "</span>, <span class="fu">percent</span>(Prop, <span class="at">accuracy =</span> <span class="fl">0.1</span>),</span>
<span id="cb14-29"><a href="#cb14-29" aria-hidden="true" tabindex="-1"></a>      <span class="st">"&lt;br&gt;n: "</span>, Conteo</span>
<span id="cb14-30"><a href="#cb14-30" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb14-31"><a href="#cb14-31" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb14-32"><a href="#cb14-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb14-33"><a href="#cb14-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-34"><a href="#cb14-34" aria-hidden="true" tabindex="-1"></a><span class="co"># Chequeo</span></span>
<span id="cb14-35"><a href="#cb14-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-36"><a href="#cb14-36" aria-hidden="true" tabindex="-1"></a>df_genero <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(alcohol_30d_plot) <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="at">suma_prop =</span> <span class="fu">sum</span>(Prop))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 2
  alcohol_30d_plot   suma_prop
  &lt;fct&gt;                  &lt;dbl&gt;
1 No consume alcohol         1
2 Sí consume alcohol         1</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Gráfico: siempre suma 100%</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>Grafico_genero <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df_genero, <span class="fu">aes</span>(<span class="at">y =</span> alcohol_30d_plot, <span class="at">x =</span> Conteo, <span class="at">fill =</span> genero_plot, <span class="at">text =</span> text)) <span class="sc">+</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">position =</span> <span class="st">"fill"</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">width =</span> <span class="fl">0.65</span>) <span class="sc">+</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">label =</span> label_pct),</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">position =</span> <span class="fu">position_fill</span>(<span class="at">vjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"white"</span>,</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">3</span></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">labels =</span> <span class="fu">percent_format</span>(<span class="at">accuracy =</span> <span class="dv">1</span>), <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Género según consumo de alcohol (últimos 30 días)"</span>,</span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Porcentaje"</span>,</span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="cn">NULL</span>,</span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"Género"</span></span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>))</span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplotly</span>(Grafico_genero, <span class="at">tooltip =</span> <span class="st">"text"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-88fdd2a34d502a66744b" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-88fdd2a34d502a66744b">{"x":{"data":[{"orientation":"v","width":[0.64862992610837433,0.47984818362551962],"base":[0.67500000000000004,1.675],"x":[0.67568503694581283,0.76007590818724013],"y":[0.64999999999999991,0.65000000000000013],"text":["Consumo: No consume alcohol<br>Género: Otro género<br>Porcentaje: 64.9%<br>n: 8427","Consumo: Sí consume alcohol<br>Género: Otro género<br>Porcentaje: 48.0%<br>n: 2655"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(248,118,109,1)","line":{"width":1.8897637795275593,"color":"rgba(0,0,0,1)"}},"name":"Otro género","legendgroup":"Otro género","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.35137007389162561,0.52015181637448038],"base":[0.67500000000000004,1.675],"x":[0.17568503694581281,0.26007590818724019],"y":[0.64999999999999991,0.65000000000000013],"text":["Consumo: No consume alcohol<br>Género: Masculino<br>Porcentaje: 35.1%<br>n: 4565","Consumo: Sí consume alcohol<br>Género: Masculino<br>Porcentaje: 52.0%<br>n: 2878"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(0,191,196,1)","line":{"width":1.8897637795275593,"color":"rgba(0,0,0,1)"}},"name":"Masculino","legendgroup":"Masculino","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0.67568503694581283,0.76007590818724013],"y":[1,2],"text":["64.9%","48.0%"],"hovertext":["Consumo: No consume alcohol<br>Género: Otro género<br>Porcentaje: 64.9%<br>n: 8427","Consumo: Sí consume alcohol<br>Género: Otro género<br>Porcentaje: 48.0%<br>n: 2655"],"textfont":{"size":11.338582677165356,"color":"rgba(255,255,255,1)"},"type":"scatter","mode":"text","hoveron":"points","name":"Otro género","legendgroup":"Otro género","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0.17568503694581281,0.26007590818724019],"y":[1,2],"text":["35.1%","52.0%"],"hovertext":["Consumo: No consume alcohol<br>Género: Masculino<br>Porcentaje: 35.1%<br>n: 4565","Consumo: Sí consume alcohol<br>Género: Masculino<br>Porcentaje: 52.0%<br>n: 2878"],"textfont":{"size":11.338582677165356,"color":"rgba(255,255,255,1)"},"type":"scatter","mode":"text","hoveron":"points","name":"Masculino","legendgroup":"Masculino","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":40.840182648401829,"r":7.3059360730593621,"b":37.260273972602747,"l":116.16438356164386},"paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"title":{"text":"Género según consumo de alcohol (últimos 30 días)","font":{"color":"rgba(0,0,0,1)","family":"","size":17.534246575342465},"x":0.5,"xref":"paper"},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[0,1],"tickmode":"array","ticktext":["0%","25%","50%","75%","100%"],"tickvals":[0,0.25,0.5,0.75,1],"categoryorder":"array","categoryarray":["0%","25%","50%","75%","100%"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0,"zeroline":false,"anchor":"y","title":{"text":"Porcentaje","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[0.40000000000000002,2.6000000000000001],"tickmode":"array","ticktext":["No consume alcohol","Sí consume alcohol"],"tickvals":[1,2],"categoryorder":"array","categoryarray":["No consume alcohol","Sí consume alcohol"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0,"zeroline":false,"anchor":"x","title":{"text":"","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","layer":"below","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":true,"legend":{"bgcolor":null,"bordercolor":null,"borderwidth":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.68949771689498},"title":{"text":"Género","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"5cec71f31437":{"x":{},"y":{},"fill":{},"text":{},"type":"bar"},"5cec5c0f34e":{"x":{},"y":{},"fill":{},"text":{},"label":{}}},"cur_data":"5cec71f31437","visdat":{"5cec71f31437":["function (y) ","x"],"5cec5c0f34e":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>En el grupo de personas que no consume alcohol en los últimos 30 días, el 64,9% se identifica como otro género, mientras que el 35,1% corresponde a masculino.</p>
<p>En cambio, entre quienes sí consumen alcohol, el 52,0% corresponde a masculino y el 48,0% a otro género. En comparación, se observa que en el grupo que consume alcohol hay una mayor proporción de personas masculinas, mientras que en el grupo que no consume alcohol predomina otro género.</p>
<p><strong>Distribución de escolaridad media según consumo de alcohol</strong></p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Variable</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>ENPG_filtrado <span class="ot">&lt;-</span> ENPG_filtrado <span class="sc">%&gt;%</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">educacion_med_plot =</span> <span class="fu">case_when</span>(</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>      DP_12 <span class="sc">%in%</span> <span class="dv">5</span><span class="sc">:</span><span class="dv">13</span>       <span class="sc">~</span> <span class="st">"Tiene educación media o superior"</span>,</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>      DP_12 <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, <span class="dv">88</span>) <span class="sc">~</span> <span class="st">"No tiene educación media o superior"</span>,</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span>                 <span class="sc">~</span> <span class="cn">NA_character_</span></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">educacion_med_plot =</span> <span class="fu">factor</span>(</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>      educacion_med_plot,</span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>      <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Tiene educación media o superior"</span>, <span class="st">"No tiene educación media o superior"</span>)</span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Datos para gráfico: 100% apilado dentro de cada barra</span></span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a>df_educacion_med <span class="ot">&lt;-</span> ENPG_filtrado <span class="sc">%&gt;%</span></span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(alcohol_30d_plot), <span class="sc">!</span><span class="fu">is.na</span>(educacion_med_plot)) <span class="sc">%&gt;%</span></span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(alcohol_30d_plot, educacion_med_plot, <span class="at">name =</span> <span class="st">"Conteo"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">complete</span>(alcohol_30d_plot, educacion_med_plot, <span class="at">fill =</span> <span class="fu">list</span>(<span class="at">Conteo =</span> <span class="dv">0</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb17-22"><a href="#cb17-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(alcohol_30d_plot) <span class="sc">%&gt;%</span></span>
<span id="cb17-23"><a href="#cb17-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb17-24"><a href="#cb17-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">Total =</span> <span class="fu">sum</span>(Conteo),</span>
<span id="cb17-25"><a href="#cb17-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">Prop  =</span> <span class="fu">ifelse</span>(Total <span class="sc">==</span> <span class="dv">0</span>, <span class="dv">0</span>, Conteo <span class="sc">/</span> Total),</span>
<span id="cb17-26"><a href="#cb17-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">label_pct =</span> <span class="fu">ifelse</span>(Conteo <span class="sc">==</span> <span class="dv">0</span>, <span class="st">""</span>, <span class="fu">percent</span>(Prop, <span class="at">accuracy =</span> <span class="fl">0.1</span>)),</span>
<span id="cb17-27"><a href="#cb17-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">text =</span> <span class="fu">paste0</span>(</span>
<span id="cb17-28"><a href="#cb17-28" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Consumo: "</span>, alcohol_30d_plot,</span>
<span id="cb17-29"><a href="#cb17-29" aria-hidden="true" tabindex="-1"></a>      <span class="st">"&lt;br&gt;Educación: "</span>, educacion_med_plot,</span>
<span id="cb17-30"><a href="#cb17-30" aria-hidden="true" tabindex="-1"></a>      <span class="st">"&lt;br&gt;Porcentaje: "</span>, <span class="fu">percent</span>(Prop, <span class="at">accuracy =</span> <span class="fl">0.1</span>),</span>
<span id="cb17-31"><a href="#cb17-31" aria-hidden="true" tabindex="-1"></a>      <span class="st">"&lt;br&gt;n: "</span>, Conteo</span>
<span id="cb17-32"><a href="#cb17-32" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb17-33"><a href="#cb17-33" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb17-34"><a href="#cb17-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb17-35"><a href="#cb17-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-36"><a href="#cb17-36" aria-hidden="true" tabindex="-1"></a><span class="co"># Chequeo</span></span>
<span id="cb17-37"><a href="#cb17-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-38"><a href="#cb17-38" aria-hidden="true" tabindex="-1"></a>df_educacion_med <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(alcohol_30d_plot) <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="at">suma_prop =</span> <span class="fu">sum</span>(Prop))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 2
  alcohol_30d_plot   suma_prop
  &lt;fct&gt;                  &lt;dbl&gt;
1 No consume alcohol         1
2 Sí consume alcohol         1</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Gráfico: siempre suma 100%</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>Grafico_educacion_med <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df_educacion_med, <span class="fu">aes</span>(<span class="at">y =</span> alcohol_30d_plot, <span class="at">x =</span> Conteo, <span class="at">fill =</span> educacion_med_plot, <span class="at">text =</span> text)) <span class="sc">+</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">position =</span> <span class="st">"fill"</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">width =</span> <span class="fl">0.65</span>) <span class="sc">+</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">label =</span> label_pct),</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">position =</span> <span class="fu">position_fill</span>(<span class="at">vjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"white"</span>,</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">3</span></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">labels =</span> <span class="fu">percent_format</span>(<span class="at">accuracy =</span> <span class="dv">1</span>), <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Educación media o superior según consumo de alcohol (últimos 30 días)"</span>,</span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Porcentaje"</span>,</span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="cn">NULL</span>,</span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"Educación"</span></span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>))</span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-21"><a href="#cb19-21" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplotly</span>(Grafico_educacion_med, <span class="at">tooltip =</span> <span class="st">"text"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-8e1fe96c0688a849169a" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-8e1fe96c0688a849169a">{"x":{"data":[{"orientation":"v","width":[0.82088977832512322,0.90854870775347907],"base":[0.67500000000000004,1.675],"x":[0.58955511083743839,0.54572564612326047],"y":[0.64999999999999991,0.65000000000000013],"text":["Consumo: No consume alcohol<br>Educación: Tiene educación media o superior<br>Porcentaje: 82.1%<br>n: 10665","Consumo: Sí consume alcohol<br>Educación: Tiene educación media o superior<br>Porcentaje: 90.9%<br>n: 5027"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(248,118,109,1)","line":{"width":1.8897637795275593,"color":"rgba(0,0,0,1)"}},"name":"Tiene educación media o superior","legendgroup":"Tiene educación media o superior","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.17911022167487683,0.091451292246520877],"base":[0.67500000000000004,1.675],"x":[0.089555110837438417,0.045725646123260438],"y":[0.64999999999999991,0.65000000000000013],"text":["Consumo: No consume alcohol<br>Educación: No tiene educación media o superior<br>Porcentaje: 17.9%<br>n: 2327","Consumo: Sí consume alcohol<br>Educación: No tiene educación media o superior<br>Porcentaje: 9.1%<br>n: 506"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(0,191,196,1)","line":{"width":1.8897637795275593,"color":"rgba(0,0,0,1)"}},"name":"No tiene educación media o superior","legendgroup":"No tiene educación media o superior","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0.58955511083743839,0.54572564612326047],"y":[1,2],"text":["82.1%","90.9%"],"hovertext":["Consumo: No consume alcohol<br>Educación: Tiene educación media o superior<br>Porcentaje: 82.1%<br>n: 10665","Consumo: Sí consume alcohol<br>Educación: Tiene educación media o superior<br>Porcentaje: 90.9%<br>n: 5027"],"textfont":{"size":11.338582677165356,"color":"rgba(255,255,255,1)"},"type":"scatter","mode":"text","hoveron":"points","name":"Tiene educación media o superior","legendgroup":"Tiene educación media o superior","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0.089555110837438417,0.045725646123260438],"y":[1,2],"text":["17.9%","9.1%"],"hovertext":["Consumo: No consume alcohol<br>Educación: No tiene educación media o superior<br>Porcentaje: 17.9%<br>n: 2327","Consumo: Sí consume alcohol<br>Educación: No tiene educación media o superior<br>Porcentaje: 9.1%<br>n: 506"],"textfont":{"size":11.338582677165356,"color":"rgba(255,255,255,1)"},"type":"scatter","mode":"text","hoveron":"points","name":"No tiene educación media o superior","legendgroup":"No tiene educación media o superior","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":40.840182648401829,"r":7.3059360730593621,"b":37.260273972602747,"l":116.16438356164386},"paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"title":{"text":"Educación media o superior según consumo de alcohol (últimos 30 días)","font":{"color":"rgba(0,0,0,1)","family":"","size":17.534246575342465},"x":0.5,"xref":"paper"},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[0,1],"tickmode":"array","ticktext":["0%","25%","50%","75%","100%"],"tickvals":[0,0.25,0.5,0.75,1],"categoryorder":"array","categoryarray":["0%","25%","50%","75%","100%"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0,"zeroline":false,"anchor":"y","title":{"text":"Porcentaje","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[0.40000000000000002,2.6000000000000001],"tickmode":"array","ticktext":["No consume alcohol","Sí consume alcohol"],"tickvals":[1,2],"categoryorder":"array","categoryarray":["No consume alcohol","Sí consume alcohol"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0,"zeroline":false,"anchor":"x","title":{"text":"","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","layer":"below","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":true,"legend":{"bgcolor":null,"bordercolor":null,"borderwidth":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.68949771689498},"title":{"text":"Educación","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"5cec27788c9":{"x":{},"y":{},"fill":{},"text":{},"type":"bar"},"5cec1a5a6248":{"x":{},"y":{},"fill":{},"text":{},"label":{}}},"cur_data":"5cec27788c9","visdat":{"5cec27788c9":["function (y) ","x"],"5cec1a5a6248":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>En el grupo de personas que no consume alcohol en los últimos 30 días, el 82,1% tiene educación media o superior, mientras que el 17,9% no la tiene.</p>
<p>Por su parte, entre quienes sí consumen alcohol, el 90,9% presenta educación media o superior y el 9,1% no. En comparación, se observa que en el grupo que consume alcohol hay una mayor proporción de personas con educación media o superior y una menor proporción de quienes no la tienen.</p>
<p><strong>Trabajo según consumo de alcohol</strong></p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Variable creada sólo para el gráfico </span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>ENPG_filtrado <span class="ot">&lt;-</span> ENPG_filtrado <span class="sc">%&gt;%</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">trabaja_o_no_plot =</span> <span class="fu">case_when</span>(</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>      trabaja_o_no <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="st">"1"</span>) <span class="sc">~</span> <span class="st">"Sí trabaja"</span>,</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>      trabaja_o_no <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="st">"2"</span>) <span class="sc">~</span> <span class="st">"No trabaja"</span>,</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_character_</span></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">trabaja_o_no_plot =</span> <span class="fu">factor</span>(trabaja_o_no_plot, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Sí trabaja"</span>, <span class="st">"No trabaja"</span>))</span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Datos para gráfico: 100% apilado dentro de cada barra</span></span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a>df_trabaja <span class="ot">&lt;-</span> ENPG_filtrado <span class="sc">%&gt;%</span></span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(alcohol_30d_plot), <span class="sc">!</span><span class="fu">is.na</span>(trabaja_o_no_plot)) <span class="sc">%&gt;%</span></span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(alcohol_30d_plot, trabaja_o_no_plot, <span class="at">name =</span> <span class="st">"Conteo"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">complete</span>(alcohol_30d_plot, trabaja_o_no_plot, <span class="at">fill =</span> <span class="fu">list</span>(<span class="at">Conteo =</span> <span class="dv">0</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(alcohol_30d_plot) <span class="sc">%&gt;%</span></span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb20-21"><a href="#cb20-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">Total =</span> <span class="fu">sum</span>(Conteo),</span>
<span id="cb20-22"><a href="#cb20-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">Prop  =</span> <span class="fu">ifelse</span>(Total <span class="sc">==</span> <span class="dv">0</span>, <span class="dv">0</span>, Conteo <span class="sc">/</span> Total),</span>
<span id="cb20-23"><a href="#cb20-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">label_pct =</span> <span class="fu">ifelse</span>(Conteo <span class="sc">==</span> <span class="dv">0</span>, <span class="st">""</span>, <span class="fu">percent</span>(Prop, <span class="at">accuracy =</span> <span class="fl">0.1</span>)),</span>
<span id="cb20-24"><a href="#cb20-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">text =</span> <span class="fu">paste0</span>(</span>
<span id="cb20-25"><a href="#cb20-25" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Consumo: "</span>, alcohol_30d_plot,</span>
<span id="cb20-26"><a href="#cb20-26" aria-hidden="true" tabindex="-1"></a>      <span class="st">"&lt;br&gt;Trabaja: "</span>, trabaja_o_no_plot,</span>
<span id="cb20-27"><a href="#cb20-27" aria-hidden="true" tabindex="-1"></a>      <span class="st">"&lt;br&gt;Porcentaje: "</span>, <span class="fu">percent</span>(Prop, <span class="at">accuracy =</span> <span class="fl">0.1</span>),</span>
<span id="cb20-28"><a href="#cb20-28" aria-hidden="true" tabindex="-1"></a>      <span class="st">"&lt;br&gt;n: "</span>, Conteo</span>
<span id="cb20-29"><a href="#cb20-29" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb20-30"><a href="#cb20-30" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb20-31"><a href="#cb20-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb20-32"><a href="#cb20-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-33"><a href="#cb20-33" aria-hidden="true" tabindex="-1"></a><span class="co"># Chequeo</span></span>
<span id="cb20-34"><a href="#cb20-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-35"><a href="#cb20-35" aria-hidden="true" tabindex="-1"></a>df_trabaja <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(alcohol_30d_plot) <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="at">suma_prop =</span> <span class="fu">sum</span>(Prop))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 2
  alcohol_30d_plot   suma_prop
  &lt;fct&gt;                  &lt;dbl&gt;
1 No consume alcohol         1
2 Sí consume alcohol         1</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Gráfico: siempre suma 100%</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>Grafico_trabaja <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df_trabaja, <span class="fu">aes</span>(<span class="at">y =</span> alcohol_30d_plot, <span class="at">x =</span> Conteo, <span class="at">fill =</span> trabaja_o_no_plot, <span class="at">text =</span> text)) <span class="sc">+</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">position =</span> <span class="st">"fill"</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">width =</span> <span class="fl">0.65</span>) <span class="sc">+</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">label =</span> label_pct),</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">position =</span> <span class="fu">position_fill</span>(<span class="at">vjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"white"</span>,</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">3</span></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">labels =</span> <span class="fu">percent_format</span>(<span class="at">accuracy =</span> <span class="dv">1</span>), <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Trabajo según consumo de alcohol (últimos 30 días)"</span>,</span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Porcentaje"</span>,</span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="cn">NULL</span>,</span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"Trabajo"</span></span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>))</span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-21"><a href="#cb22-21" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplotly</span>(Grafico_trabaja, <span class="at">tooltip =</span> <span class="st">"text"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-bb3486349adfa5d821dc" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-bb3486349adfa5d821dc">{"x":{"data":[{"orientation":"v","width":[0.62084359605911332,0.76088921019338518],"base":[0.67500000000000004,1.675],"x":[0.68957820197044328,0.61955539490330747],"y":[0.64999999999999991,0.65000000000000013],"text":["Consumo: No consume alcohol<br>Trabaja: Sí trabaja<br>Porcentaje: 62.1%<br>n: 8066","Consumo: Sí consume alcohol<br>Trabaja: Sí trabaja<br>Porcentaje: 76.1%<br>n: 4210"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(248,118,109,1)","line":{"width":1.8897637795275593,"color":"rgba(0,0,0,1)"}},"name":"Sí trabaja","legendgroup":"Sí trabaja","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.37915640394088668,0.23911078980661485],"base":[0.67500000000000004,1.675],"x":[0.18957820197044334,0.11955539490330742],"y":[0.64999999999999991,0.65000000000000013],"text":["Consumo: No consume alcohol<br>Trabaja: No trabaja<br>Porcentaje: 37.9%<br>n: 4926","Consumo: Sí consume alcohol<br>Trabaja: No trabaja<br>Porcentaje: 23.9%<br>n: 1323"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(0,191,196,1)","line":{"width":1.8897637795275593,"color":"rgba(0,0,0,1)"}},"name":"No trabaja","legendgroup":"No trabaja","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0.68957820197044328,0.61955539490330747],"y":[1,2],"text":["62.1%","76.1%"],"hovertext":["Consumo: No consume alcohol<br>Trabaja: Sí trabaja<br>Porcentaje: 62.1%<br>n: 8066","Consumo: Sí consume alcohol<br>Trabaja: Sí trabaja<br>Porcentaje: 76.1%<br>n: 4210"],"textfont":{"size":11.338582677165356,"color":"rgba(255,255,255,1)"},"type":"scatter","mode":"text","hoveron":"points","name":"Sí trabaja","legendgroup":"Sí trabaja","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0.18957820197044334,0.11955539490330742],"y":[1,2],"text":["37.9%","23.9%"],"hovertext":["Consumo: No consume alcohol<br>Trabaja: No trabaja<br>Porcentaje: 37.9%<br>n: 4926","Consumo: Sí consume alcohol<br>Trabaja: No trabaja<br>Porcentaje: 23.9%<br>n: 1323"],"textfont":{"size":11.338582677165356,"color":"rgba(255,255,255,1)"},"type":"scatter","mode":"text","hoveron":"points","name":"No trabaja","legendgroup":"No trabaja","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":40.840182648401829,"r":7.3059360730593621,"b":37.260273972602747,"l":116.16438356164386},"paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"title":{"text":"Trabajo según consumo de alcohol (últimos 30 días)","font":{"color":"rgba(0,0,0,1)","family":"","size":17.534246575342465},"x":0.5,"xref":"paper"},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[0,1],"tickmode":"array","ticktext":["0%","25%","50%","75%","100%"],"tickvals":[0,0.25,0.5,0.75,1],"categoryorder":"array","categoryarray":["0%","25%","50%","75%","100%"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0,"zeroline":false,"anchor":"y","title":{"text":"Porcentaje","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[0.40000000000000002,2.6000000000000001],"tickmode":"array","ticktext":["No consume alcohol","Sí consume alcohol"],"tickvals":[1,2],"categoryorder":"array","categoryarray":["No consume alcohol","Sí consume alcohol"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0,"zeroline":false,"anchor":"x","title":{"text":"","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","layer":"below","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":true,"legend":{"bgcolor":null,"bordercolor":null,"borderwidth":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.68949771689498},"title":{"text":"Trabajo","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"5cec729a7cba":{"x":{},"y":{},"fill":{},"text":{},"type":"bar"},"5cecedd229b":{"x":{},"y":{},"fill":{},"text":{},"label":{}}},"cur_data":"5cec729a7cba","visdat":{"5cec729a7cba":["function (y) ","x"],"5cecedd229b":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>En el grupo de personas que no consume alcohol en los últimos 30 días, el 62,1% declara que sí trabaja, mientras que el 37,9% no trabaja.</p>
<p>En cambio, entre quienes sí consumen alcohol, el 76,1% señala que sí trabaja y el 23,9% no trabaja. En comparación, se observa que en el grupo que consume alcohol hay una mayor proporción de personas que trabajan y una menor proporción de quienes no trabajan.</p>
<p><strong>Cargo en el trabajo según consumo de alcohol</strong></p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Variable creada solo para el gráfico</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>ENPG_filtrado <span class="ot">&lt;-</span> ENPG_filtrado <span class="sc">%&gt;%</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">cargo_trabajo_plot =</span> <span class="fu">case_when</span>(</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>      cargo_trabajo <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="st">"1"</span>) <span class="sc">~</span> <span class="st">"Patrón o empleador/a"</span>,</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>      cargo_trabajo <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="st">"2"</span>) <span class="sc">~</span> <span class="st">"Trabajador/a por cuenta propia"</span>,</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>      cargo_trabajo <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="st">"3"</span>) <span class="sc">~</span> <span class="st">"Empleado/a u obrero/a sector público"</span>,</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>      cargo_trabajo <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="st">"4"</span>) <span class="sc">~</span> <span class="st">"Empleado/a u obrero/a empresas públicas"</span>,</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>      cargo_trabajo <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="st">"5"</span>) <span class="sc">~</span> <span class="st">"Empleado/a u obrero/a sector privado"</span>,</span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>      cargo_trabajo <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">6</span>, <span class="st">"6"</span>) <span class="sc">~</span> <span class="st">"Servicio doméstico puertas adentro"</span>,</span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>      cargo_trabajo <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">7</span>, <span class="st">"7"</span>) <span class="sc">~</span> <span class="st">"Servicio doméstico puertas afuera"</span>,</span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>      cargo_trabajo <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">8</span>, <span class="st">"8"</span>) <span class="sc">~</span> <span class="st">"F.F.A.A. y del Orden"</span>,</span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>      cargo_trabajo <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">9</span>, <span class="st">"9"</span>) <span class="sc">~</span> <span class="st">"Familiar no remunerado"</span>,</span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_character_</span></span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">cargo_trabajo_plot =</span> <span class="fu">factor</span>(</span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a>      cargo_trabajo_plot,</span>
<span id="cb23-18"><a href="#cb23-18" aria-hidden="true" tabindex="-1"></a>      <span class="at">levels =</span> <span class="fu">c</span>(</span>
<span id="cb23-19"><a href="#cb23-19" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Patrón o empleador/a"</span>,</span>
<span id="cb23-20"><a href="#cb23-20" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Trabajador/a por cuenta propia"</span>,</span>
<span id="cb23-21"><a href="#cb23-21" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Empleado/a u obrero/a sector público"</span>,</span>
<span id="cb23-22"><a href="#cb23-22" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Empleado/a u obrero/a empresas públicas"</span>,</span>
<span id="cb23-23"><a href="#cb23-23" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Empleado/a u obrero/a sector privado"</span>,</span>
<span id="cb23-24"><a href="#cb23-24" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Servicio doméstico puertas adentro"</span>,</span>
<span id="cb23-25"><a href="#cb23-25" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Servicio doméstico puertas afuera"</span>,</span>
<span id="cb23-26"><a href="#cb23-26" aria-hidden="true" tabindex="-1"></a>        <span class="st">"F.F.A.A. y del Orden"</span>,</span>
<span id="cb23-27"><a href="#cb23-27" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Familiar no remunerado"</span></span>
<span id="cb23-28"><a href="#cb23-28" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb23-29"><a href="#cb23-29" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb23-30"><a href="#cb23-30" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb23-31"><a href="#cb23-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-32"><a href="#cb23-32" aria-hidden="true" tabindex="-1"></a><span class="co"># 3) Datos para gráfico: 100% apilado dentro de cada barra</span></span>
<span id="cb23-33"><a href="#cb23-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-34"><a href="#cb23-34" aria-hidden="true" tabindex="-1"></a>df_cargo_trabajo <span class="ot">&lt;-</span> ENPG_filtrado <span class="sc">%&gt;%</span></span>
<span id="cb23-35"><a href="#cb23-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(alcohol_30d_plot), <span class="sc">!</span><span class="fu">is.na</span>(cargo_trabajo_plot)) <span class="sc">%&gt;%</span></span>
<span id="cb23-36"><a href="#cb23-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(alcohol_30d_plot, cargo_trabajo_plot, <span class="at">name =</span> <span class="st">"Conteo"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb23-37"><a href="#cb23-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">complete</span>(alcohol_30d_plot, cargo_trabajo_plot, <span class="at">fill =</span> <span class="fu">list</span>(<span class="at">Conteo =</span> <span class="dv">0</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb23-38"><a href="#cb23-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(alcohol_30d_plot) <span class="sc">%&gt;%</span></span>
<span id="cb23-39"><a href="#cb23-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb23-40"><a href="#cb23-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">Total =</span> <span class="fu">sum</span>(Conteo),</span>
<span id="cb23-41"><a href="#cb23-41" aria-hidden="true" tabindex="-1"></a>    <span class="at">Prop  =</span> <span class="fu">ifelse</span>(Total <span class="sc">==</span> <span class="dv">0</span>, <span class="dv">0</span>, Conteo <span class="sc">/</span> Total),</span>
<span id="cb23-42"><a href="#cb23-42" aria-hidden="true" tabindex="-1"></a>    <span class="at">label_pct =</span> <span class="fu">ifelse</span>(Conteo <span class="sc">==</span> <span class="dv">0</span>, <span class="st">""</span>, <span class="fu">percent</span>(Prop, <span class="at">accuracy =</span> <span class="fl">0.1</span>)),</span>
<span id="cb23-43"><a href="#cb23-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">text =</span> <span class="fu">paste0</span>(</span>
<span id="cb23-44"><a href="#cb23-44" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Consumo: "</span>, alcohol_30d_plot,</span>
<span id="cb23-45"><a href="#cb23-45" aria-hidden="true" tabindex="-1"></a>      <span class="st">"&lt;br&gt;Cargo: "</span>, cargo_trabajo_plot,</span>
<span id="cb23-46"><a href="#cb23-46" aria-hidden="true" tabindex="-1"></a>      <span class="st">"&lt;br&gt;Porcentaje: "</span>, <span class="fu">percent</span>(Prop, <span class="at">accuracy =</span> <span class="fl">0.1</span>),</span>
<span id="cb23-47"><a href="#cb23-47" aria-hidden="true" tabindex="-1"></a>      <span class="st">"&lt;br&gt;n: "</span>, Conteo</span>
<span id="cb23-48"><a href="#cb23-48" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb23-49"><a href="#cb23-49" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb23-50"><a href="#cb23-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb23-51"><a href="#cb23-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-52"><a href="#cb23-52" aria-hidden="true" tabindex="-1"></a><span class="co"># Chequeo</span></span>
<span id="cb23-53"><a href="#cb23-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-54"><a href="#cb23-54" aria-hidden="true" tabindex="-1"></a>df_cargo_trabajo <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(alcohol_30d_plot) <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="at">suma_prop =</span> <span class="fu">sum</span>(Prop))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 2
  alcohol_30d_plot   suma_prop
  &lt;fct&gt;                  &lt;dbl&gt;
1 No consume alcohol         1
2 Sí consume alcohol         1</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Gráfico: siempre suma 100%</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>Grafico_cargo_trabajo <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df_cargo_trabajo, <span class="fu">aes</span>(<span class="at">y =</span> alcohol_30d_plot, <span class="at">x =</span> Conteo, <span class="at">fill =</span> cargo_trabajo_plot, <span class="at">text =</span> text)) <span class="sc">+</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">position =</span> <span class="st">"fill"</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">width =</span> <span class="fl">0.65</span>) <span class="sc">+</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">label =</span> label_pct),</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">position =</span> <span class="fu">position_fill</span>(<span class="at">vjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"white"</span>,</span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">3</span></span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">labels =</span> <span class="fu">percent_format</span>(<span class="at">accuracy =</span> <span class="dv">1</span>), <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Cargo en el trabajo según consumo de alcohol (últimos 30 días)"</span>,</span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Porcentaje"</span>,</span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="cn">NULL</span>,</span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"Cargo en el trabajo"</span></span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb25-18"><a href="#cb25-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb25-19"><a href="#cb25-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb25-20"><a href="#cb25-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb25-21"><a href="#cb25-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"right"</span></span>
<span id="cb25-22"><a href="#cb25-22" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb25-23"><a href="#cb25-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-24"><a href="#cb25-24" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplotly</span>(Grafico_cargo_trabajo, <span class="at">tooltip =</span> <span class="st">"text"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-44474b3e8cd160f85a98" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-44474b3e8cd160f85a98">{"x":{"data":[{"orientation":"v","width":[0.041281851563369276,0.036402569593147804],"base":[0.67500000000000004,1.675],"x":[0.97935907421831536,0.9817987152034261],"y":[0.64999999999999991,0.65000000000000013],"text":["Consumo: No consume alcohol<br>Cargo: Patrón o empleador/a<br>Porcentaje: 4.1%<br>n: 371","Consumo: Sí consume alcohol<br>Cargo: Patrón o empleador/a<br>Porcentaje: 3.6%<br>n: 170"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(248,118,109,1)","line":{"width":1.8897637795275593,"color":"rgba(0,0,0,1)"}},"name":"Patrón o empleador/a","legendgroup":"Patrón o empleador/a","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.31723600756648496,0.26916488222698065],"base":[0.67500000000000004,1.675],"x":[0.80010014465338819,0.82901498929336181],"y":[0.64999999999999991,0.65000000000000013],"text":["Consumo: No consume alcohol<br>Cargo: Trabajador/a por cuenta propia<br>Porcentaje: 31.7%<br>n: 2851","Consumo: Sí consume alcohol<br>Cargo: Trabajador/a por cuenta propia<br>Porcentaje: 26.9%<br>n: 1257"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(211,146,0,1)","line":{"width":1.8897637795275593,"color":"rgba(0,0,0,1)"}},"name":"Trabajador/a por cuenta propia","legendgroup":"Trabajador/a por cuenta propia","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.096472682763992457,0.095503211991434744],"base":[0.67500000000000004,1.675],"x":[0.59324579948814948,0.64668094218415417],"y":[0.64999999999999991,0.65000000000000013],"text":["Consumo: No consume alcohol<br>Cargo: Empleado/a u obrero/a sector público<br>Porcentaje: 9.6%<br>n: 867","Consumo: Sí consume alcohol<br>Cargo: Empleado/a u obrero/a sector público<br>Porcentaje: 9.6%<br>n: 446"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(147,170,0,1)","line":{"width":1.8897637795275593,"color":"rgba(0,0,0,1)"}},"name":"Empleado/a u obrero/a sector público","legendgroup":"Empleado/a u obrero/a sector público","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.09402470234783572,0.091220556745182035],"base":[0.67500000000000004,1.675],"x":[0.49799710693223542,0.55331905781584578],"y":[0.64999999999999991,0.65000000000000013],"text":["Consumo: No consume alcohol<br>Cargo: Empleado/a u obrero/a empresas públicas<br>Porcentaje: 9.4%<br>n: 845","Consumo: Sí consume alcohol<br>Cargo: Empleado/a u obrero/a empresas públicas<br>Porcentaje: 9.1%<br>n: 426"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(0,186,56,1)","line":{"width":1.8897637795275593,"color":"rgba(0,0,0,1)"}},"name":"Empleado/a u obrero/a empresas públicas","legendgroup":"Empleado/a u obrero/a empresas públicas","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.37231556693001006,0.47280513918629546],"base":[0.67500000000000004,1.675],"x":[0.26482697229331259,0.27130620985010706],"y":[0.64999999999999991,0.65000000000000013],"text":["Consumo: No consume alcohol<br>Cargo: Empleado/a u obrero/a sector privado<br>Porcentaje: 37.2%<br>n: 3346","Consumo: Sí consume alcohol<br>Cargo: Empleado/a u obrero/a sector privado<br>Porcentaje: 47.3%<br>n: 2208"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(0,193,159,1)","line":{"width":1.8897637795275593,"color":"rgba(0,0,0,1)"}},"name":"Empleado/a u obrero/a sector privado","legendgroup":"Empleado/a u obrero/a sector privado","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.0071213975742739494,0.0029978586723768755],"base":[0.67500000000000004,1.675],"x":[0.075108490041170567,0.03340471092077088],"y":[0.64999999999999991,0.65000000000000013],"text":["Consumo: No consume alcohol<br>Cargo: Servicio doméstico puertas adentro<br>Porcentaje: 0.7%<br>n: 64","Consumo: Sí consume alcohol<br>Cargo: Servicio doméstico puertas adentro<br>Porcentaje: 0.3%<br>n: 14"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(0,185,227,1)","line":{"width":1.8897637795275593,"color":"rgba(0,0,0,1)"}},"name":"Servicio doméstico puertas adentro","legendgroup":"Servicio doméstico puertas adentro","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.027929231111605647,0.010278372591006422],"base":[0.67500000000000004,1.675],"x":[0.057583175698230779,0.02676659528907923],"y":[0.64999999999999991,0.65000000000000013],"text":["Consumo: No consume alcohol<br>Cargo: Servicio doméstico puertas afuera<br>Porcentaje: 2.8%<br>n: 251","Consumo: Sí consume alcohol<br>Cargo: Servicio doméstico puertas afuera<br>Porcentaje: 1.0%<br>n: 48"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(97,156,255,1)","line":{"width":1.8897637795275593,"color":"rgba(0,0,0,1)"}},"name":"Servicio doméstico puertas afuera","legendgroup":"Servicio doméstico puertas afuera","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.0027817959274507656,0.0034261241970021429],"base":[0.67500000000000004,1.675],"x":[0.042227662178702566,0.019914346895074944],"y":[0.64999999999999991,0.65000000000000013],"text":["Consumo: No consume alcohol<br>Cargo: F.F.A.A. y del Orden<br>Porcentaje: 0.3%<br>n: 25","Consumo: Sí consume alcohol<br>Cargo: F.F.A.A. y del Orden<br>Porcentaje: 0.3%<br>n: 16"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(219,114,251,1)","line":{"width":1.8897637795275593,"color":"rgba(0,0,0,1)"}},"name":"F.F.A.A. y del Orden","legendgroup":"F.F.A.A. y del Orden","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.040836764214977186,0.018201284796573874],"base":[0.67500000000000004,1.675],"x":[0.020418382107488593,0.0091006423982869372],"y":[0.64999999999999991,0.65000000000000013],"text":["Consumo: No consume alcohol<br>Cargo: Familiar no remunerado<br>Porcentaje: 4.1%<br>n: 367","Consumo: Sí consume alcohol<br>Cargo: Familiar no remunerado<br>Porcentaje: 1.8%<br>n: 85"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(255,97,195,1)","line":{"width":1.8897637795275593,"color":"rgba(0,0,0,1)"}},"name":"Familiar no remunerado","legendgroup":"Familiar no remunerado","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0.97935907421831536,0.9817987152034261],"y":[1,2],"text":["4.1%","3.6%"],"hovertext":["Consumo: No consume alcohol<br>Cargo: Patrón o empleador/a<br>Porcentaje: 4.1%<br>n: 371","Consumo: Sí consume alcohol<br>Cargo: Patrón o empleador/a<br>Porcentaje: 3.6%<br>n: 170"],"textfont":{"size":11.338582677165356,"color":"rgba(255,255,255,1)"},"type":"scatter","mode":"text","hoveron":"points","name":"Patrón o empleador/a","legendgroup":"Patrón o empleador/a","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0.80010014465338819,0.82901498929336181],"y":[1,2],"text":["31.7%","26.9%"],"hovertext":["Consumo: No consume alcohol<br>Cargo: Trabajador/a por cuenta propia<br>Porcentaje: 31.7%<br>n: 2851","Consumo: Sí consume alcohol<br>Cargo: Trabajador/a por cuenta propia<br>Porcentaje: 26.9%<br>n: 1257"],"textfont":{"size":11.338582677165356,"color":"rgba(255,255,255,1)"},"type":"scatter","mode":"text","hoveron":"points","name":"Trabajador/a por cuenta propia","legendgroup":"Trabajador/a por cuenta propia","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0.59324579948814948,0.64668094218415417],"y":[1,2],"text":["9.6%","9.6%"],"hovertext":["Consumo: No consume alcohol<br>Cargo: Empleado/a u obrero/a sector público<br>Porcentaje: 9.6%<br>n: 867","Consumo: Sí consume alcohol<br>Cargo: Empleado/a u obrero/a sector público<br>Porcentaje: 9.6%<br>n: 446"],"textfont":{"size":11.338582677165356,"color":"rgba(255,255,255,1)"},"type":"scatter","mode":"text","hoveron":"points","name":"Empleado/a u obrero/a sector público","legendgroup":"Empleado/a u obrero/a sector público","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0.49799710693223542,0.55331905781584578],"y":[1,2],"text":["9.4%","9.1%"],"hovertext":["Consumo: No consume alcohol<br>Cargo: Empleado/a u obrero/a empresas públicas<br>Porcentaje: 9.4%<br>n: 845","Consumo: Sí consume alcohol<br>Cargo: Empleado/a u obrero/a empresas públicas<br>Porcentaje: 9.1%<br>n: 426"],"textfont":{"size":11.338582677165356,"color":"rgba(255,255,255,1)"},"type":"scatter","mode":"text","hoveron":"points","name":"Empleado/a u obrero/a empresas públicas","legendgroup":"Empleado/a u obrero/a empresas públicas","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0.26482697229331259,0.27130620985010706],"y":[1,2],"text":["37.2%","47.3%"],"hovertext":["Consumo: No consume alcohol<br>Cargo: Empleado/a u obrero/a sector privado<br>Porcentaje: 37.2%<br>n: 3346","Consumo: Sí consume alcohol<br>Cargo: Empleado/a u obrero/a sector privado<br>Porcentaje: 47.3%<br>n: 2208"],"textfont":{"size":11.338582677165356,"color":"rgba(255,255,255,1)"},"type":"scatter","mode":"text","hoveron":"points","name":"Empleado/a u obrero/a sector privado","legendgroup":"Empleado/a u obrero/a sector privado","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0.075108490041170567,0.03340471092077088],"y":[1,2],"text":["0.7%","0.3%"],"hovertext":["Consumo: No consume alcohol<br>Cargo: Servicio doméstico puertas adentro<br>Porcentaje: 0.7%<br>n: 64","Consumo: Sí consume alcohol<br>Cargo: Servicio doméstico puertas adentro<br>Porcentaje: 0.3%<br>n: 14"],"textfont":{"size":11.338582677165356,"color":"rgba(255,255,255,1)"},"type":"scatter","mode":"text","hoveron":"points","name":"Servicio doméstico puertas adentro","legendgroup":"Servicio doméstico puertas adentro","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0.057583175698230779,0.02676659528907923],"y":[1,2],"text":["2.8%","1.0%"],"hovertext":["Consumo: No consume alcohol<br>Cargo: Servicio doméstico puertas afuera<br>Porcentaje: 2.8%<br>n: 251","Consumo: Sí consume alcohol<br>Cargo: Servicio doméstico puertas afuera<br>Porcentaje: 1.0%<br>n: 48"],"textfont":{"size":11.338582677165356,"color":"rgba(255,255,255,1)"},"type":"scatter","mode":"text","hoveron":"points","name":"Servicio doméstico puertas afuera","legendgroup":"Servicio doméstico puertas afuera","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0.042227662178702566,0.019914346895074944],"y":[1,2],"text":["0.3%","0.3%"],"hovertext":["Consumo: No consume alcohol<br>Cargo: F.F.A.A. y del Orden<br>Porcentaje: 0.3%<br>n: 25","Consumo: Sí consume alcohol<br>Cargo: F.F.A.A. y del Orden<br>Porcentaje: 0.3%<br>n: 16"],"textfont":{"size":11.338582677165356,"color":"rgba(255,255,255,1)"},"type":"scatter","mode":"text","hoveron":"points","name":"F.F.A.A. y del Orden","legendgroup":"F.F.A.A. y del Orden","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0.020418382107488593,0.0091006423982869372],"y":[1,2],"text":["4.1%","1.8%"],"hovertext":["Consumo: No consume alcohol<br>Cargo: Familiar no remunerado<br>Porcentaje: 4.1%<br>n: 367","Consumo: Sí consume alcohol<br>Cargo: Familiar no remunerado<br>Porcentaje: 1.8%<br>n: 85"],"textfont":{"size":11.338582677165356,"color":"rgba(255,255,255,1)"},"type":"scatter","mode":"text","hoveron":"points","name":"Familiar no remunerado","legendgroup":"Familiar no remunerado","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":40.840182648401829,"r":7.3059360730593621,"b":37.260273972602747,"l":116.16438356164386},"paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"title":{"text":"Cargo en el trabajo según consumo de alcohol (últimos 30 días)","font":{"color":"rgba(0,0,0,1)","family":"","size":17.534246575342465},"x":0.5,"xref":"paper"},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[0,1],"tickmode":"array","ticktext":["0%","25%","50%","75%","100%"],"tickvals":[0,0.25,0.5,0.75,1],"categoryorder":"array","categoryarray":["0%","25%","50%","75%","100%"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0,"zeroline":false,"anchor":"y","title":{"text":"Porcentaje","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[0.40000000000000002,2.6000000000000001],"tickmode":"array","ticktext":["No consume alcohol","Sí consume alcohol"],"tickvals":[1,2],"categoryorder":"array","categoryarray":["No consume alcohol","Sí consume alcohol"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0,"zeroline":false,"anchor":"x","title":{"text":"","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","layer":"below","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":true,"legend":{"bgcolor":null,"bordercolor":null,"borderwidth":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.68949771689498},"title":{"text":"Cargo en el trabajo","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"5cec10096497":{"x":{},"y":{},"fill":{},"text":{},"type":"bar"},"5cec343043c8":{"x":{},"y":{},"fill":{},"text":{},"label":{}}},"cur_data":"5cec10096497","visdat":{"5cec10096497":["function (y) ","x"],"5cec343043c8":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>En el grupo de personas que no consume alcohol en los últimos 30 días, la mayor proporción corresponde a empleados/as u obreros/as del sector privado (37,2%), seguido por trabajadores/as por cuenta propia (31,7%). Luego aparecen, con proporciones similares, empleados/as del sector público (9,6%) y empleados/as de empresas públicas (9,4%), mientras que patrón o empleador/a representa 4,1%. El porcentaje restante se distribuye en categorías con participación muy baja (servicio doméstico, F.F.A.A. y del Orden y familiar no remunerado).</p>
<p>Por su parte, entre quienes sí consumen alcohol, predomina aún más la categoría empleado/a u obrero/a del sector privado (47,3%), seguida por trabajador/a por cuenta propia (26,9%). Luego se ubican empleado/a u obrero/a del sector público (9,6%) y empleado/a u obrero/a de empresas públicas (9,1%), mientras que patrón o empleador/a alcanza 3,6%; el resto se reparte en proporciones muy pequeñas en las demás categorías.</p>
<p><strong>Consumo de cigarrillos según consumo de alcohol</strong></p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Variable solo para el gráfico </span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>ENPG_filtrado <span class="ot">&lt;-</span> ENPG_filtrado <span class="sc">%&gt;%</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">Consumo_cigarros_plot =</span> <span class="fu">case_when</span>(</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>      <span class="fu">str_to_lower</span>(<span class="fu">str_squish</span>(<span class="fu">as.character</span>(Consumo_cigarros))) <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"sí"</span>, <span class="st">"si"</span>) <span class="sc">~</span> <span class="st">"Sí"</span>,</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>      <span class="fu">str_to_lower</span>(<span class="fu">str_squish</span>(<span class="fu">as.character</span>(Consumo_cigarros))) <span class="sc">==</span> <span class="st">"no"</span>            <span class="sc">~</span> <span class="st">"No"</span>,</span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_character_</span></span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">Consumo_cigarros_plot =</span> <span class="fu">factor</span>(Consumo_cigarros_plot, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Sí"</span>, <span class="st">"No"</span>))</span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Datos para gráfico: 100% apilado dentro de cada barra</span></span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a>df_cigarros <span class="ot">&lt;-</span> ENPG_filtrado <span class="sc">%&gt;%</span></span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(alcohol_30d_plot), <span class="sc">!</span><span class="fu">is.na</span>(Consumo_cigarros_plot)) <span class="sc">%&gt;%</span></span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(alcohol_30d_plot, Consumo_cigarros_plot, <span class="at">name =</span> <span class="st">"Conteo"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb26-17"><a href="#cb26-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">complete</span>(alcohol_30d_plot, Consumo_cigarros_plot, <span class="at">fill =</span> <span class="fu">list</span>(<span class="at">Conteo =</span> <span class="dv">0</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb26-18"><a href="#cb26-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(alcohol_30d_plot) <span class="sc">%&gt;%</span></span>
<span id="cb26-19"><a href="#cb26-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb26-20"><a href="#cb26-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">Total =</span> <span class="fu">sum</span>(Conteo),</span>
<span id="cb26-21"><a href="#cb26-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">Prop  =</span> <span class="fu">ifelse</span>(Total <span class="sc">==</span> <span class="dv">0</span>, <span class="dv">0</span>, Conteo <span class="sc">/</span> Total),</span>
<span id="cb26-22"><a href="#cb26-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">label_pct =</span> <span class="fu">ifelse</span>(Conteo <span class="sc">==</span> <span class="dv">0</span>, <span class="st">""</span>, <span class="fu">percent</span>(Prop, <span class="at">accuracy =</span> <span class="fl">0.1</span>)),</span>
<span id="cb26-23"><a href="#cb26-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">text =</span> <span class="fu">paste0</span>(</span>
<span id="cb26-24"><a href="#cb26-24" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Consumo alcohol: "</span>, alcohol_30d_plot,</span>
<span id="cb26-25"><a href="#cb26-25" aria-hidden="true" tabindex="-1"></a>      <span class="st">"&lt;br&gt;Consumo cigarros: "</span>, Consumo_cigarros_plot,</span>
<span id="cb26-26"><a href="#cb26-26" aria-hidden="true" tabindex="-1"></a>      <span class="st">"&lt;br&gt;Porcentaje: "</span>, <span class="fu">percent</span>(Prop, <span class="at">accuracy =</span> <span class="fl">0.1</span>),</span>
<span id="cb26-27"><a href="#cb26-27" aria-hidden="true" tabindex="-1"></a>      <span class="st">"&lt;br&gt;n: "</span>, Conteo</span>
<span id="cb26-28"><a href="#cb26-28" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb26-29"><a href="#cb26-29" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb26-30"><a href="#cb26-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb26-31"><a href="#cb26-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-32"><a href="#cb26-32" aria-hidden="true" tabindex="-1"></a><span class="co"># Chequeo</span></span>
<span id="cb26-33"><a href="#cb26-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-34"><a href="#cb26-34" aria-hidden="true" tabindex="-1"></a>df_cigarros <span class="sc">%&gt;%</span></span>
<span id="cb26-35"><a href="#cb26-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(alcohol_30d_plot) <span class="sc">%&gt;%</span></span>
<span id="cb26-36"><a href="#cb26-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">suma_prop =</span> <span class="fu">sum</span>(Prop))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 2
  alcohol_30d_plot   suma_prop
  &lt;fct&gt;                  &lt;dbl&gt;
1 No consume alcohol         1
2 Sí consume alcohol         1</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Gráfico: siempre suma 100%</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>Grafico_cigarros <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df_cigarros, <span class="fu">aes</span>(<span class="at">y =</span> alcohol_30d_plot, <span class="at">x =</span> Conteo, <span class="at">fill =</span> Consumo_cigarros_plot, <span class="at">text =</span> text)) <span class="sc">+</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">position =</span> <span class="st">"fill"</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">width =</span> <span class="fl">0.65</span>) <span class="sc">+</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">label =</span> label_pct),</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">position =</span> <span class="fu">position_fill</span>(<span class="at">vjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"white"</span>,</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">3</span></span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">labels =</span> <span class="fu">percent_format</span>(<span class="at">accuracy =</span> <span class="dv">1</span>), <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Consumo de cigarros según consumo de alcohol (últimos 30 días)"</span>,</span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Porcentaje"</span>,</span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="cn">NULL</span>,</span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"Consumo de cigarros"</span></span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>))</span>
<span id="cb28-19"><a href="#cb28-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-20"><a href="#cb28-20" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplotly</span>(Grafico_cigarros, <span class="at">tooltip =</span> <span class="st">"text"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-2514ce28ae593bde0f73" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-2514ce28ae593bde0f73">{"x":{"data":[{"orientation":"v","width":[0.16679560575584096,0.40690281562216168],"base":[0.67500000000000004,1.675],"x":[0.91660219712207947,0.79654859218891916],"y":[0.64999999999999991,0.65000000000000013],"text":["Consumo alcohol: No consume alcohol<br>Consumo cigarros: Sí<br>Porcentaje: 16.7%<br>n: 2156","Consumo alcohol: Sí consume alcohol<br>Consumo cigarros: Sí<br>Porcentaje: 40.7%<br>n: 2240"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(248,118,109,1)","line":{"width":1.8897637795275593,"color":"rgba(0,0,0,1)"}},"name":"Sí","legendgroup":"Sí","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.83320439424415904,0.59309718437783832],"base":[0.67500000000000004,1.675],"x":[0.41660219712207952,0.29654859218891916],"y":[0.64999999999999991,0.65000000000000013],"text":["Consumo alcohol: No consume alcohol<br>Consumo cigarros: No<br>Porcentaje: 83.3%<br>n: 10770","Consumo alcohol: Sí consume alcohol<br>Consumo cigarros: No<br>Porcentaje: 59.3%<br>n: 3265"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(0,191,196,1)","line":{"width":1.8897637795275593,"color":"rgba(0,0,0,1)"}},"name":"No","legendgroup":"No","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0.91660219712207947,0.79654859218891916],"y":[1,2],"text":["16.7%","40.7%"],"hovertext":["Consumo alcohol: No consume alcohol<br>Consumo cigarros: Sí<br>Porcentaje: 16.7%<br>n: 2156","Consumo alcohol: Sí consume alcohol<br>Consumo cigarros: Sí<br>Porcentaje: 40.7%<br>n: 2240"],"textfont":{"size":11.338582677165356,"color":"rgba(255,255,255,1)"},"type":"scatter","mode":"text","hoveron":"points","name":"Sí","legendgroup":"Sí","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0.41660219712207952,0.29654859218891916],"y":[1,2],"text":["83.3%","59.3%"],"hovertext":["Consumo alcohol: No consume alcohol<br>Consumo cigarros: No<br>Porcentaje: 83.3%<br>n: 10770","Consumo alcohol: Sí consume alcohol<br>Consumo cigarros: No<br>Porcentaje: 59.3%<br>n: 3265"],"textfont":{"size":11.338582677165356,"color":"rgba(255,255,255,1)"},"type":"scatter","mode":"text","hoveron":"points","name":"No","legendgroup":"No","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":40.840182648401829,"r":7.3059360730593621,"b":37.260273972602747,"l":116.16438356164386},"paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"title":{"text":"Consumo de cigarros según consumo de alcohol (últimos 30 días)","font":{"color":"rgba(0,0,0,1)","family":"","size":17.534246575342465},"x":0.5,"xref":"paper"},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[0,1],"tickmode":"array","ticktext":["0%","25%","50%","75%","100%"],"tickvals":[0,0.25,0.5,0.75,1],"categoryorder":"array","categoryarray":["0%","25%","50%","75%","100%"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0,"zeroline":false,"anchor":"y","title":{"text":"Porcentaje","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[0.40000000000000002,2.6000000000000001],"tickmode":"array","ticktext":["No consume alcohol","Sí consume alcohol"],"tickvals":[1,2],"categoryorder":"array","categoryarray":["No consume alcohol","Sí consume alcohol"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0,"zeroline":false,"anchor":"x","title":{"text":"","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","layer":"below","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":true,"legend":{"bgcolor":null,"bordercolor":null,"borderwidth":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.68949771689498},"title":{"text":"Consumo de cigarros","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"5cec481b2a3e":{"x":{},"y":{},"fill":{},"text":{},"type":"bar"},"5cec1c035ad6":{"x":{},"y":{},"fill":{},"text":{},"label":{}}},"cur_data":"5cec481b2a3e","visdat":{"5cec481b2a3e":["function (y) ","x"],"5cec1c035ad6":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>En el grupo de personas que no consume alcohol en los últimos 30 días, el 16,7% declara que sí consume cigarros, mientras que el 83,3% señala que no consume.</p>
<p>En cambio, entre quienes sí consumen alcohol, el 40,7% indica que sí consume cigarros y el 59,3% que no. En comparación, se observa que el consumo de alcohol se asocia con una mayor proporción de consumo de cigarros, aumentando desde 16,7% en quienes no consumen alcohol a 40,7% en quienes sí consumen.</p>
<p><strong>Consumo de marihuana según consumo de alcohol</strong></p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Variable solo para el gráfico </span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>ENPG_filtrado <span class="ot">&lt;-</span> ENPG_filtrado <span class="sc">%&gt;%</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">mar_raw =</span> <span class="fu">str_to_lower</span>(<span class="fu">str_squish</span>(<span class="fu">as.character</span>(Consumo_mar))),</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">Consumo_mar_plot =</span> <span class="fu">case_when</span>(</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>      mar_raw <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"sí"</span>,<span class="st">"si"</span>,<span class="st">"s"</span>,<span class="st">"1"</span>,<span class="st">"true"</span>,<span class="st">"verdadero"</span>) <span class="sc">~</span> <span class="st">"Sí"</span>,</span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>      mar_raw <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"no"</span>,<span class="st">"n"</span>,<span class="st">"0"</span>,<span class="st">"2"</span>,<span class="st">"false"</span>,<span class="st">"falso"</span>)     <span class="sc">~</span> <span class="st">"No"</span>,</span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>      <span class="fu">str_detect</span>(mar_raw, <span class="st">"^(sí|si)</span><span class="sc">\\</span><span class="st">b"</span>)                   <span class="sc">~</span> <span class="st">"Sí"</span>,</span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>      <span class="fu">str_detect</span>(mar_raw, <span class="st">"^no</span><span class="sc">\\</span><span class="st">b"</span>)                        <span class="sc">~</span> <span class="st">"No"</span>,</span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_character_</span></span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">Consumo_mar_plot =</span> <span class="fu">factor</span>(Consumo_mar_plot, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Sí"</span>, <span class="st">"No"</span>))</span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Chequeo</span></span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-18"><a href="#cb29-18" aria-hidden="true" tabindex="-1"></a>ENPG_filtrado <span class="sc">%&gt;%</span> <span class="fu">count</span>(Consumo_mar_plot, <span class="at">sort =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  Consumo_mar_plot     n
1               No 17688
2               Sí   847
3             &lt;NA&gt;   133</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Datos para gráfico:  100% apilado dentro de cada barra</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>df_marihuana <span class="ot">&lt;-</span> ENPG_filtrado <span class="sc">%&gt;%</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(alcohol_30d_plot), <span class="sc">!</span><span class="fu">is.na</span>(Consumo_mar_plot)) <span class="sc">%&gt;%</span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(alcohol_30d_plot, Consumo_mar_plot, <span class="at">name =</span> <span class="st">"Conteo"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">complete</span>(alcohol_30d_plot, Consumo_mar_plot, <span class="at">fill =</span> <span class="fu">list</span>(<span class="at">Conteo =</span> <span class="dv">0</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(alcohol_30d_plot) <span class="sc">%&gt;%</span></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">Total =</span> <span class="fu">sum</span>(Conteo),</span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">Prop  =</span> <span class="fu">ifelse</span>(Total <span class="sc">==</span> <span class="dv">0</span>, <span class="dv">0</span>, Conteo <span class="sc">/</span> Total),</span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">label_pct =</span> <span class="fu">ifelse</span>(Conteo <span class="sc">==</span> <span class="dv">0</span>, <span class="st">""</span>, <span class="fu">percent</span>(Prop, <span class="at">accuracy =</span> <span class="fl">0.1</span>)),</span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">text =</span> <span class="fu">paste0</span>(</span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Consumo alcohol: "</span>, alcohol_30d_plot,</span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a>      <span class="st">"&lt;br&gt;Consumo marihuana: "</span>, Consumo_mar_plot,</span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a>      <span class="st">"&lt;br&gt;Porcentaje: "</span>, <span class="fu">percent</span>(Prop, <span class="at">accuracy =</span> <span class="fl">0.1</span>),</span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a>      <span class="st">"&lt;br&gt;n: "</span>, Conteo</span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb31-18"><a href="#cb31-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb31-19"><a href="#cb31-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-20"><a href="#cb31-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Chequeo</span></span>
<span id="cb31-21"><a href="#cb31-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-22"><a href="#cb31-22" aria-hidden="true" tabindex="-1"></a>df_marihuana <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(alcohol_30d_plot) <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="at">suma_prop =</span> <span class="fu">sum</span>(Prop))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 2
  alcohol_30d_plot   suma_prop
  &lt;fct&gt;                  &lt;dbl&gt;
1 No consume alcohol         1
2 Sí consume alcohol         1</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Gráfico: siempre suma 100%</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>Grafico_marihuana <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df_marihuana, <span class="fu">aes</span>(<span class="at">y =</span> alcohol_30d_plot, <span class="at">x =</span> Conteo, <span class="at">fill =</span> Consumo_mar_plot, <span class="at">text =</span> text)) <span class="sc">+</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">position =</span> <span class="st">"fill"</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">width =</span> <span class="fl">0.65</span>) <span class="sc">+</span></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">label =</span> label_pct),</span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">position =</span> <span class="fu">position_fill</span>(<span class="at">vjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"white"</span>,</span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">3</span></span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">labels =</span> <span class="fu">percent_format</span>(<span class="at">accuracy =</span> <span class="dv">1</span>), <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Consumo de marihuana según consumo de alcohol (últimos 30 días)"</span>,</span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Porcentaje"</span>,</span>
<span id="cb33-15"><a href="#cb33-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="cn">NULL</span>,</span>
<span id="cb33-16"><a href="#cb33-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"Consumo de marihuana"</span></span>
<span id="cb33-17"><a href="#cb33-17" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb33-18"><a href="#cb33-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb33-19"><a href="#cb33-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>))</span>
<span id="cb33-20"><a href="#cb33-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-21"><a href="#cb33-21" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplotly</span>(Grafico_marihuana, <span class="at">tooltip =</span> <span class="st">"text"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-5d05eac75555269eefd0" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-5d05eac75555269eefd0">{"x":{"data":[{"orientation":"v","width":[0.019343856391210168,0.10796074154852786],"base":[0.67500000000000004,1.675],"x":[0.99032807180439497,0.94601962922573613],"y":[0.64999999999999991,0.65000000000000013],"text":["Consumo alcohol: No consume alcohol<br>Consumo marihuana: Sí<br>Porcentaje: 1.9%<br>n: 250","Consumo alcohol: Sí consume alcohol<br>Consumo marihuana: Sí<br>Porcentaje: 10.8%<br>n: 594"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(248,118,109,1)","line":{"width":1.8897637795275593,"color":"rgba(0,0,0,1)"}},"name":"Sí","legendgroup":"Sí","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.98065614360878983,0.89203925845147214],"base":[0.67500000000000004,1.675],"x":[0.49032807180439492,0.44601962922573607],"y":[0.64999999999999991,0.65000000000000013],"text":["Consumo alcohol: No consume alcohol<br>Consumo marihuana: No<br>Porcentaje: 98.1%<br>n: 12674","Consumo alcohol: Sí consume alcohol<br>Consumo marihuana: No<br>Porcentaje: 89.2%<br>n: 4908"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(0,191,196,1)","line":{"width":1.8897637795275593,"color":"rgba(0,0,0,1)"}},"name":"No","legendgroup":"No","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0.99032807180439497,0.94601962922573613],"y":[1,2],"text":["1.9%","10.8%"],"hovertext":["Consumo alcohol: No consume alcohol<br>Consumo marihuana: Sí<br>Porcentaje: 1.9%<br>n: 250","Consumo alcohol: Sí consume alcohol<br>Consumo marihuana: Sí<br>Porcentaje: 10.8%<br>n: 594"],"textfont":{"size":11.338582677165356,"color":"rgba(255,255,255,1)"},"type":"scatter","mode":"text","hoveron":"points","name":"Sí","legendgroup":"Sí","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0.49032807180439492,0.44601962922573607],"y":[1,2],"text":["98.1%","89.2%"],"hovertext":["Consumo alcohol: No consume alcohol<br>Consumo marihuana: No<br>Porcentaje: 98.1%<br>n: 12674","Consumo alcohol: Sí consume alcohol<br>Consumo marihuana: No<br>Porcentaje: 89.2%<br>n: 4908"],"textfont":{"size":11.338582677165356,"color":"rgba(255,255,255,1)"},"type":"scatter","mode":"text","hoveron":"points","name":"No","legendgroup":"No","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":40.840182648401829,"r":7.3059360730593621,"b":37.260273972602747,"l":116.16438356164386},"paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"title":{"text":"Consumo de marihuana según consumo de alcohol (últimos 30 días)","font":{"color":"rgba(0,0,0,1)","family":"","size":17.534246575342465},"x":0.5,"xref":"paper"},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[0,1],"tickmode":"array","ticktext":["0%","25%","50%","75%","100%"],"tickvals":[0,0.25,0.5,0.75,1],"categoryorder":"array","categoryarray":["0%","25%","50%","75%","100%"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0,"zeroline":false,"anchor":"y","title":{"text":"Porcentaje","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[0.40000000000000002,2.6000000000000001],"tickmode":"array","ticktext":["No consume alcohol","Sí consume alcohol"],"tickvals":[1,2],"categoryorder":"array","categoryarray":["No consume alcohol","Sí consume alcohol"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0,"zeroline":false,"anchor":"x","title":{"text":"","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","layer":"below","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":true,"legend":{"bgcolor":null,"bordercolor":null,"borderwidth":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.68949771689498},"title":{"text":"Consumo de marihuana","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"5cec1e29745c":{"x":{},"y":{},"fill":{},"text":{},"type":"bar"},"5cec182f189d":{"x":{},"y":{},"fill":{},"text":{},"label":{}}},"cur_data":"5cec1e29745c","visdat":{"5cec1e29745c":["function (y) ","x"],"5cec182f189d":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>En el grupo de personas que no consume alcohol en los últimos 30 días, el 1,9% declara que sí consume marihuana, mientras que el 98,1% indica que no consume.</p>
<p>En cambio, entre quienes sí consumen alcohol, el 10,8% señala que sí consume marihuana y el 89,2% que no. En comparación, se observa que el consumo de alcohol se asocia con una mayor proporción de consumo de marihuana, aumentando desde 1,9% en quienes no consumen alcohol a 10,8% en quienes sí consumen.</p>
<p><strong>Consumo de cocaína según consumo de alcohol</strong></p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Variable solo para el gráfico</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>ENPG_filtrado <span class="ot">&lt;-</span> ENPG_filtrado <span class="sc">%&gt;%</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">coc_raw =</span> <span class="fu">str_to_lower</span>(<span class="fu">str_squish</span>(<span class="fu">as.character</span>(Consumo_coc))),</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">Consumo_coc_plot =</span> <span class="fu">case_when</span>(</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>      coc_raw <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"sí"</span>,<span class="st">"si"</span>,<span class="st">"s"</span>,<span class="st">"1"</span>,<span class="st">"true"</span>,<span class="st">"verdadero"</span>) <span class="sc">~</span> <span class="st">"Sí"</span>,</span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>      coc_raw <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"no"</span>,<span class="st">"n"</span>,<span class="st">"0"</span>,<span class="st">"2"</span>,<span class="st">"false"</span>,<span class="st">"falso"</span>)     <span class="sc">~</span> <span class="st">"No"</span>,</span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>      <span class="fu">str_detect</span>(coc_raw, <span class="st">"^(sí|si)</span><span class="sc">\\</span><span class="st">b"</span>)                   <span class="sc">~</span> <span class="st">"Sí"</span>,</span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>      <span class="fu">str_detect</span>(coc_raw, <span class="st">"^no</span><span class="sc">\\</span><span class="st">b"</span>)                        <span class="sc">~</span> <span class="st">"No"</span>,</span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_character_</span></span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">Consumo_coc_plot =</span> <span class="fu">factor</span>(Consumo_coc_plot, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Sí"</span>, <span class="st">"No"</span>))</span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-16"><a href="#cb34-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Chequeo</span></span>
<span id="cb34-17"><a href="#cb34-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-18"><a href="#cb34-18" aria-hidden="true" tabindex="-1"></a>ENPG_filtrado <span class="sc">%&gt;%</span> <span class="fu">count</span>(Consumo_coc_plot, <span class="at">sort =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  Consumo_coc_plot     n
1               No 18541
2             &lt;NA&gt;    88
3               Sí    39</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Datos para gráfico: 100% apilado dentro de cada barra</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>df_cocaina <span class="ot">&lt;-</span> ENPG_filtrado <span class="sc">%&gt;%</span></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(alcohol_30d_plot), <span class="sc">!</span><span class="fu">is.na</span>(Consumo_coc_plot)) <span class="sc">%&gt;%</span></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(alcohol_30d_plot, Consumo_coc_plot, <span class="at">name =</span> <span class="st">"Conteo"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">complete</span>(alcohol_30d_plot, Consumo_coc_plot, <span class="at">fill =</span> <span class="fu">list</span>(<span class="at">Conteo =</span> <span class="dv">0</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(alcohol_30d_plot) <span class="sc">%&gt;%</span></span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">Total =</span> <span class="fu">sum</span>(Conteo),</span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">Prop  =</span> <span class="fu">ifelse</span>(Total <span class="sc">==</span> <span class="dv">0</span>, <span class="dv">0</span>, Conteo <span class="sc">/</span> Total),</span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">label_pct =</span> <span class="fu">ifelse</span>(Conteo <span class="sc">==</span> <span class="dv">0</span>, <span class="st">""</span>, <span class="fu">percent</span>(Prop, <span class="at">accuracy =</span> <span class="fl">0.1</span>)),</span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">text =</span> <span class="fu">paste0</span>(</span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Consumo alcohol: "</span>, alcohol_30d_plot,</span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true" tabindex="-1"></a>      <span class="st">"&lt;br&gt;Consumo cocaína: "</span>, Consumo_coc_plot,</span>
<span id="cb36-15"><a href="#cb36-15" aria-hidden="true" tabindex="-1"></a>      <span class="st">"&lt;br&gt;Porcentaje: "</span>, <span class="fu">percent</span>(Prop, <span class="at">accuracy =</span> <span class="fl">0.1</span>),</span>
<span id="cb36-16"><a href="#cb36-16" aria-hidden="true" tabindex="-1"></a>      <span class="st">"&lt;br&gt;n: "</span>, Conteo</span>
<span id="cb36-17"><a href="#cb36-17" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb36-18"><a href="#cb36-18" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb36-19"><a href="#cb36-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb36-20"><a href="#cb36-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-21"><a href="#cb36-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Chequeo</span></span>
<span id="cb36-22"><a href="#cb36-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-23"><a href="#cb36-23" aria-hidden="true" tabindex="-1"></a>df_cocaina <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(alcohol_30d_plot) <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="at">suma_prop =</span> <span class="fu">sum</span>(Prop))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 2
  alcohol_30d_plot   suma_prop
  &lt;fct&gt;                  &lt;dbl&gt;
1 No consume alcohol         1
2 Sí consume alcohol         1</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Gráfico: siempre suma 100%</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>Grafico_cocaina <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df_cocaina, <span class="fu">aes</span>(<span class="at">y =</span> alcohol_30d_plot, <span class="at">x =</span> Conteo, <span class="at">fill =</span> Consumo_coc_plot, <span class="at">text =</span> text)) <span class="sc">+</span></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">position =</span> <span class="st">"fill"</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">width =</span> <span class="fl">0.65</span>) <span class="sc">+</span></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">label =</span> label_pct),</span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">position =</span> <span class="fu">position_fill</span>(<span class="at">vjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"white"</span>,</span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">3</span></span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">labels =</span> <span class="fu">percent_format</span>(<span class="at">accuracy =</span> <span class="dv">1</span>), <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Consumo de cocaína según consumo de alcohol (últimos 30 días)"</span>,</span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Porcentaje"</span>,</span>
<span id="cb38-15"><a href="#cb38-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="cn">NULL</span>,</span>
<span id="cb38-16"><a href="#cb38-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"Consumo de cocaína"</span></span>
<span id="cb38-17"><a href="#cb38-17" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb38-18"><a href="#cb38-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb38-19"><a href="#cb38-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>))</span>
<span id="cb38-20"><a href="#cb38-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-21"><a href="#cb38-21" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplotly</span>(Grafico_cocaina, <span class="at">tooltip =</span> <span class="st">"text"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-7531f021030c44f57ef2" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-7531f021030c44f57ef2">{"x":{"data":[{"orientation":"v","width":[0.00038645849435769986,0.0059836808703536137],"base":[0.67500000000000004,1.675],"x":[0.99980677075282109,0.99700815956482325],"y":[0.64999999999999991,0.65000000000000013],"text":["Consumo alcohol: No consume alcohol<br>Consumo cocaína: Sí<br>Porcentaje: 0.0%<br>n: 5","Consumo alcohol: Sí consume alcohol<br>Consumo cocaína: Sí<br>Porcentaje: 0.6%<br>n: 33"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(248,118,109,1)","line":{"width":1.8897637795275593,"color":"rgba(0,0,0,1)"}},"name":"Sí","legendgroup":"Sí","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.9996135415056423,0.99401631912964639],"base":[0.67500000000000004,1.675],"x":[0.49980677075282115,0.49700815956482319],"y":[0.64999999999999991,0.65000000000000013],"text":["Consumo alcohol: No consume alcohol<br>Consumo cocaína: No<br>Porcentaje: 100.0%<br>n: 12933","Consumo alcohol: Sí consume alcohol<br>Consumo cocaína: No<br>Porcentaje: 99.4%<br>n: 5482"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(0,191,196,1)","line":{"width":1.8897637795275593,"color":"rgba(0,0,0,1)"}},"name":"No","legendgroup":"No","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0.99980677075282109,0.99700815956482325],"y":[1,2],"text":["0.0%","0.6%"],"hovertext":["Consumo alcohol: No consume alcohol<br>Consumo cocaína: Sí<br>Porcentaje: 0.0%<br>n: 5","Consumo alcohol: Sí consume alcohol<br>Consumo cocaína: Sí<br>Porcentaje: 0.6%<br>n: 33"],"textfont":{"size":11.338582677165356,"color":"rgba(255,255,255,1)"},"type":"scatter","mode":"text","hoveron":"points","name":"Sí","legendgroup":"Sí","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0.49980677075282115,0.49700815956482319],"y":[1,2],"text":["100.0%","99.4%"],"hovertext":["Consumo alcohol: No consume alcohol<br>Consumo cocaína: No<br>Porcentaje: 100.0%<br>n: 12933","Consumo alcohol: Sí consume alcohol<br>Consumo cocaína: No<br>Porcentaje: 99.4%<br>n: 5482"],"textfont":{"size":11.338582677165356,"color":"rgba(255,255,255,1)"},"type":"scatter","mode":"text","hoveron":"points","name":"No","legendgroup":"No","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":40.840182648401829,"r":7.3059360730593621,"b":37.260273972602747,"l":116.16438356164386},"paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"title":{"text":"Consumo de cocaína según consumo de alcohol (últimos 30 días)","font":{"color":"rgba(0,0,0,1)","family":"","size":17.534246575342465},"x":0.5,"xref":"paper"},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[0,1],"tickmode":"array","ticktext":["0%","25%","50%","75%","100%"],"tickvals":[0,0.25,0.5,0.75,1],"categoryorder":"array","categoryarray":["0%","25%","50%","75%","100%"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0,"zeroline":false,"anchor":"y","title":{"text":"Porcentaje","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[0.40000000000000002,2.6000000000000001],"tickmode":"array","ticktext":["No consume alcohol","Sí consume alcohol"],"tickvals":[1,2],"categoryorder":"array","categoryarray":["No consume alcohol","Sí consume alcohol"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0,"zeroline":false,"anchor":"x","title":{"text":"","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","layer":"below","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":true,"legend":{"bgcolor":null,"bordercolor":null,"borderwidth":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.68949771689498},"title":{"text":"Consumo de cocaína","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"5cec44f932a5":{"x":{},"y":{},"fill":{},"text":{},"type":"bar"},"5cec598a22d4":{"x":{},"y":{},"fill":{},"text":{},"label":{}}},"cur_data":"5cec44f932a5","visdat":{"5cec44f932a5":["function (y) ","x"],"5cec598a22d4":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>En el grupo de personas que no consume alcohol en los últimos 30 días, prácticamente la totalidad no consume cocaína (100,0%), mientras que el consumo aparece como 0,0%.</p>
<p>Por su parte, entre quienes sí consumen alcohol, el 99,4% declara no consumir cocaína y el 0,6% señala que sí consume. En general, el consumo de cocaína es muy bajo en ambos grupos, observándose una presencia levemente mayor entre quienes consumen alcohol.</p>
<p><strong>Consumo de pasta base según consumo de alcohol</strong></p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Variable solo para el gráfico </span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>ENPG_filtrado <span class="ot">&lt;-</span> ENPG_filtrado <span class="sc">%&gt;%</span></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">pb_raw =</span> <span class="fu">str_to_lower</span>(<span class="fu">str_squish</span>(<span class="fu">as.character</span>(Consumo_pb))),</span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">Consumo_pb_plot =</span> <span class="fu">case_when</span>(</span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>      pb_raw <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"sí"</span>,<span class="st">"si"</span>,<span class="st">"s"</span>,<span class="st">"1"</span>,<span class="st">"true"</span>,<span class="st">"verdadero"</span>) <span class="sc">~</span> <span class="st">"Sí"</span>,</span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>      pb_raw <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"no"</span>,<span class="st">"n"</span>,<span class="st">"0"</span>,<span class="st">"2"</span>,<span class="st">"false"</span>,<span class="st">"falso"</span>)     <span class="sc">~</span> <span class="st">"No"</span>,</span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a>      <span class="fu">str_detect</span>(pb_raw, <span class="st">"^(sí|si)</span><span class="sc">\\</span><span class="st">b"</span>)                   <span class="sc">~</span> <span class="st">"Sí"</span>,</span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a>      <span class="fu">str_detect</span>(pb_raw, <span class="st">"^no</span><span class="sc">\\</span><span class="st">b"</span>)                        <span class="sc">~</span> <span class="st">"No"</span>,</span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_character_</span></span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">Consumo_pb_plot =</span> <span class="fu">factor</span>(Consumo_pb_plot, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Sí"</span>, <span class="st">"No"</span>))</span>
<span id="cb39-14"><a href="#cb39-14" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb39-15"><a href="#cb39-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-16"><a href="#cb39-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Chequeo</span></span>
<span id="cb39-17"><a href="#cb39-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-18"><a href="#cb39-18" aria-hidden="true" tabindex="-1"></a>ENPG_filtrado <span class="sc">%&gt;%</span> <span class="fu">count</span>(Consumo_pb_plot, <span class="at">sort =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  Consumo_pb_plot     n
1              No 18538
2            &lt;NA&gt;    91
3              Sí    39</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Datos para gráfico: 100% apilado dentro de cada barra</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>df_pasta_base <span class="ot">&lt;-</span> ENPG_filtrado <span class="sc">%&gt;%</span></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(alcohol_30d_plot), <span class="sc">!</span><span class="fu">is.na</span>(Consumo_pb_plot)) <span class="sc">%&gt;%</span></span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(alcohol_30d_plot, Consumo_pb_plot, <span class="at">name =</span> <span class="st">"Conteo"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">complete</span>(alcohol_30d_plot, Consumo_pb_plot, <span class="at">fill =</span> <span class="fu">list</span>(<span class="at">Conteo =</span> <span class="dv">0</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(alcohol_30d_plot) <span class="sc">%&gt;%</span></span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">Total =</span> <span class="fu">sum</span>(Conteo),</span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">Prop  =</span> <span class="fu">ifelse</span>(Total <span class="sc">==</span> <span class="dv">0</span>, <span class="dv">0</span>, Conteo <span class="sc">/</span> Total),</span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">label_pct =</span> <span class="fu">ifelse</span>(Conteo <span class="sc">==</span> <span class="dv">0</span>, <span class="st">""</span>, <span class="fu">percent</span>(Prop, <span class="at">accuracy =</span> <span class="fl">0.1</span>)),</span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">text =</span> <span class="fu">paste0</span>(</span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Consumo alcohol: "</span>, alcohol_30d_plot,</span>
<span id="cb41-14"><a href="#cb41-14" aria-hidden="true" tabindex="-1"></a>      <span class="st">"&lt;br&gt;Consumo pasta base: "</span>, Consumo_pb_plot,</span>
<span id="cb41-15"><a href="#cb41-15" aria-hidden="true" tabindex="-1"></a>      <span class="st">"&lt;br&gt;Porcentaje: "</span>, <span class="fu">percent</span>(Prop, <span class="at">accuracy =</span> <span class="fl">0.1</span>),</span>
<span id="cb41-16"><a href="#cb41-16" aria-hidden="true" tabindex="-1"></a>      <span class="st">"&lt;br&gt;n: "</span>, Conteo</span>
<span id="cb41-17"><a href="#cb41-17" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb41-18"><a href="#cb41-18" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb41-19"><a href="#cb41-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb41-20"><a href="#cb41-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-21"><a href="#cb41-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Chequeo</span></span>
<span id="cb41-22"><a href="#cb41-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-23"><a href="#cb41-23" aria-hidden="true" tabindex="-1"></a>df_pasta_base <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(alcohol_30d_plot) <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="at">suma_prop =</span> <span class="fu">sum</span>(Prop))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 2
  alcohol_30d_plot   suma_prop
  &lt;fct&gt;                  &lt;dbl&gt;
1 No consume alcohol         1
2 Sí consume alcohol         1</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Gráfico: siempre suma 100%</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>Grafico_pasta_base <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df_pasta_base, <span class="fu">aes</span>(<span class="at">y =</span> alcohol_30d_plot, <span class="at">x =</span> Conteo, <span class="at">fill =</span> Consumo_pb_plot, <span class="at">text =</span> text)) <span class="sc">+</span></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">position =</span> <span class="st">"fill"</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">width =</span> <span class="fl">0.65</span>) <span class="sc">+</span></span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(</span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">label =</span> label_pct),</span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">position =</span> <span class="fu">position_fill</span>(<span class="at">vjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"white"</span>,</span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">3</span></span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb43-11"><a href="#cb43-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">labels =</span> <span class="fu">percent_format</span>(<span class="at">accuracy =</span> <span class="dv">1</span>), <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb43-12"><a href="#cb43-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb43-13"><a href="#cb43-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Consumo de pasta base según consumo de alcohol (últimos 30 días)"</span>,</span>
<span id="cb43-14"><a href="#cb43-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Porcentaje"</span>,</span>
<span id="cb43-15"><a href="#cb43-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="cn">NULL</span>,</span>
<span id="cb43-16"><a href="#cb43-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"Consumo de pasta base"</span></span>
<span id="cb43-17"><a href="#cb43-17" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb43-18"><a href="#cb43-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb43-19"><a href="#cb43-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>))</span>
<span id="cb43-20"><a href="#cb43-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-21"><a href="#cb43-21" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplotly</span>(Grafico_pasta_base, <span class="at">tooltip =</span> <span class="st">"text"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-983315589fed18d622a7" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-983315589fed18d622a7">{"x":{"data":[{"orientation":"v","width":[0.00085073472544472395,0.0050743022834360829],"base":[0.67500000000000004,1.675],"x":[0.99957463263727764,0.99746284885828196],"y":[0.64999999999999991,0.65000000000000013],"text":["Consumo alcohol: No consume alcohol<br>Consumo pasta base: Sí<br>Porcentaje: 0.1%<br>n: 11","Consumo alcohol: Sí consume alcohol<br>Consumo pasta base: Sí<br>Porcentaje: 0.5%<br>n: 28"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(248,118,109,1)","line":{"width":1.8897637795275593,"color":"rgba(0,0,0,1)"}},"name":"Sí","legendgroup":"Sí","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.99914926527455528,0.99492569771656392],"base":[0.67500000000000004,1.675],"x":[0.49957463263727764,0.49746284885828196],"y":[0.64999999999999991,0.65000000000000013],"text":["Consumo alcohol: No consume alcohol<br>Consumo pasta base: No<br>Porcentaje: 99.9%<br>n: 12919","Consumo alcohol: Sí consume alcohol<br>Consumo pasta base: No<br>Porcentaje: 99.5%<br>n: 5490"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(0,191,196,1)","line":{"width":1.8897637795275593,"color":"rgba(0,0,0,1)"}},"name":"No","legendgroup":"No","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0.99957463263727764,0.99746284885828196],"y":[1,2],"text":["0.1%","0.5%"],"hovertext":["Consumo alcohol: No consume alcohol<br>Consumo pasta base: Sí<br>Porcentaje: 0.1%<br>n: 11","Consumo alcohol: Sí consume alcohol<br>Consumo pasta base: Sí<br>Porcentaje: 0.5%<br>n: 28"],"textfont":{"size":11.338582677165356,"color":"rgba(255,255,255,1)"},"type":"scatter","mode":"text","hoveron":"points","name":"Sí","legendgroup":"Sí","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0.49957463263727764,0.49746284885828196],"y":[1,2],"text":["99.9%","99.5%"],"hovertext":["Consumo alcohol: No consume alcohol<br>Consumo pasta base: No<br>Porcentaje: 99.9%<br>n: 12919","Consumo alcohol: Sí consume alcohol<br>Consumo pasta base: No<br>Porcentaje: 99.5%<br>n: 5490"],"textfont":{"size":11.338582677165356,"color":"rgba(255,255,255,1)"},"type":"scatter","mode":"text","hoveron":"points","name":"No","legendgroup":"No","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":40.840182648401829,"r":7.3059360730593621,"b":37.260273972602747,"l":116.16438356164386},"paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"title":{"text":"Consumo de pasta base según consumo de alcohol (últimos 30 días)","font":{"color":"rgba(0,0,0,1)","family":"","size":17.534246575342465},"x":0.5,"xref":"paper"},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[0,1],"tickmode":"array","ticktext":["0%","25%","50%","75%","100%"],"tickvals":[0,0.25,0.5,0.75,1],"categoryorder":"array","categoryarray":["0%","25%","50%","75%","100%"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0,"zeroline":false,"anchor":"y","title":{"text":"Porcentaje","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[0.40000000000000002,2.6000000000000001],"tickmode":"array","ticktext":["No consume alcohol","Sí consume alcohol"],"tickvals":[1,2],"categoryorder":"array","categoryarray":["No consume alcohol","Sí consume alcohol"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0,"zeroline":false,"anchor":"x","title":{"text":"","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","layer":"below","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":true,"legend":{"bgcolor":null,"bordercolor":null,"borderwidth":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.68949771689498},"title":{"text":"Consumo de pasta base","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"5cec9193c45":{"x":{},"y":{},"fill":{},"text":{},"type":"bar"},"5cec7c053928":{"x":{},"y":{},"fill":{},"text":{},"label":{}}},"cur_data":"5cec9193c45","visdat":{"5cec9193c45":["function (y) ","x"],"5cec7c053928":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>En el grupo de personas que no consume alcohol en los últimos 30 días, prácticamente la totalidad declara no consumir pasta base (99,9%), mientras que el consumo aparece como 0,1%.</p>
<p>En cambio, entre quienes sí consumen alcohol, el 99,5% señala no consumir pasta base y el 0,5% indica que sí consume. En general, el consumo de pasta base es muy bajo en ambos grupos, aunque se observa una proporción levemente mayor entre quienes consumen alcohol.</p>
<p><strong>Consumo de tusi según consumo de alcohol</strong></p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Variable solo para el gráfico </span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>ENPG_filtrado <span class="ot">&lt;-</span> ENPG_filtrado <span class="sc">%&gt;%</span></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">tus_raw =</span> <span class="fu">str_to_lower</span>(<span class="fu">str_squish</span>(<span class="fu">as.character</span>(Consumo_tus))),</span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">Consumo_tus_plot =</span> <span class="fu">case_when</span>(</span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>      tus_raw <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"sí"</span>,<span class="st">"si"</span>,<span class="st">"s"</span>,<span class="st">"1"</span>,<span class="st">"true"</span>,<span class="st">"verdadero"</span>) <span class="sc">~</span> <span class="st">"Sí"</span>,</span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>      tus_raw <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"no"</span>,<span class="st">"n"</span>,<span class="st">"0"</span>,<span class="st">"2"</span>,<span class="st">"false"</span>,<span class="st">"falso"</span>)     <span class="sc">~</span> <span class="st">"No"</span>,</span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a>      <span class="fu">str_detect</span>(tus_raw, <span class="st">"^(sí|si)</span><span class="sc">\\</span><span class="st">b"</span>)                   <span class="sc">~</span> <span class="st">"Sí"</span>,</span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a>      <span class="fu">str_detect</span>(tus_raw, <span class="st">"^no</span><span class="sc">\\</span><span class="st">b"</span>)                        <span class="sc">~</span> <span class="st">"No"</span>,</span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_character_</span></span>
<span id="cb44-12"><a href="#cb44-12" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb44-13"><a href="#cb44-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">Consumo_tus_plot =</span> <span class="fu">factor</span>(Consumo_tus_plot, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Sí"</span>, <span class="st">"No"</span>))</span>
<span id="cb44-14"><a href="#cb44-14" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb44-15"><a href="#cb44-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-16"><a href="#cb44-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Chequeo</span></span>
<span id="cb44-17"><a href="#cb44-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-18"><a href="#cb44-18" aria-hidden="true" tabindex="-1"></a>ENPG_filtrado <span class="sc">%&gt;%</span> <span class="fu">count</span>(Consumo_tus_plot, <span class="at">sort =</span> <span class="cn">TRUE</span>)</span>
<span id="cb44-19"><a href="#cb44-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-20"><a href="#cb44-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Datos para gráfico: 100% apilado dentro de cada barra</span></span>
<span id="cb44-21"><a href="#cb44-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-22"><a href="#cb44-22" aria-hidden="true" tabindex="-1"></a>df_tusi <span class="ot">&lt;-</span> ENPG_filtrado <span class="sc">%&gt;%</span></span>
<span id="cb44-23"><a href="#cb44-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(alcohol_30d_plot), <span class="sc">!</span><span class="fu">is.na</span>(Consumo_tus_plot)) <span class="sc">%&gt;%</span></span>
<span id="cb44-24"><a href="#cb44-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(alcohol_30d_plot, Consumo_tus_plot, <span class="at">name =</span> <span class="st">"Conteo"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb44-25"><a href="#cb44-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">complete</span>(alcohol_30d_plot, Consumo_tus_plot, <span class="at">fill =</span> <span class="fu">list</span>(<span class="at">Conteo =</span> <span class="dv">0</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb44-26"><a href="#cb44-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(alcohol_30d_plot) <span class="sc">%&gt;%</span></span>
<span id="cb44-27"><a href="#cb44-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb44-28"><a href="#cb44-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">Total =</span> <span class="fu">sum</span>(Conteo),</span>
<span id="cb44-29"><a href="#cb44-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">Prop  =</span> <span class="fu">ifelse</span>(Total <span class="sc">==</span> <span class="dv">0</span>, <span class="dv">0</span>, Conteo <span class="sc">/</span> Total),</span>
<span id="cb44-30"><a href="#cb44-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">label_pct =</span> <span class="fu">ifelse</span>(Conteo <span class="sc">==</span> <span class="dv">0</span>, <span class="st">""</span>, <span class="fu">percent</span>(Prop, <span class="at">accuracy =</span> <span class="fl">0.1</span>)),</span>
<span id="cb44-31"><a href="#cb44-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">text =</span> <span class="fu">paste0</span>(</span>
<span id="cb44-32"><a href="#cb44-32" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Consumo alcohol: "</span>, alcohol_30d_plot,</span>
<span id="cb44-33"><a href="#cb44-33" aria-hidden="true" tabindex="-1"></a>      <span class="st">"&lt;br&gt;Consumo tusi: "</span>, Consumo_tus_plot,</span>
<span id="cb44-34"><a href="#cb44-34" aria-hidden="true" tabindex="-1"></a>      <span class="st">"&lt;br&gt;Porcentaje: "</span>, <span class="fu">percent</span>(Prop, <span class="at">accuracy =</span> <span class="fl">0.1</span>),</span>
<span id="cb44-35"><a href="#cb44-35" aria-hidden="true" tabindex="-1"></a>      <span class="st">"&lt;br&gt;n: "</span>, Conteo</span>
<span id="cb44-36"><a href="#cb44-36" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb44-37"><a href="#cb44-37" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb44-38"><a href="#cb44-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb44-39"><a href="#cb44-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-40"><a href="#cb44-40" aria-hidden="true" tabindex="-1"></a><span class="co"># Chequeo</span></span>
<span id="cb44-41"><a href="#cb44-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-42"><a href="#cb44-42" aria-hidden="true" tabindex="-1"></a>df_tusi <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(alcohol_30d_plot) <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="at">suma_prop =</span> <span class="fu">sum</span>(Prop))</span>
<span id="cb44-43"><a href="#cb44-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-44"><a href="#cb44-44" aria-hidden="true" tabindex="-1"></a><span class="co"># Gráfico: siempre suma 100%</span></span>
<span id="cb44-45"><a href="#cb44-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-46"><a href="#cb44-46" aria-hidden="true" tabindex="-1"></a>Grafico_tusi <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df_tusi, <span class="fu">aes</span>(<span class="at">y =</span> alcohol_30d_plot, <span class="at">x =</span> Conteo, <span class="at">fill =</span> Consumo_tus_plot, <span class="at">text =</span> text)) <span class="sc">+</span></span>
<span id="cb44-47"><a href="#cb44-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">position =</span> <span class="st">"fill"</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">width =</span> <span class="fl">0.65</span>) <span class="sc">+</span></span>
<span id="cb44-48"><a href="#cb44-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(</span>
<span id="cb44-49"><a href="#cb44-49" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">label =</span> label_pct),</span>
<span id="cb44-50"><a href="#cb44-50" aria-hidden="true" tabindex="-1"></a>    <span class="at">position =</span> <span class="fu">position_fill</span>(<span class="at">vjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb44-51"><a href="#cb44-51" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"white"</span>,</span>
<span id="cb44-52"><a href="#cb44-52" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">3</span></span>
<span id="cb44-53"><a href="#cb44-53" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb44-54"><a href="#cb44-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">labels =</span> <span class="fu">percent_format</span>(<span class="at">accuracy =</span> <span class="dv">1</span>), <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb44-55"><a href="#cb44-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb44-56"><a href="#cb44-56" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Consumo de tusi según consumo de alcohol (últimos 30 días)"</span>,</span>
<span id="cb44-57"><a href="#cb44-57" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Porcentaje"</span>,</span>
<span id="cb44-58"><a href="#cb44-58" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="cn">NULL</span>,</span>
<span id="cb44-59"><a href="#cb44-59" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"Consumo de tusi"</span></span>
<span id="cb44-60"><a href="#cb44-60" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb44-61"><a href="#cb44-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb44-62"><a href="#cb44-62" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>))</span>
<span id="cb44-63"><a href="#cb44-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-64"><a href="#cb44-64" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplotly</span>(Grafico_tusi, <span class="at">tooltip =</span> <span class="st">"text"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>En el grupo de personas que no consume alcohol en los últimos 30 días, prácticamente la totalidad declara no consumir tusi (100,0%), mientras que el consumo aparece como 0,0%.</p>
<p>Por su parte, entre quienes sí consumen alcohol, el 99,8% señala no consumir tusi y el 0,2% indica que sí consume. En general, el consumo de tusi es muy bajo en ambos grupos, observándose una presencia levemente mayor entre quienes consumen alcohol.</p>
<p><strong>Salud general y mental según consumo de alcohol (I)</strong></p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Etiquetas para las variables</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>labels_vars <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>  <span class="st">"salud_general"</span> <span class="ot">=</span> <span class="st">"Percepción de estado de salud general"</span>,</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">"sm_sueno"</span> <span class="ot">=</span> <span class="st">"¿Sus preocupaciones le han hecho perder mucho sueño?"</span>,</span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>  <span class="st">"sm_agobiado"</span> <span class="ot">=</span> <span class="st">"¿Se ha sentido constantemente agobiado/a o en tensión?"</span>,</span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>  <span class="st">"sm_frustracion"</span> <span class="ot">=</span> <span class="st">"¿Ha sentido que no puede superar sus dificultades?"</span>,</span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>  <span class="st">"sm_depresion"</span> <span class="ot">=</span> <span class="st">"¿Se ha sentido poco feliz y deprimido/a?"</span>,</span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a>  <span class="st">"sm_confianza"</span> <span class="ot">=</span> <span class="st">"¿Ha perdido confianza en sí mismo/a?"</span>,</span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a>  <span class="st">"sm_valía_moral"</span> <span class="ot">=</span> <span class="st">"¿Ha pensado que usted es una persona que no vale para nada?"</span></span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Orden </span></span>
<span id="cb45-13"><a href="#cb45-13" aria-hidden="true" tabindex="-1"></a>orden_vars <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb45-14"><a href="#cb45-14" aria-hidden="true" tabindex="-1"></a>  <span class="st">"salud_general"</span>,</span>
<span id="cb45-15"><a href="#cb45-15" aria-hidden="true" tabindex="-1"></a>  <span class="st">"sm_sueno"</span>,</span>
<span id="cb45-16"><a href="#cb45-16" aria-hidden="true" tabindex="-1"></a>  <span class="st">"sm_agobiado"</span>,</span>
<span id="cb45-17"><a href="#cb45-17" aria-hidden="true" tabindex="-1"></a>  <span class="st">"sm_frustracion"</span>,</span>
<span id="cb45-18"><a href="#cb45-18" aria-hidden="true" tabindex="-1"></a>  <span class="st">"sm_depresion"</span>,</span>
<span id="cb45-19"><a href="#cb45-19" aria-hidden="true" tabindex="-1"></a>  <span class="st">"sm_confianza"</span>,</span>
<span id="cb45-20"><a href="#cb45-20" aria-hidden="true" tabindex="-1"></a>  <span class="st">"sm_valía_moral"</span></span>
<span id="cb45-21"><a href="#cb45-21" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb45-22"><a href="#cb45-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-23"><a href="#cb45-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-24"><a href="#cb45-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Media, DE, Mediana y N° por grupo </span></span>
<span id="cb45-25"><a href="#cb45-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-26"><a href="#cb45-26" aria-hidden="true" tabindex="-1"></a>descriptivos_sm_alcohol <span class="ot">&lt;-</span> ENPG_filtrado <span class="sc">%&gt;%</span></span>
<span id="cb45-27"><a href="#cb45-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(alcohol_30d, salud_general, <span class="fu">starts_with</span>(<span class="st">"sm_"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb45-28"><a href="#cb45-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb45-29"><a href="#cb45-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">cols =</span> <span class="fu">c</span>(salud_general, <span class="fu">starts_with</span>(<span class="st">"sm_"</span>)),</span>
<span id="cb45-30"><a href="#cb45-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_to =</span> <span class="st">"Variable"</span>,</span>
<span id="cb45-31"><a href="#cb45-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_to =</span> <span class="st">"Valor"</span></span>
<span id="cb45-32"><a href="#cb45-32" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb45-33"><a href="#cb45-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb45-34"><a href="#cb45-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">Variable =</span> <span class="fu">factor</span>(Variable, <span class="at">levels =</span> orden_vars),</span>
<span id="cb45-35"><a href="#cb45-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">Etiqueta =</span> <span class="fu">recode</span>(<span class="fu">as.character</span>(Variable), <span class="sc">!!!</span>labels_vars)</span>
<span id="cb45-36"><a href="#cb45-36" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb45-37"><a href="#cb45-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(alcohol_30d, Etiqueta) <span class="sc">%&gt;%</span></span>
<span id="cb45-38"><a href="#cb45-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb45-39"><a href="#cb45-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">N =</span> <span class="fu">sum</span>(<span class="sc">!</span><span class="fu">is.na</span>(Valor)),</span>
<span id="cb45-40"><a href="#cb45-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">Media =</span> <span class="fu">mean</span>(Valor, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb45-41"><a href="#cb45-41" aria-hidden="true" tabindex="-1"></a>    <span class="at">DE =</span> <span class="fu">sd</span>(Valor, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb45-42"><a href="#cb45-42" aria-hidden="true" tabindex="-1"></a>    <span class="at">Mediana =</span> <span class="fu">median</span>(Valor, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb45-43"><a href="#cb45-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb45-44"><a href="#cb45-44" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb45-45"><a href="#cb45-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-46"><a href="#cb45-46" aria-hidden="true" tabindex="-1"></a>descriptivos_sm_alcohol</span>
<span id="cb45-47"><a href="#cb45-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-48"><a href="#cb45-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-49"><a href="#cb45-49" aria-hidden="true" tabindex="-1"></a><span class="co"># Tabla comparativa </span></span>
<span id="cb45-50"><a href="#cb45-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-51"><a href="#cb45-51" aria-hidden="true" tabindex="-1"></a>tabla_sm_alcohol <span class="ot">&lt;-</span> descriptivos_sm_alcohol <span class="sc">%&gt;%</span></span>
<span id="cb45-52"><a href="#cb45-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(</span>
<span id="cb45-53"><a href="#cb45-53" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_from =</span> alcohol_30d,</span>
<span id="cb45-54"><a href="#cb45-54" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_from =</span> <span class="fu">c</span>(Media, DE, N),</span>
<span id="cb45-55"><a href="#cb45-55" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_glue =</span> <span class="st">"{.value}_{alcohol_30d}"</span></span>
<span id="cb45-56"><a href="#cb45-56" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb45-57"><a href="#cb45-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-58"><a href="#cb45-58" aria-hidden="true" tabindex="-1"></a>tabla_sm_alcohol</span>
<span id="cb45-59"><a href="#cb45-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-60"><a href="#cb45-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-61"><a href="#cb45-61" aria-hidden="true" tabindex="-1"></a><span class="co"># Gráfico de medias (incluye ST_1 + etiquetas bonitas)</span></span>
<span id="cb45-62"><a href="#cb45-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-63"><a href="#cb45-63" aria-hidden="true" tabindex="-1"></a>ENPG_filtrado <span class="sc">%&gt;%</span></span>
<span id="cb45-64"><a href="#cb45-64" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(alcohol_30d, salud_general, <span class="fu">starts_with</span>(<span class="st">"sm_"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb45-65"><a href="#cb45-65" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb45-66"><a href="#cb45-66" aria-hidden="true" tabindex="-1"></a>    <span class="at">cols =</span> <span class="fu">c</span>(salud_general, <span class="fu">starts_with</span>(<span class="st">"sm_"</span>)),</span>
<span id="cb45-67"><a href="#cb45-67" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_to =</span> <span class="st">"Variable"</span>,</span>
<span id="cb45-68"><a href="#cb45-68" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_to =</span> <span class="st">"Valor"</span></span>
<span id="cb45-69"><a href="#cb45-69" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb45-70"><a href="#cb45-70" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(alcohol_30d), <span class="sc">!</span><span class="fu">is.na</span>(Valor)) <span class="sc">%&gt;%</span></span>
<span id="cb45-71"><a href="#cb45-71" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb45-72"><a href="#cb45-72" aria-hidden="true" tabindex="-1"></a>    <span class="at">Variable =</span> <span class="fu">factor</span>(Variable, <span class="at">levels =</span> orden_vars),</span>
<span id="cb45-73"><a href="#cb45-73" aria-hidden="true" tabindex="-1"></a>    <span class="at">Variable_lab =</span> <span class="fu">recode</span>(<span class="fu">as.character</span>(Variable), <span class="sc">!!!</span>labels_vars)</span>
<span id="cb45-74"><a href="#cb45-74" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb45-75"><a href="#cb45-75" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(alcohol_30d, Variable_lab) <span class="sc">%&gt;%</span></span>
<span id="cb45-76"><a href="#cb45-76" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb45-77"><a href="#cb45-77" aria-hidden="true" tabindex="-1"></a>    <span class="at">Media =</span> <span class="fu">mean</span>(Valor, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb45-78"><a href="#cb45-78" aria-hidden="true" tabindex="-1"></a>    <span class="at">SD =</span> <span class="fu">sd</span>(Valor, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb45-79"><a href="#cb45-79" aria-hidden="true" tabindex="-1"></a>    <span class="at">N =</span> <span class="fu">n</span>(),</span>
<span id="cb45-80"><a href="#cb45-80" aria-hidden="true" tabindex="-1"></a>    <span class="at">SE =</span> SD <span class="sc">/</span> <span class="fu">sqrt</span>(N),</span>
<span id="cb45-81"><a href="#cb45-81" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb45-82"><a href="#cb45-82" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb45-83"><a href="#cb45-83" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Variable_lab, <span class="at">y =</span> Media, <span class="at">fill =</span> alcohol_30d)) <span class="sc">+</span></span>
<span id="cb45-84"><a href="#cb45-84" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.7</span>), <span class="at">width =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb45-85"><a href="#cb45-85" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(</span>
<span id="cb45-86"><a href="#cb45-86" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">ymin =</span> Media <span class="sc">-</span> <span class="fl">1.96</span> <span class="sc">*</span> SE, <span class="at">ymax =</span> Media <span class="sc">+</span> <span class="fl">1.96</span> <span class="sc">*</span> SE),</span>
<span id="cb45-87"><a href="#cb45-87" aria-hidden="true" tabindex="-1"></a>    <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.7</span>),</span>
<span id="cb45-88"><a href="#cb45-88" aria-hidden="true" tabindex="-1"></a>    <span class="at">width =</span> <span class="fl">0.2</span></span>
<span id="cb45-89"><a href="#cb45-89" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb45-90"><a href="#cb45-90" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb45-91"><a href="#cb45-91" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb45-92"><a href="#cb45-92" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Salud mental y salud general según consumo de alcohol (últimos 30 días)"</span>,</span>
<span id="cb45-93"><a href="#cb45-93" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Media e intervalo de confianza 95%"</span>,</span>
<span id="cb45-94"><a href="#cb45-94" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">""</span>,</span>
<span id="cb45-95"><a href="#cb45-95" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Media"</span>,</span>
<span id="cb45-96"><a href="#cb45-96" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"Consumo de alcohol"</span></span>
<span id="cb45-97"><a href="#cb45-97" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb45-98"><a href="#cb45-98" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Capstone-Prueba-F_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>En el gráfico de medias con intervalo de confianza al 95% se observa que, al comparar a quienes sí consumen alcohol versus quienes no consumen, las diferencias tienden a ser más bien acotadas en la mayoría de los indicadores.</p>
<p>En percepción de estado de salud general, el grupo que sí consume alcohol presenta una media levemente más alta que el grupo que no consume. En los ítems de salud mental, se aprecia un patrón mixto: quienes sí consumen alcohol muestran promedios algo mayores en indicadores como pérdida de sueño por preocupaciones y sentirse agobiado/a o en tensión, mientras que en otros (como sentirse poco feliz y deprimido/a, sentir que no puede superar sus dificultades, haber perdido confianza en sí mismo/a y pensar que no vale para nada) las medias aparecen ligeramente más altas entre quienes no consumen alcohol.</p>
<p>En términos generales, los intervalos de confianza se superponen en la mayoría de las variables, lo que sugiere que las diferencias observadas entre grupos son pequeñas, más que brechas amplias en salud mental o salud general asociadas al consumo de alcohol.</p>
<p><strong>Percepción de riesgo según consumo de alcohol</strong></p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Media, Desviación Estandar y N° por grupo</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>descriptivos_riesgo_alcohol <span class="ot">&lt;-</span> ENPG_filtrado <span class="sc">%&gt;%</span> </span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(alcohol_30d, Riesgo_ocasion, Riesgo_diario) <span class="sc">%&gt;%</span> </span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">cols =</span> <span class="fu">c</span>(Riesgo_ocasion, Riesgo_diario),</span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_to =</span> <span class="st">"Variable"</span>,</span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_to =</span> <span class="st">"Valor"</span></span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(alcohol_30d, Variable) <span class="sc">%&gt;%</span> </span>
<span id="cb46-11"><a href="#cb46-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb46-12"><a href="#cb46-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">N =</span> <span class="fu">sum</span>(<span class="sc">!</span><span class="fu">is.na</span>(Valor)),</span>
<span id="cb46-13"><a href="#cb46-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">Media =</span> <span class="fu">mean</span>(Valor, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb46-14"><a href="#cb46-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">DE =</span> <span class="fu">sd</span>(Valor, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb46-15"><a href="#cb46-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">Mediana =</span> <span class="fu">median</span>(Valor, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb46-16"><a href="#cb46-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb46-17"><a href="#cb46-17" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb46-18"><a href="#cb46-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-19"><a href="#cb46-19" aria-hidden="true" tabindex="-1"></a>descriptivos_riesgo_alcohol</span>
<span id="cb46-20"><a href="#cb46-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-21"><a href="#cb46-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-22"><a href="#cb46-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Tabla comparativa</span></span>
<span id="cb46-23"><a href="#cb46-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-24"><a href="#cb46-24" aria-hidden="true" tabindex="-1"></a>tabla_riesgo_alcohol <span class="ot">&lt;-</span> descriptivos_riesgo_alcohol <span class="sc">%&gt;%</span> </span>
<span id="cb46-25"><a href="#cb46-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(</span>
<span id="cb46-26"><a href="#cb46-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_from =</span> alcohol_30d,</span>
<span id="cb46-27"><a href="#cb46-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_from =</span> <span class="fu">c</span>(Media, DE, N),</span>
<span id="cb46-28"><a href="#cb46-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_glue =</span> <span class="st">"{.value}_{alcohol_30d}"</span></span>
<span id="cb46-29"><a href="#cb46-29" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb46-30"><a href="#cb46-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-31"><a href="#cb46-31" aria-hidden="true" tabindex="-1"></a>tabla_riesgo_alcohol</span>
<span id="cb46-32"><a href="#cb46-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-33"><a href="#cb46-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-34"><a href="#cb46-34" aria-hidden="true" tabindex="-1"></a><span class="co"># Gráfico de medias </span></span>
<span id="cb46-35"><a href="#cb46-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-36"><a href="#cb46-36" aria-hidden="true" tabindex="-1"></a>ENPG_filtrado <span class="sc">%&gt;%</span> </span>
<span id="cb46-37"><a href="#cb46-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(alcohol_30d, Riesgo_ocasion, Riesgo_diario) <span class="sc">%&gt;%</span> </span>
<span id="cb46-38"><a href="#cb46-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb46-39"><a href="#cb46-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">cols =</span> <span class="fu">c</span>(Riesgo_ocasion, Riesgo_diario),</span>
<span id="cb46-40"><a href="#cb46-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_to =</span> <span class="st">"Variable"</span>,</span>
<span id="cb46-41"><a href="#cb46-41" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_to =</span> <span class="st">"Valor"</span></span>
<span id="cb46-42"><a href="#cb46-42" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb46-43"><a href="#cb46-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(alcohol_30d), <span class="sc">!</span><span class="fu">is.na</span>(Valor)) <span class="sc">%&gt;%</span> </span>
<span id="cb46-44"><a href="#cb46-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb46-45"><a href="#cb46-45" aria-hidden="true" tabindex="-1"></a>    <span class="at">Variable =</span> <span class="fu">factor</span>(</span>
<span id="cb46-46"><a href="#cb46-46" aria-hidden="true" tabindex="-1"></a>      Variable,</span>
<span id="cb46-47"><a href="#cb46-47" aria-hidden="true" tabindex="-1"></a>      <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Riesgo_ocasion"</span>, <span class="st">"Riesgo_diario"</span>),</span>
<span id="cb46-48"><a href="#cb46-48" aria-hidden="true" tabindex="-1"></a>      <span class="at">labels =</span> <span class="fu">c</span>(</span>
<span id="cb46-49"><a href="#cb46-49" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Toma tres o más tragos por ocasión"</span>,</span>
<span id="cb46-50"><a href="#cb46-50" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Toma cinco o más tragos diariamente"</span></span>
<span id="cb46-51"><a href="#cb46-51" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb46-52"><a href="#cb46-52" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb46-53"><a href="#cb46-53" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb46-54"><a href="#cb46-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(alcohol_30d, Variable) <span class="sc">%&gt;%</span> </span>
<span id="cb46-55"><a href="#cb46-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb46-56"><a href="#cb46-56" aria-hidden="true" tabindex="-1"></a>    <span class="at">Media =</span> <span class="fu">mean</span>(Valor, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb46-57"><a href="#cb46-57" aria-hidden="true" tabindex="-1"></a>    <span class="at">SD =</span> <span class="fu">sd</span>(Valor, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb46-58"><a href="#cb46-58" aria-hidden="true" tabindex="-1"></a>    <span class="at">N =</span> <span class="fu">n</span>(),</span>
<span id="cb46-59"><a href="#cb46-59" aria-hidden="true" tabindex="-1"></a>    <span class="at">SE =</span> SD <span class="sc">/</span> <span class="fu">sqrt</span>(N),</span>
<span id="cb46-60"><a href="#cb46-60" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb46-61"><a href="#cb46-61" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb46-62"><a href="#cb46-62" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Variable, <span class="at">y =</span> Media, <span class="at">fill =</span> alcohol_30d)) <span class="sc">+</span></span>
<span id="cb46-63"><a href="#cb46-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.7</span>), <span class="at">width =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb46-64"><a href="#cb46-64" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(</span>
<span id="cb46-65"><a href="#cb46-65" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">ymin =</span> Media <span class="sc">-</span> <span class="fl">1.96</span> <span class="sc">*</span> SE, <span class="at">ymax =</span> Media <span class="sc">+</span> <span class="fl">1.96</span> <span class="sc">*</span> SE),</span>
<span id="cb46-66"><a href="#cb46-66" aria-hidden="true" tabindex="-1"></a>    <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.7</span>),</span>
<span id="cb46-67"><a href="#cb46-67" aria-hidden="true" tabindex="-1"></a>    <span class="at">width =</span> <span class="fl">0.2</span></span>
<span id="cb46-68"><a href="#cb46-68" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb46-69"><a href="#cb46-69" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb46-70"><a href="#cb46-70" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb46-71"><a href="#cb46-71" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Percepción de riesgo según consumo de alcohol (últimos 30 días)"</span>,</span>
<span id="cb46-72"><a href="#cb46-72" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Media e intervalo de confianza 95%"</span>,</span>
<span id="cb46-73"><a href="#cb46-73" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">""</span>,</span>
<span id="cb46-74"><a href="#cb46-74" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Media"</span>,</span>
<span id="cb46-75"><a href="#cb46-75" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"Consumo de alcohol"</span></span>
<span id="cb46-76"><a href="#cb46-76" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb46-77"><a href="#cb46-77" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Capstone-Prueba-F_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>En el gráfico de percepción de riesgo (media e intervalo de confianza al 95%) se observan diferencias claras según consumo de alcohol en los últimos 30 días. En ambos indicadores —“toma tres o más tragos por ocasión” y “toma cinco o más tragos diariamente”—, las personas que no consumen alcohol presentan medias más altas de percepción de riesgo que quienes sí consumen.</p>
<p>En particular, para toma tres o más tragos por ocasión, el grupo que no consume se ubica cerca de 5 puntos, mientras que el grupo que sí consume se ubica alrededor de 4 puntos. Un patrón similar se observa en toma cinco o más tragos diariamente, donde nuevamente la percepción de riesgo es mayor entre quienes no consumen alcohol.</p>
<p>Además, los intervalos de confianza de ambos grupos aparecen con poca superposición, lo que sugiere que estas diferencias no serían solo pequeñas variaciones, sino que podrían reflejar una brecha consistente en la percepción de riesgo: quienes consumen alcohol tienden a normalizar o percibir como menos riesgoso el consumo intensivo (por ocasión o diario), en comparación con quienes no consumen.</p>
<p><strong>Correlaciones de variables cuantitativas</strong></p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Armar base para correlaciones + NA codes</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>df_cor <span class="ot">&lt;-</span> ENPG_filtrado <span class="sc">%&gt;%</span></span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transmute</span>(</span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">Riesgo_ocasion =</span> <span class="fu">as.numeric</span>(<span class="fu">na_if</span>(Riesgo_ocasion, <span class="dv">88</span>)),              </span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">Riesgo_diario  =</span> <span class="fu">as.numeric</span>(<span class="fu">na_if</span>(Riesgo_diario, <span class="dv">88</span>)),                </span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">salud_general  =</span> <span class="fu">as.numeric</span>(<span class="fu">ifelse</span>(salud_general <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">88</span>, <span class="dv">99</span>), <span class="cn">NA</span>, salud_general)), </span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">sm_sueno       =</span> <span class="fu">as.numeric</span>(sm_sueno),</span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">sm_agobiado    =</span> <span class="fu">as.numeric</span>(sm_agobiado),</span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">sm_frustracion =</span> <span class="fu">as.numeric</span>(sm_frustracion),</span>
<span id="cb47-12"><a href="#cb47-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">sm_depresion   =</span> <span class="fu">as.numeric</span>(sm_depresion),</span>
<span id="cb47-13"><a href="#cb47-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">sm_confianza   =</span> <span class="fu">as.numeric</span>(sm_confianza),</span>
<span id="cb47-14"><a href="#cb47-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">sm_valia_moral =</span> <span class="fu">as.numeric</span>(<span class="st">`</span><span class="at">sm_valía_moral</span><span class="st">`</span>)  </span>
<span id="cb47-15"><a href="#cb47-15" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb47-16"><a href="#cb47-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-17"><a href="#cb47-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-18"><a href="#cb47-18" aria-hidden="true" tabindex="-1"></a><span class="co"># 2Correlaciones Spearman + p-values + N</span></span>
<span id="cb47-19"><a href="#cb47-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-20"><a href="#cb47-20" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> Hmisc<span class="sc">::</span><span class="fu">rcorr</span>(<span class="fu">as.matrix</span>(df_cor), <span class="at">type =</span> <span class="st">"spearman"</span>)</span>
<span id="cb47-21"><a href="#cb47-21" aria-hidden="true" tabindex="-1"></a>mat_cor <span class="ot">&lt;-</span> res<span class="sc">$</span>r</span>
<span id="cb47-22"><a href="#cb47-22" aria-hidden="true" tabindex="-1"></a>mat_p   <span class="ot">&lt;-</span> res<span class="sc">$</span>P</span>
<span id="cb47-23"><a href="#cb47-23" aria-hidden="true" tabindex="-1"></a>mat_n   <span class="ot">&lt;-</span> res<span class="sc">$</span>n</span>
<span id="cb47-24"><a href="#cb47-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-25"><a href="#cb47-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-26"><a href="#cb47-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Preparar datos para heatmap + etiquetas</span></span>
<span id="cb47-27"><a href="#cb47-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-28"><a href="#cb47-28" aria-hidden="true" tabindex="-1"></a>labels_vars <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb47-29"><a href="#cb47-29" aria-hidden="true" tabindex="-1"></a>  <span class="at">Riesgo_ocasion =</span> <span class="st">"Riesgo: 3+ tragos por ocasión"</span>,</span>
<span id="cb47-30"><a href="#cb47-30" aria-hidden="true" tabindex="-1"></a>  <span class="at">Riesgo_diario  =</span> <span class="st">"Riesgo: 5+ tragos diariamente"</span>,</span>
<span id="cb47-31"><a href="#cb47-31" aria-hidden="true" tabindex="-1"></a>  <span class="at">salud_general  =</span> <span class="st">"Percepción de salud general"</span>,</span>
<span id="cb47-32"><a href="#cb47-32" aria-hidden="true" tabindex="-1"></a>  <span class="at">sm_sueno       =</span> <span class="st">"Pierde sueño por preocupaciones"</span>,</span>
<span id="cb47-33"><a href="#cb47-33" aria-hidden="true" tabindex="-1"></a>  <span class="at">sm_agobiado    =</span> <span class="st">"Se siente agobiado/a o en tensión"</span>,</span>
<span id="cb47-34"><a href="#cb47-34" aria-hidden="true" tabindex="-1"></a>  <span class="at">sm_frustracion =</span> <span class="st">"No puede superar dificultades"</span>,</span>
<span id="cb47-35"><a href="#cb47-35" aria-hidden="true" tabindex="-1"></a>  <span class="at">sm_depresion   =</span> <span class="st">"Poco feliz y deprimido/a"</span>,</span>
<span id="cb47-36"><a href="#cb47-36" aria-hidden="true" tabindex="-1"></a>  <span class="at">sm_confianza   =</span> <span class="st">"Pierde confianza en sí mismo/a"</span>,</span>
<span id="cb47-37"><a href="#cb47-37" aria-hidden="true" tabindex="-1"></a>  <span class="at">sm_valia_moral =</span> <span class="st">"Siente que no vale nada"</span></span>
<span id="cb47-38"><a href="#cb47-38" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb47-39"><a href="#cb47-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-40"><a href="#cb47-40" aria-hidden="true" tabindex="-1"></a>df_heat <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(mat_cor) <span class="sc">%&gt;%</span></span>
<span id="cb47-41"><a href="#cb47-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames_to_column</span>(<span class="st">"Var1"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb47-42"><a href="#cb47-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">-</span>Var1, <span class="at">names_to =</span> <span class="st">"Var2"</span>, <span class="at">values_to =</span> <span class="st">"r"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb47-43"><a href="#cb47-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(</span>
<span id="cb47-44"><a href="#cb47-44" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.data.frame</span>(mat_p) <span class="sc">%&gt;%</span></span>
<span id="cb47-45"><a href="#cb47-45" aria-hidden="true" tabindex="-1"></a>      <span class="fu">rownames_to_column</span>(<span class="st">"Var1"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb47-46"><a href="#cb47-46" aria-hidden="true" tabindex="-1"></a>      <span class="fu">pivot_longer</span>(<span class="sc">-</span>Var1, <span class="at">names_to =</span> <span class="st">"Var2"</span>, <span class="at">values_to =</span> <span class="st">"p"</span>),</span>
<span id="cb47-47"><a href="#cb47-47" aria-hidden="true" tabindex="-1"></a>    <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"Var1"</span>, <span class="st">"Var2"</span>)</span>
<span id="cb47-48"><a href="#cb47-48" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb47-49"><a href="#cb47-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(</span>
<span id="cb47-50"><a href="#cb47-50" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.data.frame</span>(mat_n) <span class="sc">%&gt;%</span></span>
<span id="cb47-51"><a href="#cb47-51" aria-hidden="true" tabindex="-1"></a>      <span class="fu">rownames_to_column</span>(<span class="st">"Var1"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb47-52"><a href="#cb47-52" aria-hidden="true" tabindex="-1"></a>      <span class="fu">pivot_longer</span>(<span class="sc">-</span>Var1, <span class="at">names_to =</span> <span class="st">"Var2"</span>, <span class="at">values_to =</span> <span class="st">"n"</span>),</span>
<span id="cb47-53"><a href="#cb47-53" aria-hidden="true" tabindex="-1"></a>    <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"Var1"</span>, <span class="st">"Var2"</span>)</span>
<span id="cb47-54"><a href="#cb47-54" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb47-55"><a href="#cb47-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb47-56"><a href="#cb47-56" aria-hidden="true" tabindex="-1"></a>    <span class="at">Var1_lab =</span> <span class="fu">recode</span>(Var1, <span class="sc">!!!</span>labels_vars),</span>
<span id="cb47-57"><a href="#cb47-57" aria-hidden="true" tabindex="-1"></a>    <span class="at">Var2_lab =</span> <span class="fu">recode</span>(Var2, <span class="sc">!!!</span>labels_vars),</span>
<span id="cb47-58"><a href="#cb47-58" aria-hidden="true" tabindex="-1"></a>    <span class="at">sig =</span> <span class="fu">case_when</span>(</span>
<span id="cb47-59"><a href="#cb47-59" aria-hidden="true" tabindex="-1"></a>      <span class="fu">is.na</span>(p) <span class="sc">~</span> <span class="st">""</span>,</span>
<span id="cb47-60"><a href="#cb47-60" aria-hidden="true" tabindex="-1"></a>      p <span class="sc">&lt;</span> <span class="fl">0.001</span> <span class="sc">~</span> <span class="st">"***"</span>,</span>
<span id="cb47-61"><a href="#cb47-61" aria-hidden="true" tabindex="-1"></a>      p <span class="sc">&lt;</span> <span class="fl">0.01</span>  <span class="sc">~</span> <span class="st">"**"</span>,</span>
<span id="cb47-62"><a href="#cb47-62" aria-hidden="true" tabindex="-1"></a>      p <span class="sc">&lt;</span> <span class="fl">0.05</span>  <span class="sc">~</span> <span class="st">"*"</span>,</span>
<span id="cb47-63"><a href="#cb47-63" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">""</span></span>
<span id="cb47-64"><a href="#cb47-64" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb47-65"><a href="#cb47-65" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb47-66"><a href="#cb47-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-67"><a href="#cb47-67" aria-hidden="true" tabindex="-1"></a><span class="co"># Heatmap </span></span>
<span id="cb47-68"><a href="#cb47-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-69"><a href="#cb47-69" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df_heat, <span class="fu">aes</span>(<span class="at">x =</span> Var2_lab, <span class="at">y =</span> Var1_lab, <span class="at">fill =</span> r)) <span class="sc">+</span></span>
<span id="cb47-70"><a href="#cb47-70" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>(<span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb47-71"><a href="#cb47-71" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">sprintf</span>(<span class="st">"%.2f%s"</span>, r, sig)), <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb47-72"><a href="#cb47-72" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient2</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>), <span class="at">midpoint =</span> <span class="dv">0</span>, <span class="at">name =</span> <span class="st">"Spearman ρ"</span>) <span class="sc">+</span></span>
<span id="cb47-73"><a href="#cb47-73" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_fixed</span>() <span class="sc">+</span></span>
<span id="cb47-74"><a href="#cb47-74" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb47-75"><a href="#cb47-75" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Matriz de correlaciones (Spearman)"</span>,</span>
<span id="cb47-76"><a href="#cb47-76" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Likert/ordinal. *** p&lt;0.001, ** p&lt;0.01, * p&lt;0.05"</span>,</span>
<span id="cb47-77"><a href="#cb47-77" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="cn">NULL</span>, <span class="at">y =</span> <span class="cn">NULL</span></span>
<span id="cb47-78"><a href="#cb47-78" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb47-79"><a href="#cb47-79" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb47-80"><a href="#cb47-80" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb47-81"><a href="#cb47-81" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb47-82"><a href="#cb47-82" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>)</span>
<span id="cb47-83"><a href="#cb47-83" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb47-84"><a href="#cb47-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-85"><a href="#cb47-85" aria-hidden="true" tabindex="-1"></a><span class="co"># Mostrar en pantalla</span></span>
<span id="cb47-86"><a href="#cb47-86" aria-hidden="true" tabindex="-1"></a>p</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Capstone-Prueba-F_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Guardar en PNG grande </span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"matriz_correlaciones_spearman.png"</span>, p, <span class="at">width =</span> <span class="dv">14</span>, <span class="at">height =</span> <span class="dv">10</span>, <span class="at">dpi =</span> <span class="dv">300</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>La matriz de correlaciones muestra, en términos generales dos patrones. Por un lado, los indicadores de salud mental presentan correlaciones positivas de magnitud moderada a relativamente alta (en varios casos sobre 0,5), lo que sugiere que tienden a moverse en conjunto. Las asociaciones más fuertes se observan entre “pierde confianza en sí mismo/a” y “siente que no vale nada” (ρ≈0,69), entre “poco feliz y deprimido/a” y “pierde confianza” (ρ≈0,67), y entre “se siente agobiado/a o en tensión” y “pierde sueño por preocupaciones” (ρ≈0,64). Además, “no puede superar dificultades” se relaciona de manera consistente con el resto de los ítems (por ejemplo con “poco feliz y deprimido/a” ρ≈0,64 y con “pierde confianza” ρ≈0,62), lo que da cuenta de un bloque de malestar psicológico relativamente cohesionado.</p>
<p>Por otro lado, las variables de percepción de riesgo (tanto “toma 3+ tragos por ocasión” como “toma 5+ diariamente”) muestran correlaciones muy bajas con los indicadores de salud mental y con salud general (valores cercanos a 0; aunque algunas aparecen significativas, su magnitud es mínima). Entre ellas sí se observa una asociación positiva baja (ρ≈0,33) entre ambos ítems de riesgo, lo que indica que capturan dimensiones relacionadas, pero no idénticas. Finalmente, la percepción de salud general se asocia de forma débil con los ítems de salud mental (aprox. ρ≈0,15 a 0,27), lo que sugiere relación, pero de baja intensidad.</p>
</section>
<section id="análisis-predictivo-regresión-logística" class="level2" data-number="8">
<h2 data-number="8" class="anchored" data-anchor-id="análisis-predictivo-regresión-logística"><span class="header-section-number">8</span> Análisis predictivo: Regresión Logística</h2>
<p>La regresión logística es especialmente útil para estudiar fenómenos como el consumo de alcohol porque, en este caso, la variable dependiente es dicotómica: solo puede tomar dos valores (haber consumido o no alcohol en los últimos 30 días). Este tipo de modelo permite estimar la probabilidad de que ocurra una de esas dos situaciones a partir de una o más variables explicativas, las cuales pueden ser numéricas o categóricas.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Para modelo Logit</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a><span class="co">#Instalar  librería</span></span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tibble)</span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Preprocesamiento y transformación de variables</span></span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a>ENPG_filtrado <span class="ot">&lt;-</span> ENPG_filtrado <span class="sc">%&gt;%</span> </span>
<span id="cb49-12"><a href="#cb49-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb49-13"><a href="#cb49-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">genero =</span> <span class="fu">factor</span>(genero),</span>
<span id="cb49-14"><a href="#cb49-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">pueblo_ind =</span> <span class="fu">factor</span>(pueblo_ind),</span>
<span id="cb49-15"><a href="#cb49-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">religion =</span> <span class="fu">factor</span>(religion),</span>
<span id="cb49-16"><a href="#cb49-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">educacion_med =</span> <span class="fu">factor</span>(educacion_med),</span>
<span id="cb49-17"><a href="#cb49-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">Consumo_mar =</span> <span class="fu">factor</span>(Consumo_mar),</span>
<span id="cb49-18"><a href="#cb49-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">Consumo_coc =</span> <span class="fu">factor</span>(Consumo_coc),</span>
<span id="cb49-19"><a href="#cb49-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">Consumo_pb =</span> <span class="fu">factor</span>(Consumo_pb),</span>
<span id="cb49-20"><a href="#cb49-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">Consumo_tus =</span> <span class="fu">factor</span>(Consumo_tus),</span>
<span id="cb49-21"><a href="#cb49-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">Consumo_cigarros =</span> <span class="fu">factor</span>(Consumo_cigarros),</span>
<span id="cb49-22"><a href="#cb49-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">EDAD =</span> <span class="fu">as.numeric</span>(EDAD),</span>
<span id="cb49-23"><a href="#cb49-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">Riesgo_diario_rec =</span> <span class="fu">factor</span>(Riesgo_diario_rec),</span>
<span id="cb49-24"><a href="#cb49-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">Riesgo_ocasion_rec =</span> <span class="fu">factor</span>(Riesgo_ocasion_rec),</span>
<span id="cb49-25"><a href="#cb49-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">trabaja_o_no =</span> <span class="fu">factor</span>(trabaja_o_no),</span>
<span id="cb49-26"><a href="#cb49-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">cargo_trabajo =</span> <span class="fu">factor</span>(cargo_trabajo),</span>
<span id="cb49-27"><a href="#cb49-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">salud_general =</span> <span class="fu">factor</span>(salud_general),</span>
<span id="cb49-28"><a href="#cb49-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">estado_civil =</span> <span class="fu">factor</span>(estado_civil),</span>
<span id="cb49-29"><a href="#cb49-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">sm_sueno =</span> <span class="fu">as.numeric</span>(sm_sueno),</span>
<span id="cb49-30"><a href="#cb49-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">sm_agobiado =</span> <span class="fu">as.numeric</span>(sm_agobiado),</span>
<span id="cb49-31"><a href="#cb49-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">sm_depresion =</span> <span class="fu">as.numeric</span>(sm_depresion),</span>
<span id="cb49-32"><a href="#cb49-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">sm_confianza =</span> <span class="fu">as.numeric</span>(sm_confianza),</span>
<span id="cb49-33"><a href="#cb49-33" aria-hidden="true" tabindex="-1"></a>    sm_valía<span class="at">_moral =</span> <span class="fu">as.numeric</span>(sm_valía_moral),</span>
<span id="cb49-34"><a href="#cb49-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">sm_frustracion =</span> <span class="fu">as.numeric</span>(sm_frustracion)</span>
<span id="cb49-35"><a href="#cb49-35" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb49-36"><a href="#cb49-36" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb49-37"><a href="#cb49-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-38"><a href="#cb49-38" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Construcción de la base analítica del modelo</span></span>
<span id="cb49-39"><a href="#cb49-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-40"><a href="#cb49-40" aria-hidden="true" tabindex="-1"></a>base_logit <span class="ot">&lt;-</span> ENPG_filtrado <span class="sc">%&gt;%</span> </span>
<span id="cb49-41"><a href="#cb49-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(</span>
<span id="cb49-42"><a href="#cb49-42" aria-hidden="true" tabindex="-1"></a>    alcohol_30d,</span>
<span id="cb49-43"><a href="#cb49-43" aria-hidden="true" tabindex="-1"></a>    EDAD, genero, pueblo_ind, religion,</span>
<span id="cb49-44"><a href="#cb49-44" aria-hidden="true" tabindex="-1"></a>    educacion_med,</span>
<span id="cb49-45"><a href="#cb49-45" aria-hidden="true" tabindex="-1"></a>    Consumo_mar, Consumo_coc, Consumo_pb, Consumo_tus, Riesgo_diario_rec,</span>
<span id="cb49-46"><a href="#cb49-46" aria-hidden="true" tabindex="-1"></a>    Riesgo_ocasion_rec, sm_sueno, sm_confianza, sm_agobiado, sm_depresion, </span>
<span id="cb49-47"><a href="#cb49-47" aria-hidden="true" tabindex="-1"></a>    sm_valía_moral, sm_frustracion, salud_general, estado_civil, </span>
<span id="cb49-48"><a href="#cb49-48" aria-hidden="true" tabindex="-1"></a>    Consumo_cigarros, cargo_trabajo, trabaja_o_no</span>
<span id="cb49-49"><a href="#cb49-49" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb49-50"><a href="#cb49-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">na.omit</span>()</span>
<span id="cb49-51"><a href="#cb49-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-52"><a href="#cb49-52" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Recodificación de la variable dependiente</span></span>
<span id="cb49-53"><a href="#cb49-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-54"><a href="#cb49-54" aria-hidden="true" tabindex="-1"></a><span class="co"># La variable dependiente (consumo de alcohol en los últimos 30 días)</span></span>
<span id="cb49-55"><a href="#cb49-55" aria-hidden="true" tabindex="-1"></a><span class="co"># se recodifica en formato binario:</span></span>
<span id="cb49-56"><a href="#cb49-56" aria-hidden="true" tabindex="-1"></a><span class="co"># 1 = ha consumido alcohol</span></span>
<span id="cb49-57"><a href="#cb49-57" aria-hidden="true" tabindex="-1"></a><span class="co"># 0 = no ha consumido alcohol</span></span>
<span id="cb49-58"><a href="#cb49-58" aria-hidden="true" tabindex="-1"></a><span class="co"># Esta transformación es necesaria para la estimación del modelo Logit.</span></span>
<span id="cb49-59"><a href="#cb49-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-60"><a href="#cb49-60" aria-hidden="true" tabindex="-1"></a>base_logit <span class="ot">&lt;-</span> base_logit <span class="sc">%&gt;%</span> </span>
<span id="cb49-61"><a href="#cb49-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb49-62"><a href="#cb49-62" aria-hidden="true" tabindex="-1"></a>    <span class="at">alcohol_30d =</span> <span class="fu">ifelse</span>(alcohol_30d <span class="sc">==</span> <span class="st">"Sí"</span>, <span class="dv">1</span>,</span>
<span id="cb49-63"><a href="#cb49-63" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">ifelse</span>(alcohol_30d <span class="sc">==</span> <span class="st">"No"</span>, <span class="dv">0</span>, <span class="cn">NA</span>)), </span>
<span id="cb49-64"><a href="#cb49-64" aria-hidden="true" tabindex="-1"></a>    <span class="at">EDAD =</span> <span class="fu">as.numeric</span>(EDAD), <span class="at">Riesgo_diario_rec =</span> <span class="fu">as.numeric</span>(Riesgo_diario_rec), </span>
<span id="cb49-65"><a href="#cb49-65" aria-hidden="true" tabindex="-1"></a>    <span class="at">Riesgo_ocasion_rec =</span> <span class="fu">as.numeric</span>(Riesgo_ocasion_rec)</span>
<span id="cb49-66"><a href="#cb49-66" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb49-67"><a href="#cb49-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-68"><a href="#cb49-68" aria-hidden="true" tabindex="-1"></a><span class="co"># 4. Especificación y estimación del modelo logit</span></span>
<span id="cb49-69"><a href="#cb49-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-70"><a href="#cb49-70" aria-hidden="true" tabindex="-1"></a>modelo_logit <span class="ot">&lt;-</span> <span class="fu">glm</span>(</span>
<span id="cb49-71"><a href="#cb49-71" aria-hidden="true" tabindex="-1"></a>  alcohol_30d <span class="sc">~</span> EDAD <span class="sc">+</span> genero <span class="sc">+</span> pueblo_ind <span class="sc">+</span> religion <span class="sc">+</span></span>
<span id="cb49-72"><a href="#cb49-72" aria-hidden="true" tabindex="-1"></a>    educacion_med <span class="sc">+</span></span>
<span id="cb49-73"><a href="#cb49-73" aria-hidden="true" tabindex="-1"></a>    Consumo_mar <span class="sc">+</span> Consumo_coc <span class="sc">+</span> Consumo_pb <span class="sc">+</span> Consumo_tus <span class="sc">+</span></span>
<span id="cb49-74"><a href="#cb49-74" aria-hidden="true" tabindex="-1"></a>    Riesgo_diario_rec <span class="sc">+</span> Riesgo_ocasion_rec <span class="sc">+</span> sm_sueno <span class="sc">+</span> sm_confianza <span class="sc">+</span> sm_agobiado </span>
<span id="cb49-75"><a href="#cb49-75" aria-hidden="true" tabindex="-1"></a>  <span class="sc">+</span> sm_depresion <span class="sc">+</span> sm_valía_moral <span class="sc">+</span> sm_frustracion <span class="sc">+</span> salud_general <span class="sc">+</span> estado_civil <span class="sc">+</span> </span>
<span id="cb49-76"><a href="#cb49-76" aria-hidden="true" tabindex="-1"></a>    Consumo_cigarros <span class="sc">+</span> cargo_trabajo <span class="sc">+</span> trabaja_o_no,</span>
<span id="cb49-77"><a href="#cb49-77" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> base_logit,</span>
<span id="cb49-78"><a href="#cb49-78" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">"logit"</span>),</span>
<span id="cb49-79"><a href="#cb49-79" aria-hidden="true" tabindex="-1"></a>  <span class="at">na.action =</span> na.exclude</span>
<span id="cb49-80"><a href="#cb49-80" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb49-81"><a href="#cb49-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-82"><a href="#cb49-82" aria-hidden="true" tabindex="-1"></a><span class="co"># 5. Obtención e interpretación de Coeficientes</span></span>
<span id="cb49-83"><a href="#cb49-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-84"><a href="#cb49-84" aria-hidden="true" tabindex="-1"></a><span class="co"># Los coeficientes del modelo se transforman a odds ratios</span></span>
<span id="cb49-85"><a href="#cb49-85" aria-hidden="true" tabindex="-1"></a><span class="co"># mediante su exponenciación. Valores mayores a 1 indican</span></span>
<span id="cb49-86"><a href="#cb49-86" aria-hidden="true" tabindex="-1"></a><span class="co"># mayor probabilidad de consumo de alcohol, mientras que</span></span>
<span id="cb49-87"><a href="#cb49-87" aria-hidden="true" tabindex="-1"></a><span class="co"># valores menores a 1 sugieren un efecto protector.</span></span>
<span id="cb49-88"><a href="#cb49-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-89"><a href="#cb49-89" aria-hidden="true" tabindex="-1"></a>coeficientes <span class="ot">&lt;-</span> <span class="fu">exp</span>(modelo_logit<span class="sc">$</span>coefficients)</span>
<span id="cb49-90"><a href="#cb49-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-91"><a href="#cb49-91" aria-hidden="true" tabindex="-1"></a><span class="co"># Convertir a tibble para mejorar estética</span></span>
<span id="cb49-92"><a href="#cb49-92" aria-hidden="true" tabindex="-1"></a>tabla_coef <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb49-93"><a href="#cb49-93" aria-hidden="true" tabindex="-1"></a>  <span class="at">Variable =</span> <span class="fu">names</span>(coeficientes),</span>
<span id="cb49-94"><a href="#cb49-94" aria-hidden="true" tabindex="-1"></a>  <span class="at">Odds_Ratio =</span> <span class="fu">round</span>(coeficientes, <span class="dv">3</span>)</span>
<span id="cb49-95"><a href="#cb49-95" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb49-96"><a href="#cb49-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-97"><a href="#cb49-97" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(</span>
<span id="cb49-98"><a href="#cb49-98" aria-hidden="true" tabindex="-1"></a>  tabla_coef,</span>
<span id="cb49-99"><a href="#cb49-99" aria-hidden="true" tabindex="-1"></a>  <span class="at">caption =</span> <span class="st">"Coeficientes del modelo Logit (Odds Ratios)"</span>,</span>
<span id="cb49-100"><a href="#cb49-100" aria-hidden="true" tabindex="-1"></a>  <span class="at">align =</span> <span class="fu">c</span>(<span class="st">"l"</span>, <span class="st">"r"</span>)</span>
<span id="cb49-101"><a href="#cb49-101" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<caption>Coeficientes del modelo Logit (Odds Ratios)</caption>
<thead>
<tr class="header">
<th style="text-align: left;">Variable</th>
<th style="text-align: right;">Odds_Ratio</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">0.142</td>
</tr>
<tr class="even">
<td style="text-align: left;">EDAD</td>
<td style="text-align: right;">0.996</td>
</tr>
<tr class="odd">
<td style="text-align: left;">generoMasculino</td>
<td style="text-align: right;">1.719</td>
</tr>
<tr class="even">
<td style="text-align: left;">pueblo_indNo indígena</td>
<td style="text-align: right;">0.892</td>
</tr>
<tr class="odd">
<td style="text-align: left;">religionReligión</td>
<td style="text-align: right;">0.834</td>
</tr>
<tr class="even">
<td style="text-align: left;">educacion_medTiene educación media o superior</td>
<td style="text-align: right;">1.432</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Consumo_marSí</td>
<td style="text-align: right;">3.546</td>
</tr>
<tr class="even">
<td style="text-align: left;">Consumo_cocSí</td>
<td style="text-align: right;">8.001</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Consumo_pbSí</td>
<td style="text-align: right;">2.617</td>
</tr>
<tr class="even">
<td style="text-align: left;">Consumo_tusSí</td>
<td style="text-align: right;">0.571</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Riesgo_diario_rec</td>
<td style="text-align: right;">1.053</td>
</tr>
<tr class="even">
<td style="text-align: left;">Riesgo_ocasion_rec</td>
<td style="text-align: right;">0.774</td>
</tr>
<tr class="odd">
<td style="text-align: left;">sm_sueno</td>
<td style="text-align: right;">1.158</td>
</tr>
<tr class="even">
<td style="text-align: left;">sm_confianza</td>
<td style="text-align: right;">1.023</td>
</tr>
<tr class="odd">
<td style="text-align: left;">sm_agobiado</td>
<td style="text-align: right;">1.136</td>
</tr>
<tr class="even">
<td style="text-align: left;">sm_depresion</td>
<td style="text-align: right;">0.975</td>
</tr>
<tr class="odd">
<td style="text-align: left;">sm_valía_moral</td>
<td style="text-align: right;">0.843</td>
</tr>
<tr class="even">
<td style="text-align: left;">sm_frustracion</td>
<td style="text-align: right;">0.861</td>
</tr>
<tr class="odd">
<td style="text-align: left;">salud_general2</td>
<td style="text-align: right;">2.107</td>
</tr>
<tr class="even">
<td style="text-align: left;">salud_general3</td>
<td style="text-align: right;">2.764</td>
</tr>
<tr class="odd">
<td style="text-align: left;">salud_general4</td>
<td style="text-align: right;">2.752</td>
</tr>
<tr class="even">
<td style="text-align: left;">salud_general5</td>
<td style="text-align: right;">2.964</td>
</tr>
<tr class="odd">
<td style="text-align: left;">salud_general6</td>
<td style="text-align: right;">3.623</td>
</tr>
<tr class="even">
<td style="text-align: left;">estado_civil2</td>
<td style="text-align: right;">1.109</td>
</tr>
<tr class="odd">
<td style="text-align: left;">estado_civil3</td>
<td style="text-align: right;">0.999</td>
</tr>
<tr class="even">
<td style="text-align: left;">estado_civil4</td>
<td style="text-align: right;">0.675</td>
</tr>
<tr class="odd">
<td style="text-align: left;">estado_civil5</td>
<td style="text-align: right;">1.086</td>
</tr>
<tr class="even">
<td style="text-align: left;">estado_civil6</td>
<td style="text-align: right;">1.339</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Consumo_cigarrosSí</td>
<td style="text-align: right;">2.758</td>
</tr>
<tr class="even">
<td style="text-align: left;">cargo_trabajo2</td>
<td style="text-align: right;">1.068</td>
</tr>
<tr class="odd">
<td style="text-align: left;">cargo_trabajo3</td>
<td style="text-align: right;">1.251</td>
</tr>
<tr class="even">
<td style="text-align: left;">cargo_trabajo4</td>
<td style="text-align: right;">1.162</td>
</tr>
<tr class="odd">
<td style="text-align: left;">cargo_trabajo5</td>
<td style="text-align: right;">1.483</td>
</tr>
<tr class="even">
<td style="text-align: left;">cargo_trabajo6</td>
<td style="text-align: right;">0.684</td>
</tr>
<tr class="odd">
<td style="text-align: left;">cargo_trabajo7</td>
<td style="text-align: right;">0.704</td>
</tr>
<tr class="even">
<td style="text-align: left;">cargo_trabajo8</td>
<td style="text-align: right;">1.192</td>
</tr>
<tr class="odd">
<td style="text-align: left;">cargo_trabajo9</td>
<td style="text-align: right;">0.570</td>
</tr>
<tr class="even">
<td style="text-align: left;">trabaja_o_no2</td>
<td style="text-align: right;">1.183</td>
</tr>
</tbody>
</table>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 6. Resumen del modelo </span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Extraer matriz de coeficientes del summary</span></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>tabla_summary <span class="ot">&lt;-</span> <span class="fu">summary</span>(modelo_logit)<span class="sc">$</span>coefficients <span class="sc">%&gt;%</span></span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>  tibble<span class="sc">::</span><span class="fu">rownames_to_column</span>(<span class="st">"Variable"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(</span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">Coeficiente =</span> Estimate,</span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">Error_Estandar =</span> <span class="st">`</span><span class="at">Std. Error</span><span class="st">`</span>,</span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">Estadistico_z =</span> <span class="st">`</span><span class="at">z value</span><span class="st">`</span>,</span>
<span id="cb50-11"><a href="#cb50-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">Valor_p =</span> <span class="st">`</span><span class="at">Pr(&gt;|z|)</span><span class="st">`</span></span>
<span id="cb50-12"><a href="#cb50-12" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb50-13"><a href="#cb50-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb50-14"><a href="#cb50-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">Valor_p =</span> <span class="fu">round</span>(Valor_p, <span class="dv">4</span>),</span>
<span id="cb50-15"><a href="#cb50-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">Coeficiente =</span> <span class="fu">round</span>(Coeficiente, <span class="dv">3</span>),</span>
<span id="cb50-16"><a href="#cb50-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">Error_Estandar =</span> <span class="fu">round</span>(Error_Estandar, <span class="dv">3</span>),</span>
<span id="cb50-17"><a href="#cb50-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">Estadistico_z =</span> <span class="fu">round</span>(Estadistico_z, <span class="dv">3</span>)</span>
<span id="cb50-18"><a href="#cb50-18" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb50-19"><a href="#cb50-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-20"><a href="#cb50-20" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(</span>
<span id="cb50-21"><a href="#cb50-21" aria-hidden="true" tabindex="-1"></a>  tabla_summary,</span>
<span id="cb50-22"><a href="#cb50-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">caption =</span> <span class="st">"Resultados del modelo Logit: coeficientes estimados"</span>,</span>
<span id="cb50-23"><a href="#cb50-23" aria-hidden="true" tabindex="-1"></a>  <span class="at">align =</span> <span class="fu">c</span>(<span class="st">"l"</span>, <span class="st">"r"</span>, <span class="st">"r"</span>, <span class="st">"r"</span>, <span class="st">"r"</span>)</span>
<span id="cb50-24"><a href="#cb50-24" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<caption>Resultados del modelo Logit: coeficientes estimados</caption>
<colgroup>
<col style="width: 48%">
<col style="width: 12%">
<col style="width: 15%">
<col style="width: 14%">
<col style="width: 8%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Variable</th>
<th style="text-align: right;">Coeficiente</th>
<th style="text-align: right;">Error_Estandar</th>
<th style="text-align: right;">Estadistico_z</th>
<th style="text-align: right;">Valor_p</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">-1.954</td>
<td style="text-align: right;">0.340</td>
<td style="text-align: right;">-5.739</td>
<td style="text-align: right;">0.0000</td>
</tr>
<tr class="even">
<td style="text-align: left;">EDAD</td>
<td style="text-align: right;">-0.004</td>
<td style="text-align: right;">0.002</td>
<td style="text-align: right;">-2.153</td>
<td style="text-align: right;">0.0314</td>
</tr>
<tr class="odd">
<td style="text-align: left;">generoMasculino</td>
<td style="text-align: right;">0.542</td>
<td style="text-align: right;">0.041</td>
<td style="text-align: right;">13.329</td>
<td style="text-align: right;">0.0000</td>
</tr>
<tr class="even">
<td style="text-align: left;">pueblo_indNo indígena</td>
<td style="text-align: right;">-0.114</td>
<td style="text-align: right;">0.059</td>
<td style="text-align: right;">-1.946</td>
<td style="text-align: right;">0.0517</td>
</tr>
<tr class="odd">
<td style="text-align: left;">religionReligión</td>
<td style="text-align: right;">-0.181</td>
<td style="text-align: right;">0.044</td>
<td style="text-align: right;">-4.142</td>
<td style="text-align: right;">0.0000</td>
</tr>
<tr class="even">
<td style="text-align: left;">educacion_medTiene educación media o superior</td>
<td style="text-align: right;">0.359</td>
<td style="text-align: right;">0.073</td>
<td style="text-align: right;">4.948</td>
<td style="text-align: right;">0.0000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Consumo_marSí</td>
<td style="text-align: right;">1.266</td>
<td style="text-align: right;">0.094</td>
<td style="text-align: right;">13.417</td>
<td style="text-align: right;">0.0000</td>
</tr>
<tr class="even">
<td style="text-align: left;">Consumo_cocSí</td>
<td style="text-align: right;">2.080</td>
<td style="text-align: right;">0.649</td>
<td style="text-align: right;">3.206</td>
<td style="text-align: right;">0.0013</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Consumo_pbSí</td>
<td style="text-align: right;">0.962</td>
<td style="text-align: right;">0.543</td>
<td style="text-align: right;">1.772</td>
<td style="text-align: right;">0.0764</td>
</tr>
<tr class="even">
<td style="text-align: left;">Consumo_tusSí</td>
<td style="text-align: right;">-0.560</td>
<td style="text-align: right;">1.045</td>
<td style="text-align: right;">-0.535</td>
<td style="text-align: right;">0.5924</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Riesgo_diario_rec</td>
<td style="text-align: right;">0.052</td>
<td style="text-align: right;">0.040</td>
<td style="text-align: right;">1.299</td>
<td style="text-align: right;">0.1941</td>
</tr>
<tr class="even">
<td style="text-align: left;">Riesgo_ocasion_rec</td>
<td style="text-align: right;">-0.256</td>
<td style="text-align: right;">0.023</td>
<td style="text-align: right;">-11.188</td>
<td style="text-align: right;">0.0000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">sm_sueno</td>
<td style="text-align: right;">0.147</td>
<td style="text-align: right;">0.035</td>
<td style="text-align: right;">4.249</td>
<td style="text-align: right;">0.0000</td>
</tr>
<tr class="even">
<td style="text-align: left;">sm_confianza</td>
<td style="text-align: right;">0.022</td>
<td style="text-align: right;">0.049</td>
<td style="text-align: right;">0.451</td>
<td style="text-align: right;">0.6523</td>
</tr>
<tr class="odd">
<td style="text-align: left;">sm_agobiado</td>
<td style="text-align: right;">0.128</td>
<td style="text-align: right;">0.038</td>
<td style="text-align: right;">3.324</td>
<td style="text-align: right;">0.0009</td>
</tr>
<tr class="even">
<td style="text-align: left;">sm_depresion</td>
<td style="text-align: right;">-0.026</td>
<td style="text-align: right;">0.044</td>
<td style="text-align: right;">-0.578</td>
<td style="text-align: right;">0.5636</td>
</tr>
<tr class="odd">
<td style="text-align: left;">sm_valía_moral</td>
<td style="text-align: right;">-0.170</td>
<td style="text-align: right;">0.051</td>
<td style="text-align: right;">-3.317</td>
<td style="text-align: right;">0.0009</td>
</tr>
<tr class="even">
<td style="text-align: left;">sm_frustracion</td>
<td style="text-align: right;">-0.150</td>
<td style="text-align: right;">0.043</td>
<td style="text-align: right;">-3.503</td>
<td style="text-align: right;">0.0005</td>
</tr>
<tr class="odd">
<td style="text-align: left;">salud_general2</td>
<td style="text-align: right;">0.745</td>
<td style="text-align: right;">0.288</td>
<td style="text-align: right;">2.589</td>
<td style="text-align: right;">0.0096</td>
</tr>
<tr class="even">
<td style="text-align: left;">salud_general3</td>
<td style="text-align: right;">1.017</td>
<td style="text-align: right;">0.270</td>
<td style="text-align: right;">3.766</td>
<td style="text-align: right;">0.0002</td>
</tr>
<tr class="odd">
<td style="text-align: left;">salud_general4</td>
<td style="text-align: right;">1.012</td>
<td style="text-align: right;">0.269</td>
<td style="text-align: right;">3.759</td>
<td style="text-align: right;">0.0002</td>
</tr>
<tr class="even">
<td style="text-align: left;">salud_general5</td>
<td style="text-align: right;">1.086</td>
<td style="text-align: right;">0.274</td>
<td style="text-align: right;">3.966</td>
<td style="text-align: right;">0.0001</td>
</tr>
<tr class="odd">
<td style="text-align: left;">salud_general6</td>
<td style="text-align: right;">1.287</td>
<td style="text-align: right;">0.280</td>
<td style="text-align: right;">4.601</td>
<td style="text-align: right;">0.0000</td>
</tr>
<tr class="even">
<td style="text-align: left;">estado_civil2</td>
<td style="text-align: right;">0.104</td>
<td style="text-align: right;">0.051</td>
<td style="text-align: right;">2.043</td>
<td style="text-align: right;">0.0411</td>
</tr>
<tr class="odd">
<td style="text-align: left;">estado_civil3</td>
<td style="text-align: right;">-0.001</td>
<td style="text-align: right;">0.075</td>
<td style="text-align: right;">-0.015</td>
<td style="text-align: right;">0.9881</td>
</tr>
<tr class="even">
<td style="text-align: left;">estado_civil4</td>
<td style="text-align: right;">-0.394</td>
<td style="text-align: right;">0.141</td>
<td style="text-align: right;">-2.785</td>
<td style="text-align: right;">0.0054</td>
</tr>
<tr class="odd">
<td style="text-align: left;">estado_civil5</td>
<td style="text-align: right;">0.082</td>
<td style="text-align: right;">0.253</td>
<td style="text-align: right;">0.325</td>
<td style="text-align: right;">0.7450</td>
</tr>
<tr class="even">
<td style="text-align: left;">estado_civil6</td>
<td style="text-align: right;">0.292</td>
<td style="text-align: right;">0.113</td>
<td style="text-align: right;">2.583</td>
<td style="text-align: right;">0.0098</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Consumo_cigarrosSí</td>
<td style="text-align: right;">1.015</td>
<td style="text-align: right;">0.043</td>
<td style="text-align: right;">23.382</td>
<td style="text-align: right;">0.0000</td>
</tr>
<tr class="even">
<td style="text-align: left;">cargo_trabajo2</td>
<td style="text-align: right;">0.066</td>
<td style="text-align: right;">0.109</td>
<td style="text-align: right;">0.608</td>
<td style="text-align: right;">0.5430</td>
</tr>
<tr class="odd">
<td style="text-align: left;">cargo_trabajo3</td>
<td style="text-align: right;">0.224</td>
<td style="text-align: right;">0.120</td>
<td style="text-align: right;">1.863</td>
<td style="text-align: right;">0.0624</td>
</tr>
<tr class="even">
<td style="text-align: left;">cargo_trabajo4</td>
<td style="text-align: right;">0.151</td>
<td style="text-align: right;">0.121</td>
<td style="text-align: right;">1.244</td>
<td style="text-align: right;">0.2135</td>
</tr>
<tr class="odd">
<td style="text-align: left;">cargo_trabajo5</td>
<td style="text-align: right;">0.394</td>
<td style="text-align: right;">0.106</td>
<td style="text-align: right;">3.706</td>
<td style="text-align: right;">0.0002</td>
</tr>
<tr class="even">
<td style="text-align: left;">cargo_trabajo6</td>
<td style="text-align: right;">-0.380</td>
<td style="text-align: right;">0.356</td>
<td style="text-align: right;">-1.068</td>
<td style="text-align: right;">0.2855</td>
</tr>
<tr class="odd">
<td style="text-align: left;">cargo_trabajo7</td>
<td style="text-align: right;">-0.351</td>
<td style="text-align: right;">0.196</td>
<td style="text-align: right;">-1.789</td>
<td style="text-align: right;">0.0736</td>
</tr>
<tr class="even">
<td style="text-align: left;">cargo_trabajo8</td>
<td style="text-align: right;">0.176</td>
<td style="text-align: right;">0.359</td>
<td style="text-align: right;">0.490</td>
<td style="text-align: right;">0.6243</td>
</tr>
<tr class="odd">
<td style="text-align: left;">cargo_trabajo9</td>
<td style="text-align: right;">-0.563</td>
<td style="text-align: right;">0.174</td>
<td style="text-align: right;">-3.237</td>
<td style="text-align: right;">0.0012</td>
</tr>
<tr class="even">
<td style="text-align: left;">trabaja_o_no2</td>
<td style="text-align: right;">0.168</td>
<td style="text-align: right;">0.072</td>
<td style="text-align: right;">2.354</td>
<td style="text-align: right;">0.0186</td>
</tr>
</tbody>
</table>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 7. Verificación de la variable dependiente </span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>tabla_alcohol <span class="ot">&lt;-</span> base_logit <span class="sc">%&gt;%</span></span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(alcohol_30d) <span class="sc">%&gt;%</span></span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">Porcentaje =</span> <span class="fu">percent</span>(n <span class="sc">/</span> <span class="fu">sum</span>(n), <span class="at">accuracy =</span> <span class="fl">0.1</span>)</span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(</span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">Categoria =</span> alcohol_30d,</span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">Frecuencia =</span> n</span>
<span id="cb51-12"><a href="#cb51-12" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb51-13"><a href="#cb51-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-14"><a href="#cb51-14" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(</span>
<span id="cb51-15"><a href="#cb51-15" aria-hidden="true" tabindex="-1"></a>  tabla_alcohol,</span>
<span id="cb51-16"><a href="#cb51-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">caption =</span> <span class="st">"Distribución del consumo de alcohol en los últimos 30 días"</span>,</span>
<span id="cb51-17"><a href="#cb51-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">align =</span> <span class="fu">c</span>(<span class="st">"l"</span>, <span class="st">"r"</span>, <span class="st">"r"</span>)</span>
<span id="cb51-18"><a href="#cb51-18" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<caption>Distribución del consumo de alcohol en los últimos 30 días</caption>
<thead>
<tr class="header">
<th style="text-align: left;">Categoria</th>
<th style="text-align: right;">Frecuencia</th>
<th style="text-align: right;">Porcentaje</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">0</td>
<td style="text-align: right;">8663</td>
<td style="text-align: right;">65.6%</td>
</tr>
<tr class="even">
<td style="text-align: left;">1</td>
<td style="text-align: right;">4537</td>
<td style="text-align: right;">34.4%</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>A continuación se van a presentar las variables que resultaron significativas para el modelo.</p>
<p>Género: El coeficiente positivo para Masculino (Estimate = 0,542; p &lt; 0,001) indica que, en comparación con la categoría de referencia “otro género”, ser masculino se asocia con una mayor probabilidad de consumo de alcohol, manteniendo constantes las demás variables del modelo.</p>
<p>Religión: El coeficiente negativo para adherir a una religión (Estimate = −0,181; p &lt; 0,001) sugiere que, respecto a la categoría de referencia “no adhiere a una religión”, las personas que adhieren a una religión tienen una menor probabilidad de consumir alcohol.</p>
<p>Educación: El coeficiente positivo (Estimate = 0.359; p &lt; 0,001) para contar con educación media o superior (comparado con no tenerla, referencia) indica una mayor probabilidad de consumo de alcohol en ese grupo.</p>
<p>Consumo de Marihuana: El coeficiente positivo (Estimate = 1,266; p &lt; 0,001), indica que quienes reportan consumo de marihuana presentan una mayor probabilidad de consumo de alcohol en comparación con quienes no consumen marihuana.</p>
<p>Percepción de riesgo de consumo ocasional: El coeficiente negativo de la variable (Estimate = −0,256; p &lt; 0,001) sugiere que, a medida que aumenta el puntaje en esta, disminuye la probabilidad de consumo de alcohol, manteniendo constantes las demás covariables. Esto quiere decir que a mayor percepción de riesgo es menor la probabilidad de consumo.</p>
<p>Sueño: El coeficiente positivo (Estimate = 0,147; p &lt; 0,001), sugiere un aumento de un punto en la escala de “pérdida de sueño por preocupaciones”. Esto refiere a una mayor probabilidad de consumo de alcohol en la medida que esta variable es más habitual, manteniendo constantes las demás variables.</p>
<p>Agobiado: El coeficiente positivo (Estimate = 0,128; p &lt; 0,001), sugiere un aumento en la escala de “sentirse agobiado o en tensión”. Esto refiere a una mayor probabilidad de consumo de alcohol en la medida que esta variable es más habitual, manteniendo constantes las demás variables.</p>
<p>Valia moral: El coeficiente negativo (Estimate = -0,17; p &lt; 0,001), sugiere que a mayor puntaje en la escala de “pensar que él/ella no vale nada”, se observa una menor probabilidad de consumo de alcohol, lo que quiere decir que, aquellas personas que piensan que tienen valor, son menos propensas al consumo de alcohol.</p>
<p>Frustación: El coeficiente negativo (Estimate = -0,15; p &lt; 0,001), indica una disminución de la probabilidad de consumo de alcohol, cuando aumenta el puntaje en la escala de “sentir que no puede superar dificultades”, es decir, que aquellas personas que sienten más frustración respecto a las dificultades, tienen una mayor probabilidad de consumir alcohol.</p>
<p>Salud General: Los coeficientes positivos para las categorías 2 (Malo), 3 (Regular), 4 (Bueno), 5 (Muy bueno) y 6 (Excelente) indican que, en comparación con la categoría 1 (Muy mala), estas categorías se asocian con una mayor probabilidad de consumo de alcohol.</p>
<p>Consumo de cigarros: El coeficiente positivo para consumo de cigarros (Sí) (Estimate = 1,015; p &lt; 0,001) indica una asociación fuerte con el consumo de alcohol: quienes consumen cigarros presentan mayor probabilidad de consumir alcohol que quienes no consumen, controlando por el resto de variables.</p>
<p>Cargo en el trabajo: Empleado/a u obrero/a del sector privado (cargo_trabajo5) (Estimate = 0,394; p &lt; 0,001). En comparación con la categoría de referencia del cargo (cargo_trabajo1), pertenecer al sector privado se asocia con mayor probabilidad de consumo de alcohol.</p>
<p>Hacer curva Roc y el analisis de sensitividad (con la matriz de confusión):</p>
<p>Inicialmente, se calcularon los indicadores de la matriz de confusión y la curva ROC para evaluar el desempeño del modelo predictivo en un escenario de punto de corte estándar de 0,5 para clasificar las predicciones consumidores y no consumidores de alcohol en los últimos 30 días. A partir de este punto de corte se recalculó la matriz de confusión y la curva Roc, resultados que se presentan en la siguiente figura y tablas.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 8. Desempeño del modelo: Curva ROC y AUC</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>prob_pred_logit <span class="ot">&lt;-</span> <span class="fu">predict</span>(modelo_logit, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Curva ROC</span></span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a><span class="co"># La curva ROC (Receiver Operating Characteristic) evalúa la</span></span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a><span class="co"># capacidad del modelo para discriminar entre quienes consumen</span></span>
<span id="cb52-11"><a href="#cb52-11" aria-hidden="true" tabindex="-1"></a><span class="co"># y no consumen alcohol, considerando distintos puntos de corte.</span></span>
<span id="cb52-12"><a href="#cb52-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-13"><a href="#cb52-13" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pROC)</span>
<span id="cb52-14"><a href="#cb52-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-15"><a href="#cb52-15" aria-hidden="true" tabindex="-1"></a>roc_logit <span class="ot">&lt;-</span> <span class="fu">roc</span>(</span>
<span id="cb52-16"><a href="#cb52-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">response =</span> base_logit<span class="sc">$</span>alcohol_30d,</span>
<span id="cb52-17"><a href="#cb52-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">predictor =</span> prob_pred_logit</span>
<span id="cb52-18"><a href="#cb52-18" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb52-19"><a href="#cb52-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-20"><a href="#cb52-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Gráfico de la curva ROC</span></span>
<span id="cb52-21"><a href="#cb52-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-22"><a href="#cb52-22" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(</span>
<span id="cb52-23"><a href="#cb52-23" aria-hidden="true" tabindex="-1"></a>  roc_logit,</span>
<span id="cb52-24"><a href="#cb52-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">main =</span> <span class="st">"Curva ROC – Modelo Logit (Consumo de alcohol 30 días)"</span>,</span>
<span id="cb52-25"><a href="#cb52-25" aria-hidden="true" tabindex="-1"></a>  <span class="at">col =</span> <span class="st">"blue"</span>,</span>
<span id="cb52-26"><a href="#cb52-26" aria-hidden="true" tabindex="-1"></a>  <span class="at">lwd =</span> <span class="dv">2</span></span>
<span id="cb52-27"><a href="#cb52-27" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb52-28"><a href="#cb52-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-29"><a href="#cb52-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Línea diagonal (clasificación aleatoria)</span></span>
<span id="cb52-30"><a href="#cb52-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-31"><a href="#cb52-31" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">a =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">1</span>, <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="st">"gray"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Capstone-Prueba-F_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Área bajo la curva (AUC)</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>auc_logit <span class="ot">&lt;-</span> <span class="fu">auc</span>(roc_logit)</span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a><span class="co"># 9. Matriz de confusión</span></span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Se define un punto de corte estándar de 0.5 para clasificar</span></span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a><span class="co"># las probabilidades predichas en consumo (1) o no consumo (0).</span></span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-11"><a href="#cb53-11" aria-hidden="true" tabindex="-1"></a>pred_clase <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(prob_pred_logit <span class="sc">&gt;=</span> <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb53-12"><a href="#cb53-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-13"><a href="#cb53-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Matriz de confusión</span></span>
<span id="cb53-14"><a href="#cb53-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-15"><a href="#cb53-15" aria-hidden="true" tabindex="-1"></a>matriz_confusion <span class="ot">&lt;-</span> <span class="fu">table</span>(</span>
<span id="cb53-16"><a href="#cb53-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">Observado =</span> base_logit<span class="sc">$</span>alcohol_30d,</span>
<span id="cb53-17"><a href="#cb53-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">Predicho =</span> pred_clase</span>
<span id="cb53-18"><a href="#cb53-18" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb53-19"><a href="#cb53-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-20"><a href="#cb53-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Convertir matriz de confusión en tabla </span></span>
<span id="cb53-21"><a href="#cb53-21" aria-hidden="true" tabindex="-1"></a>tabla_confusion <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(matriz_confusion) <span class="sc">%&gt;%</span></span>
<span id="cb53-22"><a href="#cb53-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(</span>
<span id="cb53-23"><a href="#cb53-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">Observado =</span> Observado,</span>
<span id="cb53-24"><a href="#cb53-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">Predicho =</span> Predicho,</span>
<span id="cb53-25"><a href="#cb53-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">Frecuencia =</span> Freq</span>
<span id="cb53-26"><a href="#cb53-26" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb53-27"><a href="#cb53-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-28"><a href="#cb53-28" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(</span>
<span id="cb53-29"><a href="#cb53-29" aria-hidden="true" tabindex="-1"></a>  tabla_confusion,</span>
<span id="cb53-30"><a href="#cb53-30" aria-hidden="true" tabindex="-1"></a>  <span class="at">caption =</span> <span class="st">"Matriz de confusión del modelo Logit (punto de corte = 0.5)"</span>,</span>
<span id="cb53-31"><a href="#cb53-31" aria-hidden="true" tabindex="-1"></a>  <span class="at">align =</span> <span class="fu">c</span>(<span class="st">"l"</span>, <span class="st">"l"</span>, <span class="st">"r"</span>)</span>
<span id="cb53-32"><a href="#cb53-32" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<caption>Matriz de confusión del modelo Logit (punto de corte = 0.5)</caption>
<thead>
<tr class="header">
<th style="text-align: left;">Observado</th>
<th style="text-align: left;">Predicho</th>
<th style="text-align: right;">Frecuencia</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">0</td>
<td style="text-align: left;">0</td>
<td style="text-align: right;">7706</td>
</tr>
<tr class="even">
<td style="text-align: left;">1</td>
<td style="text-align: left;">0</td>
<td style="text-align: right;">3041</td>
</tr>
<tr class="odd">
<td style="text-align: left;">0</td>
<td style="text-align: left;">1</td>
<td style="text-align: right;">957</td>
</tr>
<tr class="even">
<td style="text-align: left;">1</td>
<td style="text-align: left;">1</td>
<td style="text-align: right;">1496</td>
</tr>
</tbody>
</table>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Métricas derivadas de la matriz de confusión</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Exactitud (accuracy)</span></span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>accuracy <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">diag</span>(matriz_confusion)) <span class="sc">/</span> <span class="fu">sum</span>(matriz_confusion)</span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Sensibilidad (recall / tasa de verdaderos positivos)</span></span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a>sensibilidad <span class="ot">&lt;-</span> matriz_confusion[<span class="st">"1"</span>, <span class="st">"1"</span>] <span class="sc">/</span></span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sum</span>(matriz_confusion[<span class="st">"1"</span>, ])</span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-11"><a href="#cb54-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Especificidad (tasa de verdaderos negativos)</span></span>
<span id="cb54-12"><a href="#cb54-12" aria-hidden="true" tabindex="-1"></a>especificidad <span class="ot">&lt;-</span> matriz_confusion[<span class="st">"0"</span>, <span class="st">"0"</span>] <span class="sc">/</span></span>
<span id="cb54-13"><a href="#cb54-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sum</span>(matriz_confusion[<span class="st">"0"</span>, ])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><strong>a) Interpretación</strong></p>
<p>El modelo de regresión logística, que evalúa el consumo de alcohol durante los últimos 30 días en función de distintas variables predictoras, permitió reconocer patrones relevantes entre los factores considerados e identificar factores asociados al consumo de alcohol en los últimos 30 días, mostrando un ajuste adecuado y una capacidad de discriminación moderada (AUC = 0,72). En términos de desempeño predictivo, el modelo presenta una exactitud del 69,7%, con alta especificidad (88,9%) y sensibilidad moderada-baja (33,0%), lo que indica mayor precisión para identificar a quienes no consumen alcohol.</p>
</section>
<section id="análisis-predictivo-random-forest" class="level2" data-number="9">
<h2 data-number="9" class="anchored" data-anchor-id="análisis-predictivo-random-forest"><span class="header-section-number">9</span> Análisis predictivo: Random forest</h2>
<p>Se emplea Random Forest porque es un método de aprendizaje automático supervisado que integra varios árboles de decisión para aumentar la exactitud y la consistencia de las predicciones. Resulta conveniente ya que disminuye el riesgo de sobreajuste, se desempeña bien con conjuntos de datos con numerosas variables y es resistente a la influencia de valores atípicos. Además, permite estimar qué tan relevantes son las distintas variables para explicar la predicción.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="do">##Random Forest</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(randomForest)</span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(caret)</span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tibble)</span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a><span class="do">## Carga de datos</span></span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-9"><a href="#cb55-9" aria-hidden="true" tabindex="-1"></a>base_rf <span class="ot">&lt;-</span> ENPG_filtrado</span>
<span id="cb55-10"><a href="#cb55-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-11"><a href="#cb55-11" aria-hidden="true" tabindex="-1"></a><span class="do">## preprocesamiento de datos</span></span>
<span id="cb55-12"><a href="#cb55-12" aria-hidden="true" tabindex="-1"></a><span class="co">#Transformar datos a factor previo a su procesamiento como RF</span></span>
<span id="cb55-13"><a href="#cb55-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-14"><a href="#cb55-14" aria-hidden="true" tabindex="-1"></a><span class="co">#Variables Folio y Sexo no necesitan tranformación</span></span>
<span id="cb55-15"><a href="#cb55-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-16"><a href="#cb55-16" aria-hidden="true" tabindex="-1"></a><span class="do">## 1. Variables que NO se transforman</span></span>
<span id="cb55-17"><a href="#cb55-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Folio y EDAD se mantienen como numéricas / identificadores</span></span>
<span id="cb55-18"><a href="#cb55-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-19"><a href="#cb55-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-20"><a href="#cb55-20" aria-hidden="true" tabindex="-1"></a><span class="co">#Variables sociodemográficas categóricas</span></span>
<span id="cb55-21"><a href="#cb55-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-22"><a href="#cb55-22" aria-hidden="true" tabindex="-1"></a><span class="do">## Estado civil </span></span>
<span id="cb55-23"><a href="#cb55-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-24"><a href="#cb55-24" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span> (</span>
<span id="cb55-25"><a href="#cb55-25" aria-hidden="true" tabindex="-1"></a>{base_rf<span class="sc">$</span>estado_civil <span class="ot">&lt;-</span> <span class="fu">factor</span>(base_rf<span class="sc">$</span>estado_civil,</span>
<span id="cb55-26"><a href="#cb55-26" aria-hidden="true" tabindex="-1"></a>                               <span class="at">levels =</span>  <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>), </span>
<span id="cb55-27"><a href="#cb55-27" aria-hidden="true" tabindex="-1"></a>                               <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Soltero/a"</span>, <span class="st">"Casado/a"</span>, </span>
<span id="cb55-28"><a href="#cb55-28" aria-hidden="true" tabindex="-1"></a>                                          <span class="st">"Divorciado/a"</span>, <span class="st">"Viudo/a"</span>, </span>
<span id="cb55-29"><a href="#cb55-29" aria-hidden="true" tabindex="-1"></a>                                          <span class="st">"Anulado/a"</span>, <span class="st">"Conviviente civil"</span>))</span>
<span id="cb55-30"><a href="#cb55-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-31"><a href="#cb55-31" aria-hidden="true" tabindex="-1"></a><span class="do">## Sexo (1 = Masculino, 2 = Femenino)</span></span>
<span id="cb55-32"><a href="#cb55-32" aria-hidden="true" tabindex="-1"></a>base_rf<span class="sc">$</span>SEXO <span class="ot">&lt;-</span> <span class="fu">factor</span>(base_rf<span class="sc">$</span>SEXO,</span>
<span id="cb55-33"><a href="#cb55-33" aria-hidden="true" tabindex="-1"></a>                       <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>),</span>
<span id="cb55-34"><a href="#cb55-34" aria-hidden="true" tabindex="-1"></a>                       <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Masculino"</span>, <span class="st">"Femenino"</span>))</span>
<span id="cb55-35"><a href="#cb55-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-36"><a href="#cb55-36" aria-hidden="true" tabindex="-1"></a><span class="do">## Género</span></span>
<span id="cb55-37"><a href="#cb55-37" aria-hidden="true" tabindex="-1"></a>base_rf<span class="sc">$</span>genero <span class="ot">&lt;-</span> <span class="fu">factor</span>(base_rf<span class="sc">$</span>genero)</span>
<span id="cb55-38"><a href="#cb55-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-39"><a href="#cb55-39" aria-hidden="true" tabindex="-1"></a><span class="do">## Pueblo indígena</span></span>
<span id="cb55-40"><a href="#cb55-40" aria-hidden="true" tabindex="-1"></a>base_rf<span class="sc">$</span>pueblo_ind <span class="ot">&lt;-</span> <span class="fu">factor</span>(base_rf<span class="sc">$</span>pueblo_ind)</span>
<span id="cb55-41"><a href="#cb55-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-42"><a href="#cb55-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-43"><a href="#cb55-43" aria-hidden="true" tabindex="-1"></a><span class="do">## Escolaridad (ordenable)</span></span>
<span id="cb55-44"><a href="#cb55-44" aria-hidden="true" tabindex="-1"></a>base_rf<span class="sc">$</span>educacion_med <span class="ot">&lt;-</span> <span class="fu">factor</span>(base_rf<span class="sc">$</span>educacion_med,</span>
<span id="cb55-45"><a href="#cb55-45" aria-hidden="true" tabindex="-1"></a>                              <span class="at">ordered =</span> <span class="cn">TRUE</span>)</span>
<span id="cb55-46"><a href="#cb55-46" aria-hidden="true" tabindex="-1"></a><span class="do">## Religion</span></span>
<span id="cb55-47"><a href="#cb55-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-48"><a href="#cb55-48" aria-hidden="true" tabindex="-1"></a>base_rf<span class="sc">$</span>religion <span class="ot">&lt;-</span> <span class="fu">factor</span>(base_rf<span class="sc">$</span>religion) </span>
<span id="cb55-49"><a href="#cb55-49" aria-hidden="true" tabindex="-1"></a>                           </span>
<span id="cb55-50"><a href="#cb55-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-51"><a href="#cb55-51" aria-hidden="true" tabindex="-1"></a><span class="co">#Variables de consumo</span></span>
<span id="cb55-52"><a href="#cb55-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-53"><a href="#cb55-53" aria-hidden="true" tabindex="-1"></a>base_rf<span class="sc">$</span>Consumo_mar <span class="ot">&lt;-</span> <span class="fu">factor</span>(base_rf<span class="sc">$</span>Consumo_mar,</span>
<span id="cb55-54"><a href="#cb55-54" aria-hidden="true" tabindex="-1"></a>                              <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"No"</span>, <span class="st">"Sí"</span>))</span>
<span id="cb55-55"><a href="#cb55-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-56"><a href="#cb55-56" aria-hidden="true" tabindex="-1"></a>base_rf<span class="sc">$</span>Consumo_coc <span class="ot">&lt;-</span> <span class="fu">factor</span>(base_rf<span class="sc">$</span>Consumo_coc,</span>
<span id="cb55-57"><a href="#cb55-57" aria-hidden="true" tabindex="-1"></a>                              <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"No"</span>, <span class="st">"Sí"</span>))</span>
<span id="cb55-58"><a href="#cb55-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-59"><a href="#cb55-59" aria-hidden="true" tabindex="-1"></a>base_rf<span class="sc">$</span>Consumo_cigarros <span class="ot">&lt;-</span> <span class="fu">factor</span>(base_rf<span class="sc">$</span>Consumo_cigarros, </span>
<span id="cb55-60"><a href="#cb55-60" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"No"</span>, <span class="st">"Sí"</span>))</span>
<span id="cb55-61"><a href="#cb55-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-62"><a href="#cb55-62" aria-hidden="true" tabindex="-1"></a>base_rf<span class="sc">$</span>Consumo_pb <span class="ot">&lt;-</span> <span class="fu">factor</span>(base_rf<span class="sc">$</span>Consumo_pb,</span>
<span id="cb55-63"><a href="#cb55-63" aria-hidden="true" tabindex="-1"></a>                             <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"No"</span>, <span class="st">"Sí"</span>))</span>
<span id="cb55-64"><a href="#cb55-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-65"><a href="#cb55-65" aria-hidden="true" tabindex="-1"></a>base_rf<span class="sc">$</span>Consumo_tus <span class="ot">&lt;-</span> <span class="fu">factor</span>(base_rf<span class="sc">$</span>Consumo_tus, </span>
<span id="cb55-66"><a href="#cb55-66" aria-hidden="true" tabindex="-1"></a>                              <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"No"</span>, <span class="st">"Sí"</span>))</span>
<span id="cb55-67"><a href="#cb55-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-68"><a href="#cb55-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-69"><a href="#cb55-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-70"><a href="#cb55-70" aria-hidden="true" tabindex="-1"></a><span class="do">##variables de riesgo con factor ordenado</span></span>
<span id="cb55-71"><a href="#cb55-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-72"><a href="#cb55-72" aria-hidden="true" tabindex="-1"></a>base_rf<span class="sc">$</span>Riesgo_ocasion <span class="ot">&lt;-</span> <span class="fu">factor</span>(base_rf<span class="sc">$</span>Riesgo_ocasion,</span>
<span id="cb55-73"><a href="#cb55-73" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">ordered =</span> <span class="cn">TRUE</span>)</span>
<span id="cb55-74"><a href="#cb55-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-75"><a href="#cb55-75" aria-hidden="true" tabindex="-1"></a>base_rf<span class="sc">$</span>Riesgo_diario <span class="ot">&lt;-</span> <span class="fu">factor</span>(base_rf<span class="sc">$</span>Riesgo_diario,</span>
<span id="cb55-76"><a href="#cb55-76" aria-hidden="true" tabindex="-1"></a>                                <span class="at">ordered =</span> <span class="cn">TRUE</span>)</span>
<span id="cb55-77"><a href="#cb55-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-78"><a href="#cb55-78" aria-hidden="true" tabindex="-1"></a><span class="do">##Edad por tramos</span></span>
<span id="cb55-79"><a href="#cb55-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-80"><a href="#cb55-80" aria-hidden="true" tabindex="-1"></a>base_rf<span class="sc">$</span>edad_recod <span class="ot">&lt;-</span> <span class="fu">factor</span>(base_rf<span class="sc">$</span>edad_recod,</span>
<span id="cb55-81"><a href="#cb55-81" aria-hidden="true" tabindex="-1"></a>                             <span class="at">ordered =</span> <span class="cn">TRUE</span>)</span>
<span id="cb55-82"><a href="#cb55-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-83"><a href="#cb55-83" aria-hidden="true" tabindex="-1"></a><span class="co"># Salud </span></span>
<span id="cb55-84"><a href="#cb55-84" aria-hidden="true" tabindex="-1"></a>base_rf<span class="sc">$</span>salud_general <span class="ot">&lt;-</span> <span class="fu">factor</span>(base_rf<span class="sc">$</span>salud_general, </span>
<span id="cb55-85"><a href="#cb55-85" aria-hidden="true" tabindex="-1"></a>                                <span class="at">ordered =</span> <span class="cn">TRUE</span>)</span>
<span id="cb55-86"><a href="#cb55-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-87"><a href="#cb55-87" aria-hidden="true" tabindex="-1"></a>base_rf<span class="sc">$</span>sm_agobiado <span class="ot">&lt;-</span> <span class="fu">factor</span>(base_rf<span class="sc">$</span>sm_agobiado, </span>
<span id="cb55-88"><a href="#cb55-88" aria-hidden="true" tabindex="-1"></a>                              <span class="at">ordered =</span> <span class="cn">TRUE</span>)</span>
<span id="cb55-89"><a href="#cb55-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-90"><a href="#cb55-90" aria-hidden="true" tabindex="-1"></a>base_rf<span class="sc">$</span>sm_confianza <span class="ot">&lt;-</span> <span class="fu">factor</span>(base_rf<span class="sc">$</span>sm_confianza, </span>
<span id="cb55-91"><a href="#cb55-91" aria-hidden="true" tabindex="-1"></a>                               <span class="at">ordered =</span> T)</span>
<span id="cb55-92"><a href="#cb55-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-93"><a href="#cb55-93" aria-hidden="true" tabindex="-1"></a>base_rf<span class="sc">$</span>sm_depresion <span class="ot">&lt;-</span> <span class="fu">factor</span>(base_rf<span class="sc">$</span>sm_depresion, </span>
<span id="cb55-94"><a href="#cb55-94" aria-hidden="true" tabindex="-1"></a>                               <span class="at">ordered =</span> T)</span>
<span id="cb55-95"><a href="#cb55-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-96"><a href="#cb55-96" aria-hidden="true" tabindex="-1"></a>base_rf<span class="sc">$</span>sm_frustracion <span class="ot">&lt;-</span> <span class="fu">factor</span>(base_rf<span class="sc">$</span>sm_frustracion, </span>
<span id="cb55-97"><a href="#cb55-97" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">ordered =</span> T)</span>
<span id="cb55-98"><a href="#cb55-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-99"><a href="#cb55-99" aria-hidden="true" tabindex="-1"></a>base_rf<span class="sc">$</span>sm_sueno <span class="ot">&lt;-</span> <span class="fu">factor</span>(base_rf<span class="sc">$</span>sm_sueno, </span>
<span id="cb55-100"><a href="#cb55-100" aria-hidden="true" tabindex="-1"></a>                           <span class="at">ordered =</span> T)</span>
<span id="cb55-101"><a href="#cb55-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-102"><a href="#cb55-102" aria-hidden="true" tabindex="-1"></a>base_rf<span class="sc">$</span>sm_valía_moral <span class="ot">&lt;-</span> <span class="fu">factor</span>(base_rf<span class="sc">$</span>sm_valía_moral, </span>
<span id="cb55-103"><a href="#cb55-103" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">ordered =</span> T)</span>
<span id="cb55-104"><a href="#cb55-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-105"><a href="#cb55-105" aria-hidden="true" tabindex="-1"></a><span class="co"># Trabajo </span></span>
<span id="cb55-106"><a href="#cb55-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-107"><a href="#cb55-107" aria-hidden="true" tabindex="-1"></a>base_rf<span class="sc">$</span>trabaja_o_no <span class="ot">&lt;-</span> <span class="fu">factor</span>(base_rf<span class="sc">$</span>trabaja_o_no, </span>
<span id="cb55-108"><a href="#cb55-108" aria-hidden="true" tabindex="-1"></a>                               <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>),</span>
<span id="cb55-109"><a href="#cb55-109" aria-hidden="true" tabindex="-1"></a>                               <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Sí"</span>, <span class="st">"No"</span>))</span>
<span id="cb55-110"><a href="#cb55-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-111"><a href="#cb55-111" aria-hidden="true" tabindex="-1"></a>base_rf<span class="sc">$</span>cargo_trabajo <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(base_rf<span class="sc">$</span>cargo_trabajo)</span>
<span id="cb55-112"><a href="#cb55-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-113"><a href="#cb55-113" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb55-114"><a href="#cb55-114" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb55-115"><a href="#cb55-115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-116"><a href="#cb55-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-117"><a href="#cb55-117" aria-hidden="true" tabindex="-1"></a><span class="do">##Selección de variables como predictoras del consumo, usaremos las variables sociodemográficas en esta elección, toda vez que pretendemos conocer las características sociales y demográficas asociadas a la ingesta de alcohol</span></span>
<span id="cb55-118"><a href="#cb55-118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-119"><a href="#cb55-119" aria-hidden="true" tabindex="-1"></a>vars_pred <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb55-120"><a href="#cb55-120" aria-hidden="true" tabindex="-1"></a>  <span class="st">"EDAD"</span>,</span>
<span id="cb55-121"><a href="#cb55-121" aria-hidden="true" tabindex="-1"></a>  <span class="st">"estado_civil"</span>,</span>
<span id="cb55-122"><a href="#cb55-122" aria-hidden="true" tabindex="-1"></a>  <span class="st">"SEXO"</span>,</span>
<span id="cb55-123"><a href="#cb55-123" aria-hidden="true" tabindex="-1"></a>  <span class="st">"genero"</span>,</span>
<span id="cb55-124"><a href="#cb55-124" aria-hidden="true" tabindex="-1"></a>  <span class="st">"pueblo_ind"</span>,</span>
<span id="cb55-125"><a href="#cb55-125" aria-hidden="true" tabindex="-1"></a>  <span class="st">"educacion_med"</span>,</span>
<span id="cb55-126"><a href="#cb55-126" aria-hidden="true" tabindex="-1"></a>  <span class="st">"religion"</span>,</span>
<span id="cb55-127"><a href="#cb55-127" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Consumo_mar"</span>,</span>
<span id="cb55-128"><a href="#cb55-128" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Consumo_coc"</span>,</span>
<span id="cb55-129"><a href="#cb55-129" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Consumo_cigarros"</span>,</span>
<span id="cb55-130"><a href="#cb55-130" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Consumo_pb"</span>,</span>
<span id="cb55-131"><a href="#cb55-131" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Consumo_tus"</span>,</span>
<span id="cb55-132"><a href="#cb55-132" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Riesgo_ocasion"</span>,</span>
<span id="cb55-133"><a href="#cb55-133" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Riesgo_diario"</span>,</span>
<span id="cb55-134"><a href="#cb55-134" aria-hidden="true" tabindex="-1"></a>  <span class="st">"edad_recod"</span>,</span>
<span id="cb55-135"><a href="#cb55-135" aria-hidden="true" tabindex="-1"></a>  <span class="st">"salud_general"</span>,</span>
<span id="cb55-136"><a href="#cb55-136" aria-hidden="true" tabindex="-1"></a>  <span class="st">"sm_agobiado"</span>,</span>
<span id="cb55-137"><a href="#cb55-137" aria-hidden="true" tabindex="-1"></a>  <span class="st">"sm_confianza"</span>,</span>
<span id="cb55-138"><a href="#cb55-138" aria-hidden="true" tabindex="-1"></a>  <span class="st">"sm_depresion"</span>,</span>
<span id="cb55-139"><a href="#cb55-139" aria-hidden="true" tabindex="-1"></a>  <span class="st">"sm_frustracion"</span>,</span>
<span id="cb55-140"><a href="#cb55-140" aria-hidden="true" tabindex="-1"></a>  <span class="st">"sm_valía_moral"</span>,</span>
<span id="cb55-141"><a href="#cb55-141" aria-hidden="true" tabindex="-1"></a>  <span class="st">"trabaja_o_no"</span>,</span>
<span id="cb55-142"><a href="#cb55-142" aria-hidden="true" tabindex="-1"></a>  <span class="st">"cargo_trabajo"</span></span>
<span id="cb55-143"><a href="#cb55-143" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb55-144"><a href="#cb55-144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-145"><a href="#cb55-145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-146"><a href="#cb55-146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-147"><a href="#cb55-147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-148"><a href="#cb55-148" aria-hidden="true" tabindex="-1"></a><span class="do">## Instalar y cargar paquetes</span></span>
<span id="cb55-149"><a href="#cb55-149" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">require</span>(randomForest)) <span class="fu">install.packages</span>(<span class="st">"randomForest"</span>)</span>
<span id="cb55-150"><a href="#cb55-150" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">require</span>(caret)) <span class="fu">install.packages</span>(<span class="st">"caret"</span>)</span>
<span id="cb55-151"><a href="#cb55-151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-152"><a href="#cb55-152" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(randomForest)</span>
<span id="cb55-153"><a href="#cb55-153" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(caret)</span>
<span id="cb55-154"><a href="#cb55-154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-155"><a href="#cb55-155" aria-hidden="true" tabindex="-1"></a><span class="co"># Seleccin de columnas</span></span>
<span id="cb55-156"><a href="#cb55-156" aria-hidden="true" tabindex="-1"></a>rf_data <span class="ot">&lt;-</span> base_rf[, <span class="fu">c</span>(<span class="st">"alcohol_30d"</span>, vars_pred)]</span>
<span id="cb55-157"><a href="#cb55-157" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-158"><a href="#cb55-158" aria-hidden="true" tabindex="-1"></a>rf_data <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(rf_data)</span>
<span id="cb55-159"><a href="#cb55-159" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-160"><a href="#cb55-160" aria-hidden="true" tabindex="-1"></a><span class="co"># Imputamos valores faltantes</span></span>
<span id="cb55-161"><a href="#cb55-161" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-162"><a href="#cb55-162" aria-hidden="true" tabindex="-1"></a><span class="do">##Para variables categóricas: reemplazamos NA por la categoría más frecuente</span></span>
<span id="cb55-163"><a href="#cb55-163" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(col <span class="cf">in</span> vars_pred){</span>
<span id="cb55-164"><a href="#cb55-164" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">is.factor</span>(rf_data[[col]])){</span>
<span id="cb55-165"><a href="#cb55-165" aria-hidden="true" tabindex="-1"></a>    most_common <span class="ot">&lt;-</span> <span class="fu">levels</span>(rf_data[[col]])[<span class="fu">which.max</span>(<span class="fu">table</span>(rf_data[[col]]))]</span>
<span id="cb55-166"><a href="#cb55-166" aria-hidden="true" tabindex="-1"></a>    rf_data[[col]][<span class="fu">is.na</span>(rf_data[[col]])] <span class="ot">&lt;-</span> most_common</span>
<span id="cb55-167"><a href="#cb55-167" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb55-168"><a href="#cb55-168" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb55-169"><a href="#cb55-169" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-170"><a href="#cb55-170" aria-hidden="true" tabindex="-1"></a><span class="do">## Para variables numéricas: reemplaza NA por la mediana</span></span>
<span id="cb55-171"><a href="#cb55-171" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(col <span class="cf">in</span> vars_pred){</span>
<span id="cb55-172"><a href="#cb55-172" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">is.numeric</span>(rf_data[[col]])){</span>
<span id="cb55-173"><a href="#cb55-173" aria-hidden="true" tabindex="-1"></a>    rf_data[[col]][<span class="fu">is.na</span>(rf_data[[col]])] <span class="ot">&lt;-</span> <span class="fu">median</span>(rf_data[[col]], <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb55-174"><a href="#cb55-174" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb55-175"><a href="#cb55-175" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb55-176"><a href="#cb55-176" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-177"><a href="#cb55-177" aria-hidden="true" tabindex="-1"></a><span class="co"># Revisión de presencia de NA</span></span>
<span id="cb55-178"><a href="#cb55-178" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="fu">sapply</span>(rf_data, <span class="cf">function</span>(x) <span class="fu">sum</span>(<span class="fu">is.na</span>(x)))</span>
<span id="cb55-179"><a href="#cb55-179" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb55-180"><a href="#cb55-180" aria-hidden="true" tabindex="-1"></a><span class="co"># Convertir alcohol_30d en factor</span></span>
<span id="cb55-181"><a href="#cb55-181" aria-hidden="true" tabindex="-1"></a>rf_data<span class="sc">$</span>alcohol_30d <span class="ot">&lt;-</span> <span class="fu">factor</span>(rf_data<span class="sc">$</span>alcohol_30d, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"No"</span>, <span class="st">"Sí"</span>))</span>
<span id="cb55-182"><a href="#cb55-182" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-183"><a href="#cb55-183" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-184"><a href="#cb55-184" aria-hidden="true" tabindex="-1"></a><span class="co"># División de datos de entrenamiento y prueba</span></span>
<span id="cb55-185"><a href="#cb55-185" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb55-186"><a href="#cb55-186" aria-hidden="true" tabindex="-1"></a>trainIndex <span class="ot">&lt;-</span> <span class="fu">createDataPartition</span>(rf_data<span class="sc">$</span>alcohol_30d, <span class="at">p =</span> <span class="fl">0.7</span>, <span class="at">list =</span> <span class="cn">FALSE</span>)</span>
<span id="cb55-187"><a href="#cb55-187" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-188"><a href="#cb55-188" aria-hidden="true" tabindex="-1"></a>trainData <span class="ot">&lt;-</span> rf_data[trainIndex, ]</span>
<span id="cb55-189"><a href="#cb55-189" aria-hidden="true" tabindex="-1"></a>testData  <span class="ot">&lt;-</span> rf_data[<span class="sc">-</span>trainIndex, ]</span>
<span id="cb55-190"><a href="#cb55-190" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-191"><a href="#cb55-191" aria-hidden="true" tabindex="-1"></a><span class="co"># Construir la fórmula desde vars_pred (variables independientes)</span></span>
<span id="cb55-192"><a href="#cb55-192" aria-hidden="true" tabindex="-1"></a>formula_rf <span class="ot">&lt;-</span> <span class="fu">as.formula</span>(</span>
<span id="cb55-193"><a href="#cb55-193" aria-hidden="true" tabindex="-1"></a>  <span class="fu">paste</span>(<span class="st">"alcohol_30d ~"</span>, <span class="fu">paste</span>(vars_pred, <span class="at">collapse =</span> <span class="st">" + "</span>))</span>
<span id="cb55-194"><a href="#cb55-194" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb55-195"><a href="#cb55-195" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-196"><a href="#cb55-196" aria-hidden="true" tabindex="-1"></a><span class="co"># Ajuste del modelo Random Forest</span></span>
<span id="cb55-197"><a href="#cb55-197" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb55-198"><a href="#cb55-198" aria-hidden="true" tabindex="-1"></a>rf_model <span class="ot">&lt;-</span> <span class="fu">randomForest</span>(</span>
<span id="cb55-199"><a href="#cb55-199" aria-hidden="true" tabindex="-1"></a>  formula_rf,</span>
<span id="cb55-200"><a href="#cb55-200" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> trainData,</span>
<span id="cb55-201"><a href="#cb55-201" aria-hidden="true" tabindex="-1"></a>  <span class="at">ntree =</span> <span class="dv">500</span>,</span>
<span id="cb55-202"><a href="#cb55-202" aria-hidden="true" tabindex="-1"></a>  <span class="at">mtry =</span> <span class="fu">floor</span>(<span class="fu">sqrt</span>(<span class="fu">length</span>(vars_pred))),</span>
<span id="cb55-203"><a href="#cb55-203" aria-hidden="true" tabindex="-1"></a>  <span class="at">importance =</span> <span class="cn">TRUE</span></span>
<span id="cb55-204"><a href="#cb55-204" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb55-205"><a href="#cb55-205" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-206"><a href="#cb55-206" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-207"><a href="#cb55-207" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-208"><a href="#cb55-208" aria-hidden="true" tabindex="-1"></a><span class="do">## Predicciones en conjunto de prueba</span></span>
<span id="cb55-209"><a href="#cb55-209" aria-hidden="true" tabindex="-1"></a>pred_test <span class="ot">&lt;-</span> <span class="fu">predict</span>(rf_model, <span class="at">newdata =</span> testData)</span>
<span id="cb55-210"><a href="#cb55-210" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-211"><a href="#cb55-211" aria-hidden="true" tabindex="-1"></a><span class="co"># Evaluación del desempeño</span></span>
<span id="cb55-212"><a href="#cb55-212" aria-hidden="true" tabindex="-1"></a>cm <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(pred_test, testData<span class="sc">$</span>alcohol_30d, <span class="at">positive =</span> <span class="st">"Sí"</span>)</span>
<span id="cb55-213"><a href="#cb55-213" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-214"><a href="#cb55-214" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-215"><a href="#cb55-215" aria-hidden="true" tabindex="-1"></a><span class="co"># Convertimos las métricas a un data frame para mostrar como tabla</span></span>
<span id="cb55-216"><a href="#cb55-216" aria-hidden="true" tabindex="-1"></a>metrics_rf <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb55-217"><a href="#cb55-217" aria-hidden="true" tabindex="-1"></a>  Métrica <span class="ot">=</span> <span class="fu">c</span>(</span>
<span id="cb55-218"><a href="#cb55-218" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Accuracy"</span>, <span class="st">"95% CI Accuracy"</span>, <span class="st">"No Information Rate"</span>, <span class="st">"P-Value [Acc &gt; NIR]"</span>,</span>
<span id="cb55-219"><a href="#cb55-219" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Kappa"</span>, <span class="st">"Mcnemar's Test P-Value"</span>, <span class="st">"Sensitivity"</span>, <span class="st">"Specificity"</span>,</span>
<span id="cb55-220"><a href="#cb55-220" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Pos Pred Value"</span>, <span class="st">"Neg Pred Value"</span>, <span class="st">"Prevalence"</span>, <span class="st">"Detection Rate"</span>,</span>
<span id="cb55-221"><a href="#cb55-221" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Detection Prevalence"</span>, <span class="st">"Balanced Accuracy"</span>, <span class="st">"'Positive' Class"</span></span>
<span id="cb55-222"><a href="#cb55-222" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb55-223"><a href="#cb55-223" aria-hidden="true" tabindex="-1"></a>  <span class="at">Valor =</span> <span class="fu">c</span>(</span>
<span id="cb55-224"><a href="#cb55-224" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(cm<span class="sc">$</span>overall[<span class="st">"Accuracy"</span>], <span class="dv">4</span>),</span>
<span id="cb55-225"><a href="#cb55-225" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste0</span>(<span class="st">"("</span>, <span class="fu">round</span>(cm<span class="sc">$</span>overall[<span class="st">"AccuracyLower"</span>], <span class="dv">4</span>), <span class="st">", "</span>, <span class="fu">round</span>(cm<span class="sc">$</span>overall[<span class="st">"AccuracyUpper"</span>], <span class="dv">4</span>), <span class="st">")"</span>),</span>
<span id="cb55-226"><a href="#cb55-226" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(cm<span class="sc">$</span>overall[<span class="st">"No Information Rate"</span>], <span class="dv">4</span>),</span>
<span id="cb55-227"><a href="#cb55-227" aria-hidden="true" tabindex="-1"></a>    <span class="fu">signif</span>(cm<span class="sc">$</span>overall[<span class="st">"P-Value [Acc &gt; NIR]"</span>], <span class="dv">3</span>),</span>
<span id="cb55-228"><a href="#cb55-228" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(cm<span class="sc">$</span>overall[<span class="st">"Kappa"</span>], <span class="dv">4</span>),</span>
<span id="cb55-229"><a href="#cb55-229" aria-hidden="true" tabindex="-1"></a>    <span class="fu">signif</span>(cm<span class="sc">$</span>overall[<span class="st">"Mcnemar's Test P-Value"</span>], <span class="dv">3</span>),</span>
<span id="cb55-230"><a href="#cb55-230" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(cm<span class="sc">$</span>byClass[<span class="st">"Sensitivity"</span>], <span class="dv">4</span>),</span>
<span id="cb55-231"><a href="#cb55-231" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(cm<span class="sc">$</span>byClass[<span class="st">"Specificity"</span>], <span class="dv">4</span>),</span>
<span id="cb55-232"><a href="#cb55-232" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(cm<span class="sc">$</span>byClass[<span class="st">"Pos Pred Value"</span>], <span class="dv">4</span>),</span>
<span id="cb55-233"><a href="#cb55-233" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(cm<span class="sc">$</span>byClass[<span class="st">"Neg Pred Value"</span>], <span class="dv">4</span>),</span>
<span id="cb55-234"><a href="#cb55-234" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(cm<span class="sc">$</span>byClass[<span class="st">"Prevalence"</span>], <span class="dv">4</span>),</span>
<span id="cb55-235"><a href="#cb55-235" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(cm<span class="sc">$</span>byClass[<span class="st">"Detection Rate"</span>], <span class="dv">4</span>),</span>
<span id="cb55-236"><a href="#cb55-236" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(cm<span class="sc">$</span>byClass[<span class="st">"Detection Prevalence"</span>], <span class="dv">4</span>),</span>
<span id="cb55-237"><a href="#cb55-237" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(cm<span class="sc">$</span>byClass[<span class="st">"Balanced Accuracy"</span>], <span class="dv">4</span>),</span>
<span id="cb55-238"><a href="#cb55-238" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Sí"</span></span>
<span id="cb55-239"><a href="#cb55-239" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb55-240"><a href="#cb55-240" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb55-241"><a href="#cb55-241" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-242"><a href="#cb55-242" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(</span>
<span id="cb55-243"><a href="#cb55-243" aria-hidden="true" tabindex="-1"></a>  metrics_rf,</span>
<span id="cb55-244"><a href="#cb55-244" aria-hidden="true" tabindex="-1"></a>  <span class="at">caption =</span> <span class="st">"Métricas de desempeño del modelo Random Forest"</span>,</span>
<span id="cb55-245"><a href="#cb55-245" aria-hidden="true" tabindex="-1"></a>  <span class="at">align =</span> <span class="fu">c</span>(<span class="st">"l"</span>, <span class="st">"r"</span>)</span>
<span id="cb55-246"><a href="#cb55-246" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<caption>Métricas de desempeño del modelo Random Forest</caption>
<thead>
<tr class="header">
<th style="text-align: left;">Métrica</th>
<th style="text-align: right;">Valor</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Accuracy</td>
<td style="text-align: right;">0.6988</td>
</tr>
<tr class="even">
<td style="text-align: left;">95% CI Accuracy</td>
<td style="text-align: right;">(0.6843, 0.7129)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">No Information Rate</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">P-Value [Acc &gt; NIR]</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Kappa</td>
<td style="text-align: right;">0.2429</td>
</tr>
<tr class="even">
<td style="text-align: left;">Mcnemar’s Test P-Value</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Sensitivity</td>
<td style="text-align: right;">0.3188</td>
</tr>
<tr class="even">
<td style="text-align: left;">Specificity</td>
<td style="text-align: right;">0.8961</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Pos Pred Value</td>
<td style="text-align: right;">0.6143</td>
</tr>
<tr class="even">
<td style="text-align: left;">Neg Pred Value</td>
<td style="text-align: right;">0.717</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Prevalence</td>
<td style="text-align: right;">0.3418</td>
</tr>
<tr class="even">
<td style="text-align: left;">Detection Rate</td>
<td style="text-align: right;">0.109</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Detection Prevalence</td>
<td style="text-align: right;">0.1774</td>
</tr>
<tr class="even">
<td style="text-align: left;">Balanced Accuracy</td>
<td style="text-align: right;">0.6074</td>
</tr>
<tr class="odd">
<td style="text-align: left;">‘Positive’ Class</td>
<td style="text-align: right;">Sí</td>
</tr>
</tbody>
</table>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extraer matriz de confusión y convertirla en tabla</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>tabla_confusion_rf <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(cm<span class="sc">$</span>table) <span class="sc">%&gt;%</span></span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(</span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">Observado =</span> Reference,</span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">Predicho =</span> Prediction,</span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">Frecuencia =</span> Freq</span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(</span>
<span id="cb56-10"><a href="#cb56-10" aria-hidden="true" tabindex="-1"></a>  tabla_confusion_rf,</span>
<span id="cb56-11"><a href="#cb56-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">caption =</span> <span class="st">"Matriz de confusión del modelo Random Forest"</span>,</span>
<span id="cb56-12"><a href="#cb56-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">align =</span> <span class="fu">c</span>(<span class="st">"l"</span>, <span class="st">"l"</span>, <span class="st">"r"</span>)</span>
<span id="cb56-13"><a href="#cb56-13" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<caption>Matriz de confusión del modelo Random Forest</caption>
<thead>
<tr class="header">
<th style="text-align: left;">Predicho</th>
<th style="text-align: left;">Observado</th>
<th style="text-align: right;">Frecuencia</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">No</td>
<td style="text-align: left;">No</td>
<td style="text-align: right;">2371</td>
</tr>
<tr class="even">
<td style="text-align: left;">Sí</td>
<td style="text-align: left;">No</td>
<td style="text-align: right;">275</td>
</tr>
<tr class="odd">
<td style="text-align: left;">No</td>
<td style="text-align: left;">Sí</td>
<td style="text-align: right;">936</td>
</tr>
<tr class="even">
<td style="text-align: left;">Sí</td>
<td style="text-align: left;">Sí</td>
<td style="text-align: right;">438</td>
</tr>
</tbody>
</table>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Importancia de variables </span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Gráfico de importancia de variables</span></span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a><span class="fu">varImpPlot</span>(</span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>  rf_model,</span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">main =</span> <span class="st">"Importancia de variables – Modelo Random Forest"</span></span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Capstone-Prueba-F_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Tabla de importancia de variables</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>tabla_importancia <span class="ot">&lt;-</span> <span class="fu">importance</span>(rf_model) <span class="sc">%&gt;%</span></span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>  tibble<span class="sc">::</span><span class="fu">rownames_to_column</span>(<span class="st">"Variable"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(MeanDecreaseGini)) <span class="sc">%&gt;%</span></span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">MeanDecreaseGini =</span> <span class="fu">round</span>(MeanDecreaseGini, <span class="dv">3</span>)</span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb58-9"><a href="#cb58-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-10"><a href="#cb58-10" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(</span>
<span id="cb58-11"><a href="#cb58-11" aria-hidden="true" tabindex="-1"></a>  tabla_importancia,</span>
<span id="cb58-12"><a href="#cb58-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">caption =</span> <span class="st">"Importancia de variables según Mean Decrease Gini (Random Forest)"</span>,</span>
<span id="cb58-13"><a href="#cb58-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">align =</span> <span class="fu">c</span>(<span class="st">"l"</span>, <span class="st">"r"</span>)</span>
<span id="cb58-14"><a href="#cb58-14" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<caption>Importancia de variables según Mean Decrease Gini (Random Forest)</caption>
<colgroup>
<col style="width: 21%">
<col style="width: 14%">
<col style="width: 15%">
<col style="width: 26%">
<col style="width: 21%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Variable</th>
<th style="text-align: right;">No</th>
<th style="text-align: left;">Sí</th>
<th style="text-align: right;">MeanDecreaseAccuracy</th>
<th style="text-align: left;">MeanDecreaseGini</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">EDAD</td>
<td style="text-align: right;">15.5940726</td>
<td style="text-align: left;">-7.6507223</td>
<td style="text-align: right;">11.4428139</td>
<td style="text-align: left;">468.950</td>
</tr>
<tr class="even">
<td style="text-align: left;">Consumo_cigarros</td>
<td style="text-align: right;">55.5472519</td>
<td style="text-align: left;">48.8983200</td>
<td style="text-align: right;">69.6072755</td>
<td style="text-align: left;">223.914</td>
</tr>
<tr class="odd">
<td style="text-align: left;">cargo_trabajo</td>
<td style="text-align: right;">6.6154826</td>
<td style="text-align: left;">4.6586717</td>
<td style="text-align: right;">7.9577719</td>
<td style="text-align: left;">222.995</td>
</tr>
<tr class="even">
<td style="text-align: left;">salud_general</td>
<td style="text-align: right;">10.8349108</td>
<td style="text-align: left;">3.7172060</td>
<td style="text-align: right;">11.5203314</td>
<td style="text-align: left;">208.699</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Riesgo_ocasion</td>
<td style="text-align: right;">11.5267563</td>
<td style="text-align: left;">10.9972454</td>
<td style="text-align: right;">15.7614124</td>
<td style="text-align: left;">194.594</td>
</tr>
<tr class="even">
<td style="text-align: left;">estado_civil</td>
<td style="text-align: right;">0.8060783</td>
<td style="text-align: left;">4.4764674</td>
<td style="text-align: right;">3.6356257</td>
<td style="text-align: left;">186.856</td>
</tr>
<tr class="odd">
<td style="text-align: left;">sm_agobiado</td>
<td style="text-align: right;">26.5889131</td>
<td style="text-align: left;">-10.9409566</td>
<td style="text-align: right;">18.9819301</td>
<td style="text-align: left;">138.184</td>
</tr>
<tr class="even">
<td style="text-align: left;">sm_depresion</td>
<td style="text-align: right;">23.5788085</td>
<td style="text-align: left;">-9.0950656</td>
<td style="text-align: right;">18.2804802</td>
<td style="text-align: left;">117.393</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Consumo_mar</td>
<td style="text-align: right;">46.1365298</td>
<td style="text-align: left;">37.4195548</td>
<td style="text-align: right;">57.3663858</td>
<td style="text-align: left;">115.597</td>
</tr>
<tr class="even">
<td style="text-align: left;">sm_frustracion</td>
<td style="text-align: right;">25.2701521</td>
<td style="text-align: left;">-11.5583595</td>
<td style="text-align: right;">19.1688538</td>
<td style="text-align: left;">115.566</td>
</tr>
<tr class="odd">
<td style="text-align: left;">edad_recod</td>
<td style="text-align: right;">16.1550502</td>
<td style="text-align: left;">-7.2574809</td>
<td style="text-align: right;">13.5638800</td>
<td style="text-align: left;">114.478</td>
</tr>
<tr class="even">
<td style="text-align: left;">sm_confianza</td>
<td style="text-align: right;">29.0158253</td>
<td style="text-align: left;">-15.2673410</td>
<td style="text-align: right;">22.6678489</td>
<td style="text-align: left;">99.637</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Riesgo_diario</td>
<td style="text-align: right;">13.6278297</td>
<td style="text-align: left;">-4.3026692</td>
<td style="text-align: right;">8.6947409</td>
<td style="text-align: left;">87.274</td>
</tr>
<tr class="even">
<td style="text-align: left;">sm_valía_moral</td>
<td style="text-align: right;">12.4693443</td>
<td style="text-align: left;">-2.2070287</td>
<td style="text-align: right;">10.7886710</td>
<td style="text-align: left;">79.730</td>
</tr>
<tr class="odd">
<td style="text-align: left;">religion</td>
<td style="text-align: right;">7.2460533</td>
<td style="text-align: left;">2.6894448</td>
<td style="text-align: right;">7.5375313</td>
<td style="text-align: left;">75.111</td>
</tr>
<tr class="even">
<td style="text-align: left;">pueblo_ind</td>
<td style="text-align: right;">3.5941079</td>
<td style="text-align: left;">-1.7365143</td>
<td style="text-align: right;">1.9397074</td>
<td style="text-align: left;">67.396</td>
</tr>
<tr class="odd">
<td style="text-align: left;">trabaja_o_no</td>
<td style="text-align: right;">0.0560516</td>
<td style="text-align: left;">-1.2438200</td>
<td style="text-align: right;">-0.7213679</td>
<td style="text-align: left;">52.796</td>
</tr>
<tr class="even">
<td style="text-align: left;">educacion_med</td>
<td style="text-align: right;">-2.1540038</td>
<td style="text-align: left;">11.8688445</td>
<td style="text-align: right;">5.9287396</td>
<td style="text-align: left;">48.666</td>
</tr>
<tr class="odd">
<td style="text-align: left;">SEXO</td>
<td style="text-align: right;">5.8146740</td>
<td style="text-align: left;">10.3284797</td>
<td style="text-align: right;">10.5807994</td>
<td style="text-align: left;">47.200</td>
</tr>
<tr class="even">
<td style="text-align: left;">genero</td>
<td style="text-align: right;">5.3440291</td>
<td style="text-align: left;">11.0962497</td>
<td style="text-align: right;">10.7209759</td>
<td style="text-align: left;">46.494</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Consumo_coc</td>
<td style="text-align: right;">7.4879431</td>
<td style="text-align: left;">3.0990943</td>
<td style="text-align: right;">7.6435034</td>
<td style="text-align: left;">4.260</td>
</tr>
<tr class="even">
<td style="text-align: left;">Consumo_pb</td>
<td style="text-align: right;">0.3424747</td>
<td style="text-align: left;">-0.5547611</td>
<td style="text-align: right;">-0.1655452</td>
<td style="text-align: left;">1.498</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Consumo_tus</td>
<td style="text-align: right;">-0.5703713</td>
<td style="text-align: left;">-4.0802082</td>
<td style="text-align: right;">-4.2053580</td>
<td style="text-align: left;">0.918</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>De los resultados obtenidos, se aprecia un error rate de 30.9%, lo que implica que el modelo acierta la predicción en un 69.1% de las veces. Con respecto a la matriz de confusión, los resultados evidencian una buena detección de los no consumidores, que alcanza a un 89,6%, siendo un modelo fuerte para descartar el consumo. Sin embargo, el punto crítico del modelo está en los falsos negativos (935 casos) que fueron clasificados como No consumidores. En cuanto a los consumidores, el modelo detectó correctamente 439 casos, sin embargo pesquisa 276 falsos positivos.</p>
<p>Por otro lado, en cuanto a la precisión global del modelo, las métricas indican que acierta en aproximadamente el 69,9% de las veces, no obstante, esta se encuentra influenciada por la alta detección de los no consumidores, por lo que en cuanto al balance global, se acercaría a una predicción aproximada del 60,7%, presetando un desempeño moderado. Asimismo, en cuanto a la Especificidad (Specificity), respecto de los no consumidores, clasifica bien al 89,6%, tal como se señala previamente y respecto de la Sensitividad (Sensitivity), solo alcanza un 31,95%, no logrando capturar la complejidad del fenómeno del consumo de alcohol.</p>
<p>Con respecto a la relevancia de las variables seleccionadas para la predicción del consumo,se aprecian muy relevantes el Consumo de sustancias, como cigarrillos y marihuana, elementos que serían coincidentes con la hipótesis del policonsumo. Se evidencia, también, la relevancia de los estados asociados a salud mental y/o aspectos emocionales de los encuestados, siendo las variables de agobio, confianza en sí mismo, depresión y frustración, las que influyen en el consumo de alcohol, como también una influencia en esta respecto de la percepción de riesgo del consumo, ya sea de tipo ocasional o diario. Finalmente, entre las variables demográficas hay una importancia en características como la edad, el cargo que se desempeña en el trabajo, el sexo/género y nivel educativo.</p>
<p><strong>Curva ROC</strong></p>
<p>La curva ROC es un recurso para evaluar el rendimiento de un modelo de clasificación, ya que muestra cómo cambia la sensibilidad (tasa de verdaderos positivos) en función de la tasa de falsos positivos (1 − especificidad) para distintos puntos de corte.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Cargar paquete y librería</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">require</span>(pROC)) <span class="fu">install.packages</span>(<span class="st">"pROC"</span>)</span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pROC)</span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Probabilidades predichas</span></span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a>pred_probs <span class="ot">&lt;-</span> <span class="fu">predict</span>(rf_model, testData, <span class="at">type =</span> <span class="st">"prob"</span>)</span>
<span id="cb59-9"><a href="#cb59-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-10"><a href="#cb59-10" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(pred_probs)</span>
<span id="cb59-11"><a href="#cb59-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-12"><a href="#cb59-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Probabilidad de la clase positiva ("Sí")</span></span>
<span id="cb59-13"><a href="#cb59-13" aria-hidden="true" tabindex="-1"></a>prob_si <span class="ot">&lt;-</span> pred_probs[, <span class="st">"Sí"</span>]</span>
<span id="cb59-14"><a href="#cb59-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-15"><a href="#cb59-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Curva ROC</span></span>
<span id="cb59-16"><a href="#cb59-16" aria-hidden="true" tabindex="-1"></a>roc_curve <span class="ot">&lt;-</span> <span class="fu">roc</span>(</span>
<span id="cb59-17"><a href="#cb59-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">response =</span> testData<span class="sc">$</span>alcohol_30d,</span>
<span id="cb59-18"><a href="#cb59-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">predictor =</span> prob_si,</span>
<span id="cb59-19"><a href="#cb59-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"No"</span>, <span class="st">"Sí"</span>),</span>
<span id="cb59-20"><a href="#cb59-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">direction =</span> <span class="st">"&lt;"</span></span>
<span id="cb59-21"><a href="#cb59-21" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb59-22"><a href="#cb59-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-23"><a href="#cb59-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Gráfico ROC</span></span>
<span id="cb59-24"><a href="#cb59-24" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(</span>
<span id="cb59-25"><a href="#cb59-25" aria-hidden="true" tabindex="-1"></a>  roc_curve,</span>
<span id="cb59-26"><a href="#cb59-26" aria-hidden="true" tabindex="-1"></a>  <span class="at">main =</span> <span class="st">"Curva ROC - Random Forest"</span>,</span>
<span id="cb59-27"><a href="#cb59-27" aria-hidden="true" tabindex="-1"></a>  <span class="at">col =</span> <span class="st">"blue"</span>,</span>
<span id="cb59-28"><a href="#cb59-28" aria-hidden="true" tabindex="-1"></a>  <span class="at">lwd =</span> <span class="dv">2</span></span>
<span id="cb59-29"><a href="#cb59-29" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb59-30"><a href="#cb59-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-31"><a href="#cb59-31" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Punto de corte estándar 0.5 ---</span></span>
<span id="cb59-32"><a href="#cb59-32" aria-hidden="true" tabindex="-1"></a>coords_05 <span class="ot">&lt;-</span> <span class="fu">coords</span>(</span>
<span id="cb59-33"><a href="#cb59-33" aria-hidden="true" tabindex="-1"></a>  roc_curve,</span>
<span id="cb59-34"><a href="#cb59-34" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="fl">0.5</span>,</span>
<span id="cb59-35"><a href="#cb59-35" aria-hidden="true" tabindex="-1"></a>  <span class="at">input =</span> <span class="st">"threshold"</span>,</span>
<span id="cb59-36"><a href="#cb59-36" aria-hidden="true" tabindex="-1"></a>  <span class="at">ret =</span> <span class="fu">c</span>(<span class="st">"sensitivity"</span>, <span class="st">"specificity"</span>)</span>
<span id="cb59-37"><a href="#cb59-37" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb59-38"><a href="#cb59-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-39"><a href="#cb59-39" aria-hidden="true" tabindex="-1"></a><span class="co"># Marcar punto 0.5 en la curva</span></span>
<span id="cb59-40"><a href="#cb59-40" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(</span>
<span id="cb59-41"><a href="#cb59-41" aria-hidden="true" tabindex="-1"></a>  <span class="dv">1</span> <span class="sc">-</span> coords_05[<span class="st">"specificity"</span>],</span>
<span id="cb59-42"><a href="#cb59-42" aria-hidden="true" tabindex="-1"></a>  coords_05[<span class="st">"sensitivity"</span>],</span>
<span id="cb59-43"><a href="#cb59-43" aria-hidden="true" tabindex="-1"></a>  <span class="at">col =</span> <span class="st">"darkgreen"</span>,</span>
<span id="cb59-44"><a href="#cb59-44" aria-hidden="true" tabindex="-1"></a>  <span class="at">pch =</span> <span class="dv">19</span>,</span>
<span id="cb59-45"><a href="#cb59-45" aria-hidden="true" tabindex="-1"></a>  <span class="at">cex =</span> <span class="fl">1.3</span></span>
<span id="cb59-46"><a href="#cb59-46" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb59-47"><a href="#cb59-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-48"><a href="#cb59-48" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(</span>
<span id="cb59-49"><a href="#cb59-49" aria-hidden="true" tabindex="-1"></a>  <span class="dv">1</span> <span class="sc">-</span> coords_05[<span class="st">"specificity"</span>],</span>
<span id="cb59-50"><a href="#cb59-50" aria-hidden="true" tabindex="-1"></a>  coords_05[<span class="st">"sensitivity"</span>],</span>
<span id="cb59-51"><a href="#cb59-51" aria-hidden="true" tabindex="-1"></a>  <span class="at">labels =</span> <span class="st">"Cutoff = 0.5"</span>,</span>
<span id="cb59-52"><a href="#cb59-52" aria-hidden="true" tabindex="-1"></a>  <span class="at">pos =</span> <span class="dv">4</span></span>
<span id="cb59-53"><a href="#cb59-53" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Capstone-Prueba-F_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Área bajo la curva</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>auc_value <span class="ot">&lt;-</span> <span class="fu">auc</span>(roc_curve)</span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">paste0</span>(<span class="st">"Área bajo la curva (AUC): "</span>, <span class="fu">round</span>(auc_value, <span class="dv">3</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>El desempeño del modelo Random Forest fue evaluado mediante la curva ROC, obteniéndose un área bajo la curva (AUC) de 0.712. Este valor indica una capacidad de discriminación aceptable del modelo para diferenciar entre personas que consumieron y no consumieron alcohol en los últimos 30 días. En términos prácticos, el modelo asigna una mayor probabilidad de consumo al individuo consumidor en el 71.2% de los casos, lo que resulta coherente con la complejidad multifactorial del fenómeno analizado.Si bien la sensibilidad del modelo es moderada bajo el umbral estándar, el AUC (0,71) evidencia que el modelo captura adecuadamente patrones de riesgo asociados al consumo de alcohol, siendo una herramienta útil para análisis exploratorios y de priorización de riesgo. Al utilizar el punto de corte estándar de 0,5, el modelo presenta una alta especificidad y una baja sensibilidad, lo que implica una adecuada identificación de no consumidores, pero una baja capacidad para detectar consumidores de alcohol, sin embargo, para identificar patrones de consumo, pudiera ser relevante considerar puntos de corte alternativos que permitan un mejor equilibrio entre sensibilidad y especificidad.</p>
</section>
<section id="conclusiones" class="level2" data-number="10">
<h2 data-number="10" class="anchored" data-anchor-id="conclusiones"><span class="header-section-number">10</span> Conclusiones</h2>
<p>El objetivo de este proyecto se orientó al análisis de las variables que influyen sobre el consumo de alcohol de proveniente del Estudio Nacional de Drogas en Población General 2024, elaborado por el Servicio Nacional para la Prevención y Rehabilitación del Consumo de Drogas y Alcohol (SENDA). Las líneas de análisis fueron en función de variables sociodemográficas, percepción de riesgo, policonsumo y salud general y mental.</p>
<p>En general, quienes sí consumen alcohol muestran una mayor proporción de solteros/as y una menor de casados/as, mientras que la pertenencia a pueblo originario cambia muy poco entre grupos. Entre quienes consumen alcohol hay menor proporción de personas que adhieren a una religión. También se observa una mayor presencia de masculino y una mayor proporción de personas con educación media o superior. En el ámbito laboral, el consumo se asocia con una mayor proporción de personas que trabajan y con una mayor concentración en el sector privado, disminuyendo relativamente el trabajo por cuenta propia. Respecto a sustancias, el consumo de alcohol se relaciona con mayor prevalencia de cigarros y marihuana, mientras que cocaína, pasta base y tusi aparecen con niveles muy bajos en ambos grupos, aunque levemente superiores entre quienes consumen. En salud mental y salud general las diferencias de medias son más bien pequeñas, mientras que la percepción de riesgo es consistentemente mayor en quienes no consumen alcohol; además, los ítems de salud mental se correlacionan entre sí, pero la percepción de riesgo se vincula poco con ellos.</p>
<p>En relación al planteamiento de hipótesis, no se rechazan las relativas al género, toda vez que se pesquisó una mayor probabilidad del género masculino en el consumo de alcohol, por sobre los otros géneros de las personas encuestadas. Asimismo, en lo referente a la asociación significativa entre el consumo de alcohol y la ingesta de otras drogas, no se rechaza la hipótesis, en función de que se pesquisa el policonsumo como una variable significativa, principalmente respecto de marihuana y cigarrillos. En cuanto a la hipótesis asociadas a la probabilidad de consumo en personas que presentan mayor habitualidad en problemas de salud mental, esta no se rechaza, a partir de los resultados que dan cuenta de que síntomas como el agobio, la frustración, dificultades para dormir, sensación de no valía moral, inciden en la ingesta de alcohol. Por último, no se rechaza la hipótesis planteada sobre una menor percepción de riesgo asociada al consumo de alcohol y la probabilidad de mayor ingesta del mismo, en tanto los resultados dan cuenta de que a mayor consideración de riesgo del consumo, ya sea diario u ocasional, es menor la probabilidad de consumir alcohol.</p>
<p>Los resultados del modelo de regresión logística indican que el consumo de alcohol en los últimos 30 días se asocia de manera significativa con factores sociodemográficos, conductuales y psicosociales. En particular, se observa una mayor probabilidad de consumo entre hombres, personas con mayor nivel educativo y quienes no adhieren a una religión, así como entre quienes presentan consumo de otras sustancias, especialmente marihuana y cigarrillos. Asimismo, variables vinculadas al malestar psicosocial, como la pérdida de sueño y la sensación de agobio, se asocian positivamente con el consumo, mientras que una mayor percepción de riesgo frente al consumo ocasional actúa como un factor protector. El modelo presenta un ajuste adecuado y una capacidad de discriminación moderada (AUC = 0,72), con alta especificidad y sensibilidad moderada-baja, lo que sugiere una mayor precisión para identificar a personas no consumidoras. En conjunto, los hallazgos refuerzan la naturaleza multifactorial del consumo de alcohol y la necesidad de enfoques preventivos integrales.</p>
<p>El modelo Random Forest presenta un desempeño predictivo moderado para identificar el consumo de alcohol en los últimos 30 días, con una exactitud cercana al 69% y un AUC de 0,71, lo que indica una capacidad de discriminación aceptable. Su principal fortaleza es la alta especificidad, mostrando una buena identificación de personas no consumidoras, mientras que su principal limitación es la baja sensibilidad, evidenciando dificultades para detectar a todos los consumidores reales. El análisis de importancia de variables destaca el consumo de otras sustancias, especialmente marihuana y cigarrillos, así como factores asociados al malestar emocional y la percepción de riesgo, junto con variables sociodemográficas como edad, sexo/género y nivel educativo. En conjunto, el modelo resulta útil para análisis exploratorios y para la identificación de patrones de riesgo, aunque su aplicación para la detección directa de consumidores requiere ajustes en el punto de corte u otras estrategias de modelamiento.</p>
<p>La regresión logística y el Random Forest ofrecen enfoques complementarios en el análisis del consumo de alcohol. La regresión logística permite interpretar directamente las asociaciones entre variables y consumo, mientras que el Random Forest captura relaciones no lineales e interacciones complejas. Ambos modelos tienen discriminación moderada, aunque el Random Forest muestra mayor especificidad y menor sensibilidad. En síntesis, la regresión logística es más útil para explicar el fenómeno, y el Random Forest para explorar patrones y priorizar riesgo.</p>
<p><strong>Referencias</strong></p>
<p>• Organización Panamericana de la Salud. (2015). Situación regional del consumo de alcohol y la salud en las Américas: Resumen del informe [Hoja informativa]. OPS. Organización Panamericana de la Salud</p>
<p>• Servicio Nacional para la Prevención y Rehabilitación del Consumo de Drogas y Alcohol. (2023). Décimo Cuarto Estudio Nacional de Drogas en Población Escolar de Chile 2021: 8º básico a 4º medio. Observatorio Chileno de Drogas, Ministerio del Interior y Seguridad Pública, Gobierno de Chile. SENDA</p>
<p>• Servicio Nacional para la Prevención y Rehabilitación del Consumo de Drogas y Alcohol (SENDA) &amp; Ministerio de Salud (MINSAL). (2016). El consumo de alcohol en Chile: Situación epidemiológica. https://www.senda.gob.cl/wp-content/uploads/media/estudios/otrosSENDA/2016_Consumo_Alcohol_Chile.pdf</p>
<p>• Vilugrón, F., Molina, T., Gras Pérez, M. E., &amp; Font-Mayolas, S. (2022). Precocidad de inicio del consumo de sustancias psicoactivas y su relación con otros comportamientos de riesgo para la salud en adolescentes chilenos. Revista Médica de Chile, 150, 584–596. Revista Médica de Chile</p>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>